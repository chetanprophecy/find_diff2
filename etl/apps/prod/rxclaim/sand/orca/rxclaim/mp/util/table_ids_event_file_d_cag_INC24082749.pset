!prototype|P|||$AI_MP/util/table_ids_event_file.mp
INCIDENT_NO||||INC24082749
ILM_NAME|l|||d_cag
TARGET_NAME||||ids_common.d_cag
WHERE_CLAUSE||||employer_group_id IN ('TERRYSTEST','075531860776077', '075531536043604', '075531860816081', '075531860856085', '075531860716071', '075531860826082', '075531536053605', '075531860726072', '075531836073607', '075531700010001', '075531500010001',  '075531800010001', '075531860916091', '075531860926092', '075531536103610','05W580200010001','00W945900010001')  AND carrier_id IN ('UHCPRIM01','UHCPRRV01','UHCUHCI01') and erisa_id in ('M','7','4')
FLTR_EXPR||||first_defined(employer_group_id,"NA") member [vector 'TERRYSTEST','075531860776077', '075531536043604', '075531860816081', '075531860856085', '075531860716071', '075531860826082', '075531536053605', '075531860726072', '075531836073607', '075531700010001', '075531500010001',  '075531800010001', '075531860916091', '075531860926092', '075531536103610','05W580200010001','00W945900010001'] & first_defined(carrier_id,"NA") member [vector 'UHCPRIM01','UHCPRRV01','UHCUHCI01'] & first_defined(erisa_id,"NA") member [vector 'M','7','4']
RFMT_XRF||||/*Reformat operation*/\r\nout::reformat(in)=\r\nbegin\r\nout.*::in.*;\r\n out.ids_updt_uid::$"INCIDENT_NO";\r\n out.erisa_id:: if (in.carrier_id member [vector 'UHCPRRV01','UHCPRIM01' ] and in.erisa_id member [vector 'M','7','4']) "Y" else if (in.carrier_id member [vector 'UHCUHCI01' ] and in.erisa_id member [vector 'M','7','4']) "N" else in.erisa_id;\r\n /*\r\n update D_CAG d\r\n set d.erisa_id='Y',\r\n update_uid='INC24082749',\r\nupDATE_TS=CURRENT_TIMESTAMP\r\n where d.cag_sk in (select sand.cag_sk from v_d_cag  sand where carrier_id='UHCPRRV01' ) \r\n and erisa_id in ('M','7','4')\r\n \r\n update D_CAG d\r\n set d.erisa_id='Y',\r\n update_uid='INC24082749',\r\nupDATE_TS=CURRENT_TIMESTAMP\r\n where d.cag_sk in (select sand.cag_sk from v_d_cag  sand where carrier_id='UHCPRIM01' )\r\n and erisa_id in ('M','7','4')\r\n \r\n update D_CAG d\r\n set d.erisa_id='N',\r\n update_uid='INC24082749',\r\nupDATE_TS=CURRENT_TIMESTAMP\r\nset d.erisa_id='N'\r\n \twhere d.cag_sk in (select sand.cag_sk from v_d_cag  sand where carrier_id='UHCUHCI01' ) and erisa_id in ('M','7','4')\r\n*/\r\nend;
