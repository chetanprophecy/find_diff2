!prototype|P|||$AI_PSET/get.ids.interim.pset
SOURCE_NAME||||ids_common.d_product_extract
LOOKUP_FIELDS_KEY||||{dxf_hk_part1;dxf_hk_part2;dxf_sk;prod_sk;prod_id;drg_dea_cd;drg_lbl_nm;prod_nm;drg_ndc_short_id;drg_ndc_short_nm;drg_ndc_desc;ids_updt_dttm}
SOURCE_FILE_PATTERN||||d_product.dat.gz
TRANSFORM_XFR|l|||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\ninclude '~$AI_XFR/bre_helper.map.xfr';\nlet decimal('') bzt_0_6c54cc0a_57ea435e_33b3_15 = $START_DATE;\nlet decimal('') bzt_1_6c54cc0a_57ea435e_33b3_15 = $END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.drg_ndc_short_nm,'drg_ndc_short_nm',1,0]\n     [out0.dise_cat_sk,'dise_cat_sk',1,0]\n     [out0.gnrc_mdspn_ind,'gnrc_mdspn_ind',1,0]\n     [out0.ids_create_run_id,'ids_create_run_id',1,0]\n     [out0.fdb_hicl_seq_no,'fdb_hicl_seq_no',1,0]\n     [out0.drg_strngth_qty,'drg_strngth_qty',1,0]\n     [out0.spclty_prod_corp_nm,'spclty_prod_corp_nm',1,0]\n     [out0.ids_rec_stat_cd,'ids_rec_stat_cd',1,0]\n     [out0.ftc_thera_class_cd,'ftc_thera_class_cd',1,0]\n     [out0.rec_rank_no,'rec_rank_no',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.ndc_small_pkg,'ndc_small_pkg',1,0]\n     [out0.current_flg,'current_flg',1,0]\n     [out0.gcn_no,'gcn_no',1,0]\n     [out0.file_rec_cntr,'file_rec_cntr',1,0]\n     [out0.drg_ndc_pkg_cd,'drg_ndc_pkg_cd',1,0]\n     [out0.drg_dosag_frm_id,'drg_dosag_frm_id',1,0]\n     [out0.kdc,'kdc',1,0]\n     [out0.dxf_hk_part2,'dxf_hk_part2',1,0]\n     [out0.fdb_hic3_cd,'fdb_hic3_cd',1,0]\n     [out0.drg_stat_cd,'drg_stat_cd',1,0]\n     [out0.drg_multi_src_cd,'drg_multi_src_cd',1,0]\n     [out0.gnrc_mdspn_ind_nm,'gnrc_mdspn_ind_nm',1,0]\n     [out0.drg_clsfctn_cd,'drg_clsfctn_cd',1,0]\n     [out0.ftc_thera_class_nm,'ftc_thera_class_nm',1,0]\n     [out0.prd_user_defined_field_2_txt,'prd_user_defined_field_2_txt',1,0]\n     [out0.fdb_gen_prc_ind,'fdb_gen_prc_ind',1,0]\n     [out0.dise_cat_nm,'dise_cat_nm',1,0]\n     [out0.drg_ndc_prod_cd,'drg_ndc_prod_cd',1,0]\n     [out0.drug_efficacy_impl_cd,'drug_efficacy_impl_cd',1,0]\n     [out0.total_package_qty,'total_package_qty',1,0]\n     [out0.drg_fda_thrpc_eqvlc_cd,'drg_fda_thrpc_eqvlc_cd',1,0]\n     [out0.prd_inactive_dt,'prd_inactive_dt',1,0]\n     [out0.ahfs_desc,'ahfs_desc',1,0]\n     [out0.drg_extd_nm_gpi_10_cd,'drg_extd_nm_gpi_10_cd',1,0]\n     [out0.brnd_nm_typ_cd,'brnd_nm_typ_cd',1,0]\n     [out0.drg_grp_cd,'drg_grp_cd',1,0]\n     [out0.local_systemic_ind,'local_systemic_ind',1,0]\n     [out0.drg_ndc_desc,'drg_ndc_desc',1,0]\n     [out0.ids_create_dttm,'ids_create_dttm',1,0]\n     [out0.origin_cd,'origin_cd',1,0]\n     [out0.gcn_seq_no,'gcn_seq_no',1,0]\n     [out0.drg_unit_dose_use_ind,'drg_unit_dose_use_ind',1,0]\n     [out0.src_dataset_id,'src_dataset_id',1,0]\n     [out0.package_size_uom_cd,'package_size_uom_cd',1,0]\n     [out0.drg_grp_nm,'drg_grp_nm',1,0]\n     [out0.drg_grp_gpi_02_cd,'drg_grp_gpi_02_cd',1,0]\n     [out0.dispensing_unit,'dispensing_unit',1,0]\n     [out0.intl_extr_ind,'intl_extr_ind',1,0]\n     [out0.limited_dist,'limited_dist',1,0]\n     [out0.drg_sub_class_nm,'drg_sub_class_nm',1,0]\n     [out0.drg_class_nm,'drg_class_nm',1,0]\n     [out0.prod_nm,'prod_nm',1,0]\n     [out0.spclty_prod_corp_ind,'spclty_prod_corp_ind',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.fdb_hic3_seq_no,'fdb_hic3_seq_no',1,0]\n     [out0.package_qty,'package_qty',1,0]\n     [out0.fdb_gen_prc_spred_ind,'fdb_gen_prc_spred_ind',1,0]\n     [out0.admin_route_cd,'admin_route_cd',1,0]\n     [out0.drg_ndc_term_dt,'drg_ndc_term_dt',1,0]\n     [out0.drg_sub_class_cd,'drg_sub_class_cd',1,0]\n     [out0.fdb_hic3_desc,'fdb_hic3_desc',1,0]\n     [out0.drg_dea_cd,'drg_dea_cd',1,0]\n     [out0.prod_sk,'prod_sk',1,0]\n     [out0.gppc_id,'gppc_id',1,0]\n     [out0.dxf_hk_part1,'dxf_hk_part1',1,0]\n     [out0.pricing_sprd,'pricing_sprd',1,0]\n     [out0.fdb_gen_ind_ndc_lvl_ind,'fdb_gen_ind_ndc_lvl_ind',1,0]\n     [out0.lblr_type,'lblr_type',1,0]\n     [out0.drg_ndc_eff_dt,'drg_ndc_eff_dt',1,0]\n     [out0.prod_id_qlfr_cd,'prod_id_qlfr_cd',1,0]\n     [out0.drg_3rd_prty_excpn_ind,'drg_3rd_prty_excpn_ind',1,0]\n     [out0.fdb_maint_drg_ind,'fdb_maint_drg_ind',1,0]\n     [out0.innerpack_cd,'innerpack_cd',1,0]\n     [out0.single_comb_ind,'single_comb_ind',1,0]\n     [out0.ids_create_uid,'ids_create_uid',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.awp_ind,'awp_ind',1,0]\n     [out0.ndc_large_pkg,'ndc_large_pkg',1,0]\n     [out0.drg_maint_ind,'drg_maint_ind',1,0]\n     [out0.ids_updt_uid,'ids_updt_uid',1,0]\n     [out0.prod_key,'prod_key',1,0]\n     [out0.drg_bsic_nm_gpi_08_cd,'drg_bsic_nm_gpi_08_cd',1,0]\n     [out0.drg_ndc_short_id,'drg_ndc_short_id',1,0]\n     [out0.reimbursment_ind,'reimbursment_ind',1,0]\n     [out0.fdb_gcn_seq_no,'fdb_gcn_seq_no',1,0]\n     [out0.thrpc_class_nm,'thrpc_class_nm',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.ids_updt_run_id,'ids_updt_run_id',1,0]\n     [out0.drg_ndc_lblr_cd,'drg_ndc_lblr_cd',1,0]\n     [out0.mfr_id,'mfr_id',1,0]\n     [out0.fda_app_type_bla_flg,'fda_app_type_bla_flg',1,0]\n     [out0.fdb_expndd_orng_bk_cd,'fdb_expndd_orng_bk_cd',1,0]\n     [out0.gpi_sk,'gpi_sk',1,0]\n     [out0.clinic_pack_cd,'clinic_pack_cd',1,0]\n     [out0.prd_user_defined_field_1_txt,'prd_user_defined_field_1_txt',1,0]\n     [out0.prd_user_defined_field_3_txt,'prd_user_defined_field_3_txt',1,0]\n     [out0.fdb_gen_thrpc_drg_ind,'fdb_gen_thrpc_drg_ind',1,0]\n     [out0.dflt_etc_id_fpe_desc,'dflt_etc_id_fpe_desc',1,0]\n     [out0.drg_sub_class_gpi_06_cd,'drg_sub_class_gpi_06_cd',1,0]\n     [out0.gnrc_nm,'gnrc_nm',1,0]\n     [out0.ahfs_cd,'ahfs_cd',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.fda_app_type_anda_flg,'fda_app_type_anda_flg',1,0]\n     [out0.fdb_invtr_ind,'fdb_invtr_ind',1,0]\n     [out0.thrpc_class_sk,'thrpc_class_sk',1,0]\n     [out0.drg_extd_nm,'drg_extd_nm',1,0]\n     [out0.gpi_no,'gpi_no',1,0]\n     [out0.drg_lbl_nm,'drg_lbl_nm',1,0]\n     [out0.etc_id_fpe_desc,'etc_id_fpe_desc',1,0]\n     [out0.fda_app_type_nda_flg,'fda_app_type_nda_flg',1,0]\n     [out0.package_size,'package_size',1,0]\n     [out0.drg_class_gpi_04_cd,'drg_class_gpi_04_cd',1,0]\n     [out0.fdb_gcn_cd,'fdb_gcn_cd',1,0]\n     [out0.drg_rx_otc_ind,'drg_rx_otc_ind',1,0]\n     [out0.drg_mfrr_nm,'drg_mfrr_nm',1,0]\n     [out0.dxf_src_sys_id,'dxf_src_sys_id',1,0]\n     [out0.prd_repackage_ind,'prd_repackage_ind',1,0]\n     [out0.drg_dosag_frm_gpi_12_cd,'drg_dosag_frm_gpi_12_cd',1,0]\n     [out0.drg_bsic_nm,'drg_bsic_nm',1,0]\n     [out0.drg_drg_intrctn_desc,'drg_drg_intrctn_desc',1,0]\n     [out0.drg_strngth_uom_cd,'drg_strngth_uom_cd',1,0]\n     [out0.prod_id,'prod_id',1,0]\n  ]\n  impacts:\n  [\n     [in0.prod_sk,'prod_sk',1,1]\n     [in0.gppc_id,'gppc_id',1,1]\n     [in0.prd_user_defined_field_3_txt,'prd_user_defined_field_3_txt',1,1]\n     [in0.total_package_qty,'total_package_qty',1,1]\n     [in0.drg_sub_class_cd,'drg_sub_class_cd',1,1]\n     [in0.fdb_hic3_desc,'fdb_hic3_desc',1,1]\n     [in0.single_comb_ind,'single_comb_ind',1,1]\n     [in0.origin_cd,'origin_cd',1,1]\n     [in0.drg_bsic_nm_gpi_08_cd,'drg_bsic_nm_gpi_08_cd',1,1]\n     [in0.prd_user_defined_field_1_txt,'prd_user_defined_field_1_txt',1,1]\n     [in0.drg_ndc_desc,'drg_ndc_desc',1,1]\n     [in0.gcn_no,'gcn_no',1,1]\n     [in0.ahfs_desc,'ahfs_desc',1,1]\n     [in0.prod_key,'prod_key',1,1]\n     [in0.drg_ndc_eff_dt,'drg_ndc_eff_dt',1,1]\n     [in0.spclty_prod_corp_nm,'spclty_prod_corp_nm',1,1]\n     [in0.ids_create_uid,'ids_create_uid',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.ndc_large_pkg,'ndc_large_pkg',1,1]\n     [in0.awp_ind,'awp_ind',1,1]\n     [in0.prod_id_qlfr_cd,'prod_id_qlfr_cd',1,1]\n     [in0.drg_maint_ind,'drg_maint_ind',1,1]\n     [in0.drg_grp_gpi_02_cd,'drg_grp_gpi_02_cd',1,1]\n     [in0.limited_dist,'limited_dist',1,1]\n     [in0.drg_ndc_term_dt,'drg_ndc_term_dt',1,1]\n     [in0.drg_class_nm,'drg_class_nm',1,1]\n     [in0.drg_ndc_short_id,'drg_ndc_short_id',1,1]\n     [in0.fdb_invtr_ind,'fdb_invtr_ind',1,1]\n     [in0.clinic_pack_cd,'clinic_pack_cd',1,1]\n     [in0.fda_app_type_bla_flg,'fda_app_type_bla_flg',1,1]\n     [in0.drg_strngth_uom_cd,'drg_strngth_uom_cd',1,1]\n     [in0.ids_create_run_id,'ids_create_run_id',1,1]\n     [in0.reimbursment_ind,'reimbursment_ind',1,1]\n     [in0.drg_grp_cd,'drg_grp_cd',1,1]\n     [in0.thrpc_class_nm,'thrpc_class_nm',1,1]\n     [in0.fdb_gcn_seq_no,'fdb_gcn_seq_no',1,1]\n     [in0.etc_id_fpe_desc,'etc_id_fpe_desc',1,1]\n     [in0.ahfs_cd,'ahfs_cd',1,1]\n     [in0.gnrc_nm,'gnrc_nm',1,1]\n     [in0.drg_extd_nm,'drg_extd_nm',1,1]\n     [in0.thrpc_class_sk,'thrpc_class_sk',1,1]\n     [in0.dflt_etc_id_fpe_desc,'dflt_etc_id_fpe_desc',1,1]\n     [in0.fda_app_type_nda_flg,'fda_app_type_nda_flg',1,1]\n     [in0.fdb_expndd_orng_bk_cd,'fdb_expndd_orng_bk_cd',1,1]\n     [in0.dxf_hk_part2,'dxf_hk_part2',1,1]\n     [in0.package_size_uom_cd,'package_size_uom_cd',1,1]\n     [in0.drg_fda_thrpc_eqvlc_cd,'drg_fda_thrpc_eqvlc_cd',1,1]\n     [in0.drg_mfrr_nm,'drg_mfrr_nm',1,1]\n     [in0.ids_updt_run_id,'ids_updt_run_id',1,1]\n     [in0.prod_id,'prod_id',1,1]\n     [in0.drg_drg_intrctn_desc,'drg_drg_intrctn_desc',1,1]\n     [in0.drg_ndc_lblr_cd,'drg_ndc_lblr_cd',1,1]\n     [in0.gnrc_mdspn_ind_nm,'gnrc_mdspn_ind_nm',1,1]\n     [in0.fda_app_type_anda_flg,'fda_app_type_anda_flg',1,1]\n     [in0.drg_rx_otc_ind,'drg_rx_otc_ind',1,1]\n     [in0.drg_grp_nm,'drg_grp_nm',1,1]\n     [in0.drg_bsic_nm,'drg_bsic_nm',1,1]\n     [in0.dxf_src_sys_id,'dxf_src_sys_id',1,1]\n     [in0.fdb_gen_thrpc_drg_ind,'fdb_gen_thrpc_drg_ind',1,1]\n     [in0.gcn_seq_no,'gcn_seq_no',1,1]\n     [in0.kdc,'kdc',1,1]\n     [in0.dise_cat_sk,'dise_cat_sk',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.ftc_thera_class_nm,'ftc_thera_class_nm',1,1]\n     [in0.drg_ndc_short_nm,'drg_ndc_short_nm',1,1]\n     [in0.gnrc_mdspn_ind,'gnrc_mdspn_ind',1,1]\n     [in0.ndc_small_pkg,'ndc_small_pkg',1,1]\n     [in0.rec_rank_no,'rec_rank_no',1,1]\n     [in0.file_rec_cntr,'file_rec_cntr',1,1]\n     [in0.prd_user_defined_field_2_txt,'prd_user_defined_field_2_txt',1,1]\n     [in0.fdb_gen_ind_ndc_lvl_ind,'fdb_gen_ind_ndc_lvl_ind',1,1]\n     [in0.drg_dea_cd,'drg_dea_cd',1,1]\n     [in0.drg_ndc_pkg_cd,'drg_ndc_pkg_cd',1,1]\n     [in0.current_flg,'current_flg',1,1]\n     [in0.drg_3rd_prty_excpn_ind,'drg_3rd_prty_excpn_ind',1,1]\n     [in0.drg_dosag_frm_id,'drg_dosag_frm_id',1,1]\n     [in0.package_size,'package_size',1,1]\n     [in0.fdb_hic3_cd,'fdb_hic3_cd',1,1]\n     [in0.drg_clsfctn_cd,'drg_clsfctn_cd',1,1]\n     [in0.ftc_thera_class_cd,'ftc_thera_class_cd',1,1]\n     [in0.drg_stat_cd,'drg_stat_cd',1,1]\n     [in0.drg_strngth_qty,'drg_strngth_qty',1,1]\n     [in0.fdb_hicl_seq_no,'fdb_hicl_seq_no',1,1]\n     [in0.prd_repackage_ind,'prd_repackage_ind',1,1]\n     [in0.ids_rec_stat_cd,'ids_rec_stat_cd',1,1]\n     [in0.drg_multi_src_cd,'drg_multi_src_cd',1,1]\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.drg_lbl_nm,'drg_lbl_nm',1,1]\n     [in0.dise_cat_nm,'dise_cat_nm',1,1]\n     [in0.mfr_id,'mfr_id',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.gpi_sk,'gpi_sk',1,1]\n     [in0.fdb_hic3_seq_no,'fdb_hic3_seq_no',1,1]\n     [in0.dxf_hk_part1,'dxf_hk_part1',1,1]\n     [in0.drg_unit_dose_use_ind,'drg_unit_dose_use_ind',1,1]\n     [in0.pricing_sprd,'pricing_sprd',1,1]\n     [in0.fdb_gen_prc_spred_ind,'fdb_gen_prc_spred_ind',1,1]\n     [in0.fdb_maint_drg_ind,'fdb_maint_drg_ind',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.drg_sub_class_gpi_06_cd,'drg_sub_class_gpi_06_cd',1,1]\n     [in0.dispensing_unit,'dispensing_unit',1,1]\n     [in0.lblr_type,'lblr_type',1,1]\n     [in0.brnd_nm_typ_cd,'brnd_nm_typ_cd',1,1]\n     [in0.gpi_no,'gpi_no',1,1]\n     [in0.innerpack_cd,'innerpack_cd',1,1]\n     [in0.local_systemic_ind,'local_systemic_ind',1,1]\n     [in0.prd_inactive_dt,'prd_inactive_dt',1,1]\n     [in0.intl_extr_ind,'intl_extr_ind',1,1]\n     [in0.drug_efficacy_impl_cd,'drug_efficacy_impl_cd',1,1]\n     [in0.src_dataset_id,'src_dataset_id',1,1]\n     [in0.ids_create_dttm,'ids_create_dttm',1,1]\n     [in0.fdb_gcn_cd,'fdb_gcn_cd',1,1]\n     [in0.drg_ndc_prod_cd,'drg_ndc_prod_cd',1,1]\n     [in0.admin_route_cd,'admin_route_cd',1,1]\n     [in0.fdb_gen_prc_ind,'fdb_gen_prc_ind',1,1]\n     [in0.ids_updt_uid,'ids_updt_uid',1,1]\n     [in0.spclty_prod_corp_ind,'spclty_prod_corp_ind',1,1]\n     [in0.prod_nm,'prod_nm',1,1]\n     [in0.drg_class_gpi_04_cd,'drg_class_gpi_04_cd',1,1]\n     [in0.drg_sub_class_nm,'drg_sub_class_nm',1,1]\n     [in0.drg_dosag_frm_gpi_12_cd,'drg_dosag_frm_gpi_12_cd',1,1]\n     [in0.package_qty,'package_qty',1,1]\n     [in0.drg_extd_nm_gpi_10_cd,'drg_extd_nm_gpi_10_cd',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
DO_LOOKUP||||1
EXTRA_DEDUP_SORT_KEY||||{ids_updt_dttm descending}
LOOKUP_KEY||||{dxf_sk}
RUN_ID||||$[string_split_no_empty(read_file(PUB_DATAHUB_SERIAL+"/run.idw.integration.all." + AI_PHASE + ".run_id.dat"),"\\n")[0]]
DO_CLEAN||||0
