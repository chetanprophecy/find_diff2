!prototype|P|||${AI_PSET}/get.join.files.interim.pset
DRIVER_SOURCE_NAME||||ids_common.d_cag
DRIVER_SOURCE_LOGICAL_NAME||||orca_rxclaim
TARGET_NAME||||rxclaim.d_reporting_client_map_d_cag
DRIVER_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_5a96a09e_bd5f_7 = $DRIVER_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_5a96a09e_bd5f_7 = $DRIVER_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.employer_group_id,[transform],in0.employer_group_id]\n  [out0.carrier_id,[transform],in0.carrier_id]\n  [out0.cag_sk,[passthrough],in0.dxf_sk]\n  [out0.account_id,[transform],in0.account_id]\n  [out0.d_report_carrier_id,[transform],in0.carrier_id]\n  [out0.filename,[passthrough],in0.filename]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.cag_sk,'cag_sk',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.d_report_carrier_id,'d_report_carrier_id',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n  ]\n  impacts:\n  [\n     [in0.newline,'newline',1,1]\n     [in0.account_id,'account_id',1,1]\n     [in0.employer_group_id,'employer_group_id',1,1]\n     [in0.carrier_id,'carrier_id',2,2]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.dxf_sk,'dxf_sk',2,2]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.filename,'filename',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) carrier_id = fail_if_error(first_defined(string_lrtrim(in0.carrier_id),'-'));\nlet string("\\x01",charset="iso-8859-15", maximum_length=40) account_id = fail_if_error(first_defined(string_lrtrim(in0.account_id),'-'));\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) employer_group_id = fail_if_error(first_defined(string_lrtrim(in0.employer_group_id),'-'));\nlet decimal("\\x01",0) cag_sk = fail_if_error(in0.dxf_sk);\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) d_report_carrier_id = fail_if_error(first_defined(string_lrtrim(in0.carrier_id),'-'));\n\n\n\n  out0.carrier_id::carrier_id;\n  out0.account_id::account_id;\n  out0.employer_group_id::employer_group_id;\n  out0.cag_sk::cag_sk;\n  out0.d_report_carrier_id::d_report_carrier_id;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_1_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_5a96a09e_bd5f_5 = $NON_DRIVER_1_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_5a96a09e_bd5f_5 = $NON_DRIVER_1_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.employer_group_id,[transform],in0.employer_group_id]\n  [out0.carrier_id,[transform],in0.carrier_id]\n  [out0.d_report_account_id,[transform],in0.account_id]\n  [out0.src_env_sk,[passthrough],in0.dxf_src_sys_id]\n  [out0.cag_sk,[transform],]\n  [out0.account_id,[transform],in0.account_id]\n  [out0.d_report_carrier_id,[transform],in0.carrier_id]\n  [out0.d_report_employer_group_id,[transform],in0.employer_group_id]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.effective_date,'effective_date',1,0]\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.d_report_account_id,'d_report_account_id',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.cag_sk,'cag_sk',1,0]\n     [out0.mbr_dtl_flg,'mbr_dtl_flg',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.d_report_carrier_id,'d_report_carrier_id',1,0]\n     [out0.bk_of_busines,'bk_of_busines',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.d_report_employer_group_id,'d_report_employer_group_id',1,0]\n     [out0.client_name,'client_name',1,0]\n  ]\n  impacts:\n  [\n     [in0.account_id,'account_id',2,2]\n     [in0.employer_group_id,'employer_group_id',2,2]\n     [in0.effective_date,'effective_date',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.carrier_id,'carrier_id',2,2]\n     [in0.mbr_dtl_flg,'mbr_dtl_flg',1,1]\n     [in0.dxf_src_sys_id,'DXF Source System ID',1,1]\n     [in0.bk_of_busines,'bk_of_busines',1,1]\n     [in0.client_name,'client_name',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet string("\\t") carrier_id = fail_if_error(string_lrtrim(in0.carrier_id));\nlet string("\\t") account_id = fail_if_error(string_lrtrim(in0.account_id));\nlet string("\\t") employer_group_id = fail_if_error(string_lrtrim(in0.employer_group_id));\nlet decimal("\\x01",0) cag_sk = -1;\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) d_report_carrier_id = fail_if_error(string_lrtrim(in0.carrier_id));\nlet string("\\x01",charset="iso-8859-15", maximum_length=40) d_report_account_id = fail_if_error(string_lrtrim(in0.account_id));\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) d_report_employer_group_id = fail_if_error(string_lrtrim(in0.employer_group_id));\nlet decimal("\\x01",0) src_env_sk = fail_if_error(in0.dxf_src_sys_id);\n\n\n\n  out0.carrier_id::carrier_id;\n  out0.account_id::account_id;\n  out0.employer_group_id::employer_group_id;\n  out0.cag_sk::cag_sk;\n  out0.d_report_carrier_id::d_report_carrier_id;\n  out0.d_report_account_id::d_report_account_id;\n  out0.d_report_employer_group_id::d_report_employer_group_id;\n  out0.src_env_sk::src_env_sk;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_2_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_5a96a09e_bd5f_8 = $NON_DRIVER_2_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_5a96a09e_bd5f_8 = $NON_DRIVER_2_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_3_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_5a96a09e_bd5f_6 = $NON_DRIVER_3_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_5a96a09e_bd5f_6 = $NON_DRIVER_3_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
OVERRIDE_JOIN_KEY||||{d_report_carrier_id}
OVERRIDE_JOIN_LEVEL_2_KEY||||{}
OVERRIDE_JOIN_LEVEL_3_KEY||||{}
LOOKUP_FIELDS_KEY||||{}
DRIVER_FILE_TYPE||||IDS
NON_DRIVER_1_SOURCE_NAME||||rxclaim.d_reporting_client_map
NON_DRIVER_1_FILE_TYPE||||Clean
DRIVER_OUTPUT_FIELDS||||carrier_id,account_id,employer_group_id,dxf_sk,newline
JOIN_KEY||||{d_report_carrier_id}
DO_CLEAN||||1
JOIN_XFR:sandbox||||$[\nbegin\nresult::'out::join(in0,in1)=\nbegin\nout.filename::in0.filename;\nout.dxf_sk::in0.dxf_sk;\nout.carrier_id::in0.carrier_id;\nout.account_id::in0.account_id;\nout.employer_group_id::in0.employer_group_id;\nout.ids_updt_dttm::in0.ids_updt_dttm;\nout.cag_sk::in0.dxf_sk;\nout.d_report_carrier_id::in1.carrier_id;\nout.d_report_account_id::in1.account_id;\nout.d_report_employer_group_id::in1.d_report_employer_group_id;\nout.src_env_sk::in1.src_env_sk;\nout.client_name::in1.client_name;\nout.effective_date::in1.effective_date;\nout.bk_of_busines::in1.bk_of_busines;\nout.mbr_dtl_flg::in1.mbr_dtl_flg;\nout.newline ::  in0.newline;\nend';\nend\n]
ADDITIONAL_FIELDS_DML||||record\n   decimal("\\x01",0)   cag_sk;\n   string("\\x01",charset="iso-8859-15", maximum_length=30) d_report_carrier_id = "";\n   string("\\x01",charset="iso-8859-15", maximum_length=40) d_report_account_id = "";\n   string("\\x01",charset="iso-8859-15", maximum_length=30) d_report_employer_group_id = "";\nend
JOIN_TYPE||||Inner Join
OUTPUT_FILTER_EXPR||||if(d_report_account_id == "*") 1 \nelse if(d_report_account_id != "*" and d_report_account_id == first_defined(account_id,"") and d_report_employer_group_id == "*") 1 \nelse if(d_report_account_id != "*" and d_report_account_id == first_defined(account_id,"") and d_report_employer_group_id == first_defined(employer_group_id,"")) 1 \nelse 0
NON_DRIVER_1_OUTPUT_FIELDS||||client_name,carrier_id,account_id,employer_group_id,effective_date,bk_of_busines,mbr_dtl_flg
