!prototype|P|||$AI_PSET/get.ids.interim.pset
SOURCE_NAME||||ids_rxclaim.d_mpa_plan_ovrd_vamd
TRANSFORM_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\ninclude '~$AI_XFR/bre_helper.map.xfr';\nlet decimal('') bzt_0_6c54cc0a_5b6a9c92_da9d_4 = $START_DATE;\nlet decimal('') bzt_1_6c54cc0a_5b6a9c92_da9d_4 = $END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.mbr_sk,'mbr_sk',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.src_add_ts,'src_add_ts',1,0]\n     [out0.dxf_hk_part1,'dxf_hk_part1',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.cag_sk,'cag_sk',1,0]\n     [out0.file_rec_cntr,'file_rec_cntr',1,0]\n     [out0.ovrd_gpi_cont_thrpy,'ovrd_gpi_cont_thrpy',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.src_dataset_id,'src_dataset_id',1,0]\n     [out0.prior_auth_nbr,'prior_auth_nbr',1,0]\n     [out0.mbr_id,'mbr_id',1,0]\n     [out0.dxf_hk_part2,'dxf_hk_part2',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.src_chg_ts,'src_chg_ts',1,0]\n     [out0.ovrd_refill_lim,'ovrd_refill_lim',1,0]\n     [out0.ovrd_ndc_cont_thrpy,'ovrd_ndc_cont_thrpy',1,0]\n     [out0.mpa_sk,'mpa_sk',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.ovrd_dur,'ovrd_dur',1,0]\n  ]\n  impacts:\n  [\n     [in0.account_id,'account_id',1,1]\n     [in0.mbr_sk,'mbr_sk',1,1]\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.ovrd_gpi_cont_thrpy,'ovrd_gpi_cont_thrpy',1,1]\n     [in0.employer_group_id,'employer_group_id',1,1]\n     [in0.file_rec_cntr,'file_rec_cntr',1,1]\n     [in0.dxf_hk_part1,'dxf_hk_part1',1,1]\n     [in0.src_add_ts,'src_add_ts',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.carrier_id,'carrier_id',1,1]\n     [in0.cag_sk,'cag_sk',1,1]\n     [in0.ovrd_dur,'ovrd_dur',1,1]\n     [in0.ovrd_refill_lim,'ovrd_refill_lim',1,1]\n     [in0.prior_auth_nbr,'prior_auth_nbr',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.ovrd_ndc_cont_thrpy,'ovrd_ndc_cont_thrpy',1,1]\n     [in0.mbr_id,'mbr_id',1,1]\n     [in0.src_dataset_id,'src_dataset_id',1,1]\n     [in0.dxf_hk_part2,'dxf_hk_part2',1,1]\n     [in0.src_chg_ts,'src_chg_ts',1,1]\n     [in0.mpa_sk,'mpa_sk',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
LOOKUP_FIELDS_KEY||||{}
SOURCE_FILE_PATTERN||||d_mpa_plan_ovrd.dat.gz
USER_DEFINED_OUTPUT_FIELDS||||dxf_hk_part1,dxf_hk_part2,dxf_sk,mpa_sk,mbr_sk,cag_sk,mbr_id,carrier_id,account_id,employer_group_id,prior_auth_nbr,ovrd_ndc_cont_thrpy,ovrd_gpi_cont_thrpy,ovrd_refill_lim,ovrd_dur,src_chg_ts,src_add_ts,src_env_sk,newline
FILTER_EXPRESSION||||$[\r\nbegin \r\nlet decimal (",") i = 0;\r\nlet string(",")[int] v_carrier_config_file_vec = string_split_no_empty(read_file(AI_SERIAL_LOOKUP+"/lookup.rxclaim/lookup.rxclaim.va_medallion_carrier_config.dat"),"\\n");\r\nlet string(",") [int]fields_vec = allocate();\r\nlet string(",") [int]fields_name_vec = record_info_item(read_type(AI_DML+"/lookup.rxclaim/lookup.rxclaim.va_medallion_carrier_config.dml"),"name");\r\n//let v_len = length_of(v_carrier_config_file_vec);\r\nlet string("~") transform = ""; \r\nlet int j=0;\r\nfor(j,j<length_of(v_carrier_config_file_vec))\r\nbegin\r\n  let string("")[int] field_val = string_split(v_carrier_config_file_vec[j],"|");\r\n  let int i = 0;\r\n  \r\n    transform = transform + "(string_lrtrim(first_defined("+fields_name_vec[0]+ ' ,"-"))=='   +'"'+field_val[0]+'"';\r\n    if(!is_blank(field_val[1]))\r\n       transform = transform + " and string_lrtrim(first_defined("+fields_name_vec[1]+ ' ,"-"))=='   +'"'+field_val[1]+'"'; \r\n     if(is_blank(field_val[2])) transform = transform + ")";\r\n    if(!is_blank(field_val[2]))\r\n       transform = transform+" and string_lrtrim(first_defined("+fields_name_vec[2]+ ' ,"-"))=='   +'"'+field_val[2]+'"'+")";\r\n\r\ntransform = transform + " or ";\r\n // end;\r\n  //if(length_of(v_carrier_config_file_vec)!=j)\r\n   //  transform = transform + " or ";\r\nend;\r\ntransform = string_truncate_explicit(transform,"utf8",string_rindex(transform,"or")-1);\r\nresult :: transform;\r\nend;\r\n]
