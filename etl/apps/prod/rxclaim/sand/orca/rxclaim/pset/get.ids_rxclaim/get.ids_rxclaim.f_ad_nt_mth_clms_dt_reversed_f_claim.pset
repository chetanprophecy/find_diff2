!prototype|P|||${AI_PSET}/get.join.files.interim.pset
DRIVER_SOURCE_NAME||||ids_rxclaim.f_audit_note_mthly_clms_detail
DRIVER_SOURCE_LOGICAL_NAME||||orca_rxclaim
TARGET_NAME||||ids_rxclaim.f_ad_nt_mth_clms_dt_reversed_f_claim
DRIVER_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fe1335_14fe_6 = $DRIVER_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fe1335_14fe_6 = $DRIVER_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.processing_month_end_dt,[transform],]\n  [out0.processing_month_start_dt,[transform],]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.phr_contact_nm,'phr_contact_nm',1,0]\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.audit_fraud_type_id,'audit_fraud_type_id',1,0]\n     [out0.audit_category_id,'audit_category_id',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.submd_mnth_id,'submd_mnth_id',1,0]\n     [out0.audit_fraud_violation_reason_id,'audit_fraud_violation_reason_id',1,0]\n     [out0.claim_nbr,'claim_nbr',1,0]\n     [out0.zero_reclaim,'zero_reclaim',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.audit_violation_reason_sk,'audit_violation_reason_sk',1,0]\n     [out0.audit_fraud_perpetrator_sk,'audit_fraud_perpetrator_sk',1,0]\n     [out0.audit_type_sk,'audit_type_sk',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.audit_fraud_type_sk,'audit_fraud_type_sk',1,0]\n     [out0.processing_month_end_dt,'processing_month_end_dt',1,0]\n     [out0.mbr_id,'mbr_id',1,0]\n     [out0.claim_seq_nbr,'claim_seq_nbr',1,0]\n     [out0.number_of_calls,'number_of_calls',1,0]\n     [out0.audit_call_note_id,'audit_call_note_id',1,0]\n     [out0.src_created_by,'src_created_by',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.number_of_emails,'number_of_emails',1,0]\n     [out0.call_note_entry_dt,'call_note_entry_dt',1,0]\n     [out0.audit_job_sk,'audit_job_sk',1,0]\n     [out0.adjustment_amt,'adjustment_amt',1,0]\n     [out0.claim_stat_id,'claim_stat_id',1,0]\n     [out0.comments,'comments',1,0]\n     [out0.audit_nonfraud_violation_reason_id,'audit_nonfraud_violation_reason_id',1,0]\n     [out0.audit_payment_type_id,'audit_payment_type_id',1,0]\n     [out0.audit_violation_reason_id,'audit_violation_reason_id',1,0]\n     [out0.auditior_id,'auditior_id',1,0]\n     [out0.audit_category_sk,'audit_category_sk',1,0]\n     [out0.audit_type_id,'audit_type_id',1,0]\n     [out0.audit_fraud_perpetrator_id,'audit_fraud_perpetrator_id',1,0]\n     [out0.src_update_ts,'src_update_ts',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.src_created_dt,'src_created_dt',1,0]\n     [out0.audit_nonfraud_violation_reason_sk,'audit_nonfraud_violation_reason_sk',1,0]\n     [out0.audit_payment_type_sk,'audit_payment_type_sk',1,0]\n     [out0.processing_month_start_dt,'processing_month_start_dt',1,0]\n     [out0.audit_fraud_violation_reason_sk,'audit_fraud_violation_reason_sk',1,0]\n     [out0.src_insert_dt,'src_insert_dt',1,0]\n  ]\n  impacts:\n  [\n     [in0.comments,'comments',1,1]\n     [in0.zero_reclaim,'zero_reclaim',1,1]\n     [in0.number_of_emails,'number_of_emails',1,1]\n     [in0.claim_stat_id,'claim_stat_id',1,1]\n     [in0.adjustment_amt,'adjustment_amt',1,1]\n     [in0.audit_fraud_type_id,'audit_fraud_type_id',1,1]\n     [in0.audit_payment_type_id,'audit_payment_type_id',1,1]\n     [in0.audit_nonfraud_violation_reason_sk,'audit_nonfraud_violation_reason_sk',1,1]\n     [in0.auditior_id,'auditior_id',1,1]\n     [in0.call_note_entry_dt,'call_note_entry_dt',1,1]\n     [in0.audit_violation_reason_id,'audit_violation_reason_id',1,1]\n     [in0.account_id,'account_id',1,1]\n     [in0.audit_category_id,'audit_category_id',1,1]\n     [in0.src_update_ts,'src_update_ts',1,1]\n     [in0.audit_payment_type_sk,'audit_payment_type_sk',1,1]\n     [in0.audit_fraud_type_sk,'audit_fraud_type_sk',1,1]\n     [in0.employer_group_id,'employer_group_id',1,1]\n     [in0.audit_fraud_perpetrator_sk,'audit_fraud_perpetrator_sk',1,1]\n     [in0.carrier_id,'carrier_id',1,1]\n     [in0.audit_nonfraud_violation_reason_id,'audit_nonfraud_violation_reason_id',1,1]\n     [in0.src_created_dt,'src_created_dt',1,1]\n     [in0.audit_type_id,'audit_type_id',1,1]\n     [in0.mbr_id,'mbr_id',1,1]\n     [in0.src_insert_dt,'src_insert_dt',1,1]\n     [in0.audit_fraud_violation_reason_id,'audit_fraud_violation_reason_id',1,1]\n     [in0.claim_nbr,'claim_nbr',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.submd_mnth_id,'submd_mnth_id',1,1]\n     [in0.phr_contact_nm,'phr_contact_nm',1,1]\n     [in0.audit_category_sk,'audit_category_sk',1,1]\n     [in0.audit_fraud_violation_reason_sk,'audit_fraud_violation_reason_sk',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.audit_call_note_id,'audit_call_note_id',1,1]\n     [in0.audit_job_sk,'audit_job_sk',1,1]\n     [in0.audit_type_sk,'audit_type_sk',1,1]\n     [in0.audit_violation_reason_sk,'audit_violation_reason_sk',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.audit_fraud_perpetrator_id,'audit_fraud_perpetrator_id',1,1]\n     [in0.number_of_calls,'number_of_calls',1,1]\n     [in0.src_created_by,'src_created_by',1,1]\n     [in0.claim_seq_nbr,'claim_seq_nbr',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet date("YYYYMMDD")("\\x01") processing_month_start_dt = (date("YYYYMMDD"))(string(""))bzt_0_6c54cc0a_58fe1335_14fe_6;\nlet date("YYYYMMDD")("\\x01") processing_month_end_dt = (date("YYYYMMDD"))(string(""))bzt_1_6c54cc0a_58fe1335_14fe_6;\n\n\n\n  out0.processing_month_start_dt::processing_month_start_dt;\n  out0.processing_month_end_dt::processing_month_end_dt;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_1_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fe1335_14fe_4 = $NON_DRIVER_1_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fe1335_14fe_4 = $NON_DRIVER_1_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.sbm_dt,'sbm_dt',1,0]\n     [out0.filled_dt,'filled_dt',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.mbr_sk,'mbr_sk',1,0]\n     [out0.prod_sk,'prod_sk',1,0]\n     [out0.pbr_sk,'pbr_sk',1,0]\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.cms_contract_id,'cms_contract_id',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.claim_seq_nbr,'claim_seq_nbr',1,0]\n     [out0.pbr_st_cd,'pbr_st_cd',1,0]\n     [out0.phr_ncpdp_id,'phr_ncpdp_id',1,0]\n     [out0.drg_qty,'drg_qty',1,0]\n     [out0.drg_ndc_short_id,'drg_ndc_short_id',1,0]\n     [out0.drg_lbl_nm,'drg_lbl_nm',1,0]\n     [out0.processing_month_start_dt,'processing_month_start_dt',1,0]\n     [out0.prod_id,'prod_id',1,0]\n     [out0.pbr_dea_id,'pbr_dea_id',1,0]\n     [out0.cag_sk,'cag_sk',1,0]\n     [out0.days_sply,'days_sply',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.mbr_id,'mbr_id',1,0]\n     [out0.phr_npi_no,'phr_npi_no',1,0]\n     [out0.phr_st_cd,'phr_st_cd',1,0]\n     [out0.rx_written_dt,'rx_written_dt',1,0]\n     [out0.phr_state_cd_sk,'phr_state_cd_sk',1,0]\n     [out0.claim_nbr,'claim_nbr',1,0]\n     [out0.cms_pbp_id,'cms_pbp_id',1,0]\n     [out0.compound_sk,'compound_sk',1,0]\n     [out0.app_due_amt,'app_due_amt',1,0]\n     [out0.processing_month_end_dt,'processing_month_end_dt',1,0]\n     [out0.claim_stat_id,'claim_stat_id',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.phr_sk,'phr_sk',1,0]\n     [out0.pbr_npi_id,'pbr_npi_id',1,0]\n     [out0.rx_nbr,'rx_nbr',1,0]\n  ]\n  impacts:\n  [\n     [in0.pbr_dea_id,'pbr_dea_id',1,1]\n     [in0.drg_ndc_short_id,'drg_ndc_short_id',1,1]\n     [in0.phr_npi_no,'phr_npi_no',1,1]\n     [in0.claim_nbr,'claim_nbr',1,1]\n     [in0.d_cag.carrier_id,'carrier_id',1,1]\n     [in0.cms_contract_id,'cms_contract_id',1,1]\n     [in0.app_due_amt,'app_due_amt',1,1]\n     [in0.compound_sk,'compound_sk',1,1]\n     [in0.d_mbr.mbr_id,'mbr_id',1,1]\n     [in0.days_sply,'days_sply',1,1]\n     [in0.cms_pbp_id,'cms_pbp_id',1,1]\n     [in0.sbm_dt,'sbm_dt',1,1]\n     [in0.mbr_sk,'mbr_sk',1,1]\n     [in0.d_cag.employer_group_id,'employer_group_id',1,1]\n     [in0.phr_st_cd,'phr_st_cd',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.pbr_sk,'pbr_sk',1,1]\n     [in0.pbr_npi_id,'pbr_npi_id',1,1]\n     [in0.claim_seq_nbr,'claim_seq_nbr',1,1]\n     [in0.drg_qty,'drg_qty',1,1]\n     [in0.processing_month_start_dt,'processing_month_start_dt',1,1]\n     [in0.prod_id,'prod_id',1,1]\n     [in0.phr_state_cd_sk,'phr_state_cd_sk',1,1]\n     [in0.phr_sk,'phr_sk',1,1]\n     [in0.rx_nbr,'rx_nbr',1,1]\n     [in0.pbr_st_cd,'pbr_st_cd',1,1]\n     [in0.prod_sk,'prod_sk',1,1]\n     [in0.claim_stat_id,'claim_stat_id',1,1]\n     [in0.filled_dt,'filled_dt',1,1]\n     [in0.cag_sk,'cag_sk',1,1]\n     [in0.processing_month_end_dt,'processing_month_end_dt',1,1]\n     [in0.d_cag.account_id,'account_id',1,1]\n     [in0.rx_written_dt,'rx_written_dt',1,1]\n     [in0.drg_lbl_nm,'drg_lbl_nm',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.phr_ncpdp_id,'phr_ncpdp_id',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) carrier_id = fail_if_error(in0.d_cag.carrier_id);\nlet string("\\x01",charset="iso-8859-15", maximum_length=40) account_id = fail_if_error(in0.d_cag.account_id);\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) employer_group_id = fail_if_error(in0.d_cag.employer_group_id);\nlet string("\\x01",charset="iso-8859-15", maximum_length=20) mbr_id = fail_if_error(in0.d_mbr.mbr_id);\n\n\n\n  out0.carrier_id::carrier_id;\n  out0.account_id::account_id;\n  out0.employer_group_id::employer_group_id;\n  out0.mbr_id::mbr_id;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_2_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fe1335_14fe_7 = $NON_DRIVER_2_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fe1335_14fe_7 = $NON_DRIVER_2_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_3_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fe1335_14fe_5 = $NON_DRIVER_3_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fe1335_14fe_5 = $NON_DRIVER_3_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
OVERRIDE_JOIN_KEY||||{claim_nbr}
OVERRIDE_JOIN_LEVEL_2_KEY||||{}
OVERRIDE_JOIN_LEVEL_3_KEY||||{}
LOOKUP_FIELDS_KEY||||{}
DRIVER_OUTPUT_FIELDS||||claim_nbr,submd_mnth_id,audit_category_sk,audit_payment_type_sk,audit_job_sk,audit_type_sk,audit_fraud_type_sk,audit_violation_reason_sk,audit_fraud_violation_reason_sk,audit_fraud_perpetrator_sk,audit_nonfraud_violation_reason_sk,auditior_id,audit_call_note_id,call_note_entry_dt,adjustment_amt,audit_category_id,zero_reclaim,audit_payment_type_id,phr_contact_nm,number_of_calls,number_of_emails,audit_type_id,audit_fraud_type_id,audit_violation_reason_id,audit_fraud_violation_reason_id,audit_fraud_perpetrator_id,audit_nonfraud_violation_reason_id,comments,src_created_dt,src_created_by,src_insert_dt,src_update_ts
DRIVER_FILTER_EXPR||||is_null(claim_seq_nbr)
NON_DRIVER_1_SOURCE_NAME||||ids_rxclaim.f_clm_phr_prd_prs_mth
NON_DRIVER_1_FILE_TYPE||||Clean
NON_DRIVER_1_OUTPUT_FIELDS||||claim_nbr,mbr_sk,cag_sk,phr_sk,pbr_sk,prod_sk,compound_sk,claim_seq_nbr,claim_stat_id,sbm_dt,rx_nbr,phr_ncpdp_id,phr_npi_no,phr_st_cd,phr_state_cd_sk,filled_dt,rx_written_dt,days_sply,drg_qty,prod_id,drg_ndc_short_id,drg_lbl_nm,cms_contract_id,cms_pbp_id,app_due_amt,processing_month_start_dt,processing_month_end_dt,pbr_dea_id,pbr_npi_id,pbr_st_cd
DO_CLEAN||||1
JOIN_TYPE||||Left Outer Join
JOIN_KEY||||{claim_nbr}
JOIN_XFR:sandbox||||out :: join(in0, in1) = \nbegin\n  out.processing_month_start_dt :1: in0.processing_month_start_dt;\n  out.processing_month_end_dt :2: in0.processing_month_end_dt;\n  out.* :3: in1.*;\n  out.* :4: in0.*;\nend
ADDITIONAL_FIELDS_DML||||record\n  decimal("\\x01",0)    claim_seq_nbr = NULL("");\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    claim_stat_id = NULL("");\n  date("YYYYMMDD")("\\x01")   processing_month_start_dt;\n  date("YYYYMMDD")("\\x01")   processing_month_end_dt;\n  string("\\x01",charset="iso-8859-15", maximum_length=30)            carrier_id = NULL("") /*VARCHAR(30)*/;\n  string("\\x01",charset="iso-8859-15", maximum_length=40)            account_id = NULL("") /*VARCHAR(40)*/;\n  string("\\x01",charset="iso-8859-15", maximum_length=30)            employer_group_id = NULL("") /*VARCHAR(30)*/;\n  string("\\x01",charset="iso-8859-15", maximum_length=20)            mbr_id = NULL("") /*VARCHAR(20)*/;\nend
NON_DRIVER_1_FILTER_EXPR||||claim_stat_id == "X"
