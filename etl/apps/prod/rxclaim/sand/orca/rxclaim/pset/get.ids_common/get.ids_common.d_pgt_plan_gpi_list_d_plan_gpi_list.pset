!prototype|P|||${AI_PSET}/get.join.files.interim.pset
DRIVER_SOURCE_NAME||||ids_common.d_pgt_plan_gpi_list.reduced
DRIVER_SOURCE_LOGICAL_NAME||||orca_rxclaim
TARGET_NAME||||ids_common.d_pgt_plan_gpi_list_d_plan_gpi_list_p90
DRIVER_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_599564e4_1799_2 = $DRIVER_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_599564e4_1799_2 = $DRIVER_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.ids_create_run_id,'ids_create_run_id',1,0]\n     [out0.ids_rec_stat_cd,'ids_rec_stat_cd',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.pln_cd,'pln_cd',1,0]\n     [out0.pgt_from_dt,'pgt_from_dt',1,0]\n     [out0.dxf_hk_part2,'dxf_hk_part2',1,0]\n     [out0.pln_eff_dt,'pln_eff_dt',1,0]\n     [out0.ids_create_dttm,'ids_create_dttm',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.pgt_status,'pgt_status',1,0]\n     [out0.dxf_hk_part1,'dxf_hk_part1',1,0]\n     [out0.pgt_thru_dt,'pgt_thru_dt',1,0]\n     [out0.ids_create_uid,'ids_create_uid',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.ids_updt_uid,'ids_updt_uid',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.ids_updt_run_id,'ids_updt_run_id',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.pln_sk,'pln_sk',1,0]\n     [out0.pgl_gpi_list_nm,'pgl_gpi_list_nm',1,0]\n     [out0.pgt_plan_gpi_sk,'pgt_plan_gpi_sk',1,0]\n     [out0.dxf_src_sys_id,'dxf_src_sys_id',1,0]\n  ]\n  impacts:\n  [\n     [in0.pgt_thru_dt,'pgt_thru_dt',1,1]\n     [in0.pln_cd,'pln_cd',1,1]\n     [in0.ids_create_uid,'ids_create_uid',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.pln_eff_dt,'pln_eff_dt',1,1]\n     [in0.pgl_gpi_list_nm,'pgl_gpi_list_nm',1,1]\n     [in0.pgt_plan_gpi_sk,'pgt_plan_gpi_sk',1,1]\n     [in0.ids_create_run_id,'ids_create_run_id',1,1]\n     [in0.dxf_hk_part2,'dxf_hk_part2',1,1]\n     [in0.pgt_status,'pgt_status',1,1]\n     [in0.ids_updt_run_id,'ids_updt_run_id',1,1]\n     [in0.dxf_src_sys_id,'dxf_src_sys_id',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.pgt_from_dt,'pgt_from_dt',1,1]\n     [in0.ids_rec_stat_cd,'ids_rec_stat_cd',1,1]\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.dxf_hk_part1,'dxf_hk_part1',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.pln_sk,'pln_sk',1,1]\n     [in0.ids_create_dttm,'ids_create_dttm',1,1]\n     [in0.ids_updt_uid,'ids_updt_uid',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_1_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_599564e4_1799_0 = $NON_DRIVER_1_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_599564e4_1799_0 = $NON_DRIVER_1_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.pgo_generic_product_id,'pgo_generic_product_id',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.ids_updt_run_id,'ids_updt_run_id',1,0]\n     [out0.ids_create_run_id,'ids_create_run_id',1,0]\n     [out0.pgo_generic_name,'pgo_generic_name',1,0]\n     [out0.pno_current_drug_status,'pno_current_drug_status',1,0]\n     [out0.ids_rec_stat_cd,'ids_rec_stat_cd',1,0]\n     [out0.pno_previous_dt_effective,'pno_previous_dt_effective',1,0]\n     [out0.dxf_hk_part1,'dxf_hk_part1',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.ids_create_dttm,'ids_create_dttm',1,0]\n     [out0.pno_current_dte_effective,'pno_current_dte_effective',1,0]\n     [out0.pgo_multi_source_cd,'pgo_multi_source_cd',1,0]\n     [out0.ids_create_uid,'ids_create_uid',1,0]\n     [out0.pgl_gpi_list_name,'pgl_gpi_list_name',1,0]\n     [out0.pno_previous_dt_termed,'pno_previous_dt_termed',1,0]\n     [out0.pln_gpi_lst_sk,'pln_gpi_lst_sk',1,0]\n     [out0.dxf_hk_part2,'dxf_hk_part2',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.dxf_src_sys_id,'dxf_src_sys_id',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.ids_updt_uid,'ids_updt_uid',1,0]\n     [out0.pno_current_dte_termed,'pno_current_dte_termed',1,0]\n  ]\n  impacts:\n  [\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.pno_current_dte_termed,'pno_current_dte_termed',1,1]\n     [in0.ids_create_run_id,'ids_create_run_id',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.pno_previous_dt_effective,'pno_previous_dt_effective',1,1]\n     [in0.pno_current_drug_status,'pno_current_drug_status',1,1]\n     [in0.pgo_generic_name,'pgo_generic_name',1,1]\n     [in0.dxf_hk_part1,'dxf_hk_part1',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.pno_previous_dt_termed,'pno_previous_dt_termed',1,1]\n     [in0.pno_current_dte_effective,'pno_current_dte_effective',1,1]\n     [in0.ids_create_uid,'ids_create_uid',1,1]\n     [in0.pln_gpi_lst_sk,'pln_gpi_lst_sk',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.pgl_gpi_list_name,'pgl_gpi_list_name',1,1]\n     [in0.dxf_hk_part2,'dxf_hk_part2',1,1]\n     [in0.ids_create_dttm,'ids_create_dttm',1,1]\n     [in0.ids_updt_run_id,'ids_updt_run_id',1,1]\n     [in0.pgo_multi_source_cd,'pgo_multi_source_cd',1,1]\n     [in0.ids_updt_uid,'ids_updt_uid',1,1]\n     [in0.ids_rec_stat_cd,'ids_rec_stat_cd',1,1]\n     [in0.dxf_src_sys_id,'dxf_src_sys_id',1,1]\n     [in0.pgo_generic_product_id,'pgo_generic_product_id',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_2_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_599564e4_1799_3 = $NON_DRIVER_2_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_599564e4_1799_3 = $NON_DRIVER_2_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_3_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_599564e4_1799_1 = $NON_DRIVER_3_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_599564e4_1799_1 = $NON_DRIVER_3_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
OVERRIDE_JOIN_KEY||||{pgl_gpi_list_name; src_env_sk}
OVERRIDE_JOIN_LEVEL_2_KEY||||{}
OVERRIDE_JOIN_LEVEL_3_KEY||||{}
LOOKUP_FIELDS_KEY||||{pgl_gpi_list_nm;pgt_status;pgt_from_dt;pgt_thru_dt;pgo_generic_product_id;pno_current_dte_effective;pno_current_dte_termed;pgo_multi_source_cd;pgo_generic_product_id_14;pgo_generic_product_id_12;pgo_generic_product_id_10;pgo_generic_product_id_8;pgo_generic_product_id_6;pgo_generic_product_id_4;pgo_generic_product_id_2;pln_sk;pln_cd;pln_eff_dt}
NON_DRIVER_1_SOURCE_NAME||||ids_rxclaim.d_plan_gpi_list.reduced
ENABLE_JOIN_LEVEL_2||||0
JOIN_TYPE||||Inner Join
JOIN_KEY||||{pgl_gpi_list_nm; src_env_sk}
DO_LOOKUP||||1
LOOKUP_KEY||||{pln_sk; pgl_gpi_list_nm; pgo_generic_product_id; pno_current_dte_effective; pno_current_dte_termed; pgt_from_dt; pgt_thru_dt; pgo_multi_source_cd}
DO_CLEAN||||0
LOOKUP_DML||||record\r\n  string("\\x01",charset="iso-8859-15", maximum_length=10) pgl_gpi_list_nm = NULL("") /*VARCHAR(10)*/;\r\n  date("YYYYMMDD")("\\x01") pgt_from_dt = NULL("") /*DATE*/;\r\n  date("YYYYMMDD")("\\x01") pgt_thru_dt = NULL("") /*DATE*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1) pgt_status = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=18) pgo_generic_product_id = NULL("") /*VARCHAR(18)*/;\r\n   \r\n  decimal("\\x01",0)    pln_sk = NULL("") /*BIGINT*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=10)    pln_cd = NULL("") /*VARCHAR(10)*/;\r\n  date("YYYYMMDD")("\\x01")    pln_eff_dt = NULL("") /*DATE*/;\r\n  \r\n  date("YYYYMMDD")("\\x01") pno_current_dte_effective = NULL("") /*DATE*/;\r\n  date("YYYYMMDD")("\\x01") pno_current_dte_termed = NULL("") /*DATE*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1) pgo_multi_source_cd = NULL("") /*CHAR(1)*/;\r\nend
JOIN_XFR:sandbox||||out::join(in0, in1)=\r\nbegin\r\nlet string("\\x01",charset="iso-8859-15", maximum_length=18) v_pgo_generic_product_id = string_substring(string_ltrim(in1.pgo_generic_product_id),1,18);\r\n\r\n  out.pgl_gpi_list_nm :1: in0.pgl_gpi_list_nm;\r\n  out.pgl_gpi_list_nm :2: in1.pgl_gpi_list_name;\r\n  out.pgo_generic_product_id::v_pgo_generic_product_id;\r\n  out.* :1: in0.*;\r\n  out.* :2: in1.*;\r\nend;
DRIVER_OUTPUT_DML||||/* Do Not Edit.  This file is generated automatically by combining\r\n * "$AI_DML/dxf_header.dml", any "$ADDITIONAL_FIELDS_DML", and\r\n * "$AI_DML/get.$TARGET_SYSTEM/get.$TARGET_LOWER.dml".\r\n * Changing the Get DML and resaving the get configuration will update this file.\r\n */\r\n\r\nrecord\r\n  string('\\x01') filename;\r\n  unsigned integer(8)     dxf_hk_part1 =     0 /*Added by Integration Framework. First 8 bytes of the natural key hash.*/;\r\n  unsigned integer(8)     dxf_hk_part2 =     0 /*Added by Integration Framework. Second 8 bytes of the natural key hash.*/;\r\n  integer(8)     dxf_sk =     0 /*Added by Integration Framework. Surrogate key.*/;\r\n  decimal("\\x01",0)    pgt_plan_gpi_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0)    pln_sk = NULL("") /*BIGINT*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=10)    pln_cd = NULL("") /*VARCHAR(10)*/;\r\n  date("YYYYMMDD")("\\x01")    pln_eff_dt = NULL("") /*DATE*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=2)    pgt_list_type = NULL("") /*VARCHAR(2)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=10)    pgl_gpi_list_nm = NULL("") /*VARCHAR(10)*/;\r\n  decimal("\\x01",0)    pgt_seq_nbr = NULL("") /*INTEGER*/;\r\n  date("YYYYMMDD")("\\x01")    pgt_from_dt = NULL("") /*DATE*/;\r\n  date("YYYYMMDD")("\\x01")    pgt_thru_dt = NULL("") /*DATE*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_status = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_prcssng_qlfr = NULL("") /*CHAR(1)*/;\r\n  decimal("\\x01",0)    pgt_seq_search = NULL("") /*INTEGER*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=10)    pgt_pln_default_list = NULL("") /*VARCHAR(10)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_non_prf_brnd_ind = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_cntngnt_thrpy_ind = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_daily_dose_ind = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_grace_period_ind = NULL("") /*CHAR(1)*/;\r\n  decimal("\\x01",0)    pgt_grace_period_days = NULL("") /*INTEGER*/;\r\n  date("YYYYMMDD")("\\x01")    pgt_grace_period_eff_dt = NULL("") /*DATE*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=10)    pgt_grp_schedule_id = NULL("") /*VARCHAR(10)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_first_fill_drug_sts = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=10)    pgt_suppl_rej_cde_tbl = NULL("") /*VARCHAR(10)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_non_prf_brand_lvl = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=2)    pgt_non_prf_brand_wc = NULL("") /*VARCHAR(2)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_cntngnt_thrpy_lvl = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=2)    pgt_cntngnt_thrpy_wc = NULL("") /*VARCHAR(2)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_daily_dose_lvl = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=2)    pgt_daily_dose_wc = NULL("") /*VARCHAR(2)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_prior_stthrpy_exempt = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    pgt_prior_stthrpy_drg_sts = NULL("") /*CHAR(1)*/;\r\n  decimal("\\x01",0)    pgt_period_qty_max_mult = NULL("") /*INTEGER*/;\r\n  \r\n  decimal("\\x01", maximum_length=5)      dxf_src_sys_id =      0;\r\n  datetime("YYYYMMDDHH24MISS")("\\x01")      ids_create_dttm = NULL("");\r\n  string("\\x01", maximum_length=20)      ids_create_uid = NULL("");\r\n  decimal("\\x01",maximum_length=20)      ids_create_run_id =      0;\r\n  datetime("YYYYMMDDHH24MISS")("\\x01")      ids_updt_dttm = NULL("");\r\n  string("\\x01", maximum_length=20)      ids_updt_uid = NULL("");\r\n  decimal("\\x01",maximum_length=20)      ids_updt_run_id =      0;\r\n  string("\\x01",maximum_length=2)      ids_rec_stat_cd = NULL("");\r\n  string(1)    newline =    "\\n";\r\n  decimal("\\x01",0)   src_env_sk = NULL("");\r\nend\r\n;
NON_DRIVER_1_PRE_DEDUP_FILTER||||src_env_sk==490
DRIVER_DEDUP_ON_JOIN_KEY||||False
DRIVER_PRE_DEDUP_FILTER||||src_env_sk==490
DRIVER_FILTER_EXPR||||pgt_status=="A" and (first_defined(string_substring(pgl_gpi_list_nm,1,5),"") member [vector "UXMSS","UXMSP","UXS9S","UXS9P","UXC9S","UXC9P"] or first_defined(string_substring(pgl_gpi_list_nm,1,6),"")  member [vector "UXMSMS","UXS9P1","UXC9P1"])
NON_DRIVER_1_FILTER_EXPR||||first_defined(string_substring(pgl_gpi_list_name,1,5),"") member [vector "UXMSS","UXMSP","UXS9S","UXS9P","UXC9S","UXC9P"] or first_defined(string_substring(pgl_gpi_list_name,1,6),"")  member [vector "UXMSMS","UXS9P1","UXC9P1"]
