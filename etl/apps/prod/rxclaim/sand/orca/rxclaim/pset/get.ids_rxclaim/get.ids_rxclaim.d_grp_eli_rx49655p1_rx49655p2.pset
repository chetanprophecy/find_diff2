!prototype|P|||${AI_PSET}/get.join.files.interim.pset
DRIVER_SOURCE_NAME||||ids_common.d_group_eligibility
DRIVER_SOURCE_LOGICAL_NAME||||orca_rxclaim
TARGET_NAME||||ids_rxclaim.d_grp_eli_rx49655p1_rx49655p2
DRIVER_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_592bcb39_1e5a_1 = $DRIVER_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_592bcb39_1e5a_1 = $DRIVER_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.gel_status,'gel_status',1,0]\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.ids_create_run_id,'ids_create_run_id',1,0]\n     [out0.ids_rec_stat_cd,'ids_rec_stat_cd',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.pln_cd,'pln_cd',1,0]\n     [out0.dxf_hk_part2,'dxf_hk_part2',1,0]\n     [out0.pln_eff_dt,'pln_eff_dt',1,0]\n     [out0.gel_copay4,'gel_copay4',1,0]\n     [out0.gel_copay3,'gel_copay3',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.cag_sk,'cag_sk',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.gel_seq_nbr,'gel_seq_nbr',1,0]\n     [out0.ids_create_dttm,'ids_create_dttm',1,0]\n     [out0.gel_brand_copay,'gel_brand_copay',1,0]\n     [out0.gel_copay5,'gel_copay5',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.gel_copay6,'gel_copay6',1,0]\n     [out0.dxf_hk_part1,'dxf_hk_part1',1,0]\n     [out0.gel_copay8,'gel_copay8',1,0]\n     [out0.gel_clt_benefit_cd,'gel_clt_benefit_cd',1,0]\n     [out0.grp_eligty_sk,'grp_eligty_sk',1,0]\n     [out0.gel_copay7,'gel_copay7',1,0]\n     [out0.ids_create_uid,'ids_create_uid',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.gel_eff_dt,'gel_eff_dt',1,0]\n     [out0.ids_updt_uid,'ids_updt_uid',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.ids_updt_run_id,'ids_updt_run_id',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.gel_thru_dt,'gel_thru_dt',1,0]\n     [out0.gel_generic_copay,'gel_generic_copay',1,0]\n     [out0.dxf_src_sys_id,'dxf_src_sys_id',1,0]\n  ]\n  impacts:\n  [\n     [in0.grp_eligty_sk,'grp_eligty_sk',1,1]\n     [in0.gel_status,'gel_status',1,1]\n     [in0.pln_cd,'pln_cd',1,1]\n     [in0.ids_create_uid,'ids_create_uid',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.gel_clt_benefit_cd,'gel_clt_benefit_cd',1,1]\n     [in0.gel_copay3,'gel_copay3',1,1]\n     [in0.gel_copay4,'gel_copay4',1,1]\n     [in0.pln_eff_dt,'pln_eff_dt',1,1]\n     [in0.account_id,'account_id',1,1]\n     [in0.employer_group_id,'employer_group_id',1,1]\n     [in0.ids_create_run_id,'ids_create_run_id',1,1]\n     [in0.carrier_id,'carrier_id',1,1]\n     [in0.cag_sk,'cag_sk',1,1]\n     [in0.dxf_hk_part2,'dxf_hk_part2',1,1]\n     [in0.gel_thru_dt,'gel_thru_dt',1,1]\n     [in0.gel_copay5,'gel_copay5',1,1]\n     [in0.ids_updt_run_id,'ids_updt_run_id',1,1]\n     [in0.dxf_src_sys_id,'dxf_src_sys_id',1,1]\n     [in0.gel_copay7,'gel_copay7',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.gel_copay8,'gel_copay8',1,1]\n     [in0.gel_copay6,'gel_copay6',1,1]\n     [in0.gel_generic_copay,'gel_generic_copay',1,1]\n     [in0.gel_eff_dt,'gel_eff_dt',1,1]\n     [in0.ids_rec_stat_cd,'ids_rec_stat_cd',1,1]\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.dxf_hk_part1,'dxf_hk_part1',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.gel_brand_copay,'gel_brand_copay',1,1]\n     [in0.gel_seq_nbr,'gel_seq_nbr',1,1]\n     [in0.ids_create_dttm,'ids_create_dttm',1,1]\n     [in0.ids_updt_uid,'ids_updt_uid',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;
NON_DRIVER_1_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_592bcb39_1e5a_3 = $NON_DRIVER_1_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_592bcb39_1e5a_3 = $NON_DRIVER_1_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.employer_group_id,[passthrough],in0.p1grpid]\n  [out0.carrier_id,[passthrough],in0.p1carrid]\n  [out0.account_id,[passthrough],in0.p1acctid]\n  [out0.gel_thru_dt,[transform],in0.p1grpthrdt]\n  [out0.gel_eff_dt,[transform],in0.p1grpeffdt]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.p1grpthrdt,'p1grpthrdt',1,0]\n     [out0.cdc_flag,'cdc_flag',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.p1grpeffdt,'p1grpeffdt',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.p1filler,'p1filler',1,0]\n     [out0.p1grpid,'p1grpid',1,0]\n     [out0.p1acctid,'p1acctid',1,0]\n     [out0.cdc_ts,'cdc_ts',1,0]\n     [out0.dxf_src_rec_cnt,'DXF Source Record Count',1,0]\n     [out0.dxf_src_sys_id,'DXF Source System ID',1,0]\n     [out0.gel_thru_dt,'gel_thru_dt',1,0]\n     [out0.gel_eff_dt,'gel_eff_dt',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.p1carrid,'p1carrid',1,0]\n     [out0.dxf_src_file_name,'DXF Source File Name',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.p1exttim,'p1exttim',1,0]\n     [out0.p1situsst,'p1situsst',1,0]\n     [out0.dxf_src_dataset_id,'DXF Source Dataset ID',1,0]\n     [out0.p1extdat,'p1extdat',1,0]\n  ]\n  impacts:\n  [\n     [in0.p1acctid,'p1acctid',2,2]\n     [in0.p1carrid,'p1carrid',2,2]\n     [in0.p1grpeffdt,'p1grpeffdt',2,2]\n     [in0.filename,'filename',1,1]\n     [in0.p1grpid,'p1grpid',2,2]\n     [in0.dxf_src_dataset_id,'DXF Source Dataset ID',1,1]\n     [in0.p1extdat,'p1extdat',1,1]\n     [in0.p1grpthrdt,'p1grpthrdt',2,2]\n     [in0.p1exttim,'p1exttim',1,1]\n     [in0.cdc_flag,'cdc_flag',1,1]\n     [in0.dxf_src_file_name,'DXF Source File Name',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.cdc_ts,'cdc_ts',1,1]\n     [in0.dxf_src_rec_cnt,'DXF Source Record Count',1,1]\n     [in0.dxf_src_sys_id,'DXF Source System ID',1,1]\n     [in0.p1situsst,'p1situsst',1,1]\n     [in0.p1filler,'p1filler',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) carrier_id = fail_if_error(in0.p1carrid);\nlet string("\\x01",charset="iso-8859-15", maximum_length=40) account_id = fail_if_error(in0.p1acctid);\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) employer_group_id = fail_if_error(in0.p1grpid);\nlet date("YYYYMMDD")("\\x01") gel_eff_dt = fail_if_error((date("YYYYMMDD"))string_filter_out(in0.p1grpeffdt,"-"));\nlet date("YYYYMMDD")("\\x01") gel_thru_dt = fail_if_error((date("YYYYMMDD"))string_filter_out(in0.p1grpthrdt,"-"));\n\n\n\n  out0.carrier_id::carrier_id;\n  out0.account_id::account_id;\n  out0.employer_group_id::employer_group_id;\n  out0.gel_eff_dt::gel_eff_dt;\n  out0.gel_thru_dt::gel_thru_dt;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_2_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_592bcb39_1e5a_0 = $NON_DRIVER_2_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_592bcb39_1e5a_0 = $NON_DRIVER_2_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.pln_cd,[passthrough],in0.p2plncde]\n  [out0.pln_eff_dt,[transform],in0.p2plneffdt]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.p2extdat,'p2extdat',1,0]\n     [out0.p2exttim,'p2exttim',1,0]\n     [out0.p2frmdes,'p2frmdes',1,0]\n     [out0.cdc_flag,'cdc_flag',1,0]\n     [out0.pln_cd,'pln_cd',1,0]\n     [out0.p2filler,'p2filler',1,0]\n     [out0.p2frmcde,'p2frmcde',1,0]\n     [out0.p2plneffdt,'p2plneffdt',1,0]\n     [out0.cdc_ts,'cdc_ts',1,0]\n     [out0.dxf_src_rec_cnt,'DXF Source Record Count',1,0]\n     [out0.pln_eff_dt,'pln_eff_dt',1,0]\n     [out0.dxf_src_sys_id,'DXF Source System ID',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.dxf_src_file_name,'DXF Source File Name',1,0]\n     [out0.p2plnthrdt,'p2plnthrdt',1,0]\n     [out0.p2plncde,'p2plncde',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.dxf_src_dataset_id,'DXF Source Dataset ID',1,0]\n  ]\n  impacts:\n  [\n     [in0.p2frmcde,'p2frmcde',1,1]\n     [in0.p2filler,'p2filler',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.p2plncde,'p2plncde',2,2]\n     [in0.dxf_src_dataset_id,'DXF Source Dataset ID',1,1]\n     [in0.p2exttim,'p2exttim',1,1]\n     [in0.p2frmdes,'p2frmdes',1,1]\n     [in0.cdc_flag,'cdc_flag',1,1]\n     [in0.dxf_src_file_name,'DXF Source File Name',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.p2extdat,'p2extdat',1,1]\n     [in0.cdc_ts,'cdc_ts',1,1]\n     [in0.dxf_src_rec_cnt,'DXF Source Record Count',1,1]\n     [in0.dxf_src_sys_id,'DXF Source System ID',1,1]\n     [in0.p2plnthrdt,'p2plnthrdt',1,1]\n     [in0.p2plneffdt,'p2plneffdt',2,2]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet date("YYYYMMDD")("\\x01") pln_eff_dt = fail_if_error((date("YYYYMMDD"))string_filter_out(in0.p2plneffdt,"-"));\nlet string("\\x01",charset="iso-8859-15", maximum_length=10) pln_cd = fail_if_error(in0.p2plncde);\n\n\n\n  out0.pln_eff_dt::pln_eff_dt;\n  out0.pln_cd::pln_cd;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_3_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_592bcb39_1e5a_2 = $NON_DRIVER_3_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_592bcb39_1e5a_2 = $NON_DRIVER_3_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
OVERRIDE_JOIN_KEY||||{carrier_id; account_id; employer_group_id; gel_eff_dt; gel_thru_dt}
OVERRIDE_JOIN_LEVEL_2_KEY||||{pln_cd; pln_eff_dt}
OVERRIDE_JOIN_LEVEL_3_KEY||||{}
LOOKUP_FIELDS_KEY||||{}
DRIVER_FILTER_EXPR||||src_env_sk member [vector 480,490]
NON_DRIVER_1_SOURCE_NAME||||rxclaim_orx.rx49655p1
JOIN_KEY||||{carrier_id; account_id; employer_group_id; gel_eff_dt; gel_thru_dt}
DO_CLEAN||||1
ENABLE_JOIN_LEVEL_2||||1
NON_DRIVER_2_SOURCE_NAME||||rxclaim_orx.rx49655p2
JOIN_LEVEL_2_KEY||||{pln_cd; pln_eff_dt}
ADDITIONAL_FIELDS_DML||||record\n      string("\\x01",charset="iso-8859-15", maximum_length=30)  carrier_id = NULL("") /*CHAR(30)*/;\n      string("\\x01",charset="iso-8859-15", maximum_length=40) account_id = NULL("") /*VARCHAR(40)*/;\n      string("\\x01",charset="iso-8859-15", maximum_length=30) employer_group_id = NULL("") /*VARCHAR(30)*/;\n      date("YYYYMMDD")("\\x01") pln_eff_dt = NULL("") /*DATE*/;\n      date("YYYYMMDD")("\\x01")  gel_eff_dt = NULL("") /*DATE*/;\n      string("\\x01",charset="iso-8859-15", maximum_length=10) pln_cd = NULL("") /*VARCHAR(10)*/;\n      date("YYYYMMDD")("\\x01")  gel_thru_dt = NULL("") /*DATE*/;\nend
JOIN_XFR:sandbox||||\n\n\nout::join(in0, in1)=\nbegin\n  out.* :1: in0.*;\n  out.* :2: in1.*;\nend;\n
JOIN_TYPE||||Inner Join
JOIN_LEVEL_2_TYPE||||Inner Join
NON_DRIVER_1_FILE_TYPE||||Clean
NON_DRIVER_2_FILE_TYPE||||Clean
DRIVER_PRE_DEDUP_FILTER||||ids_updt_dttm >= (datetime("YYYYMMDDHH24MISS")) (date("YYYY-MM-DD")) now()
