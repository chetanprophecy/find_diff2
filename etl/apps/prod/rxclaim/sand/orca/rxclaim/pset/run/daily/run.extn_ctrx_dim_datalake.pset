!prototype|P|||$AI_PLAN/run/run.all.plan
RUN_GROUP||||extn_ctrx_dim.generated_datalake
RUN_ID_FILE||||$[begin\r\nlet string("") v_run_group=string_split(RUN_GROUP,".")[0];\r\nresult :: PUB_DATAHUB_SERIAL + "/" + "run.rxclaim.integration."+ string_downcase(v_run_group) + "."+ AI_PHASE + ".run_id.dat" ;\r\nend ]
RUN_ID||||$[begin\r\n  let string ("\\n") num_suffix;\r\n  switch (RUN_GROUP)\r\n  case "orx_dim":\r\n    num_suffix = "01";\r\n  case "ctrx_dim":\r\n    num_suffix = "02";\r\ncase "ctrx_dim.generated_datalake":\r\n    num_suffix = "02";\r\n  case "orx_fac":\r\n    num_suffix = "03";\r\n  case "ctrx_fac":\r\n    num_suffix = "04";\r\ncase "ctrx_fac.generated_datalake":\r\n    num_suffix = "04";\r\n  case "cpp_outbound":\r\n    num_suffix = "05";\r\ncase "extn_ctrx_dim.generated_datalake":\r\n    num_suffix = "22";\r\n  default:\r\n    num_suffix = "00";\r\n  end\r\nresult :: (string("")) (datetime("YYYYMMDDHH24MI")) now() + num_suffix ;\r\nend;\r\n]
RUN_GROUP_DATALAKE||||$[string_split(RUN_GROUP,".")[0]]
START_CHANGES_TIME||||$[ string_filter_out(read_file(START_CHANGES_FILE),"\\r\\n") ]
RUN_PLAN||||$[AI_PLAN + "/run/run." +RUN_GROUP + ".plan" ]
