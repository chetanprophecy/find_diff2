!prototype|P|||$AI_PSET/get.ids.interim.pset
SOURCE_NAME||||ids_common.d_plan_maintenance_p90
TRANSFORM_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\ninclude '~$AI_XFR/bre_helper.map.xfr';\nlet decimal('') bzt_0_6c54cc0a_59a7ac0a_236e_0 = $START_DATE;\nlet decimal('') bzt_1_6c54cc0a_59a7ac0a_236e_0 = $END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.sc1_list,'sc1_list',1,0]\n     [out0.ids_create_run_id,'ids_create_run_id',1,0]\n     [out0.ids_rec_stat_cd,'ids_rec_stat_cd',1,0]\n     [out0.pmn_max_days_supply_2,'pmn_max_days_supply_2',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.pmn_maint_drug_sts,'pmn_maint_drug_sts',1,0]\n     [out0.pmn_minimum_days,'pmn_minimum_days',1,0]\n     [out0.file_rec_cntr,'file_rec_cntr',1,0]\n     [out0.pmn_multi_source_cd,'pmn_multi_source_cd',1,0]\n     [out0.pln_cd,'pln_cd',1,0]\n     [out0.pmn_maint_drug_cd,'pmn_maint_drug_cd',1,0]\n     [out0.pmn_max_days_supply_1,'pmn_max_days_supply_1',1,0]\n     [out0.gpi_list_id,'gpi_list_id',1,0]\n     [out0.dxf_hk_part2,'dxf_hk_part2',1,0]\n     [out0.pln_eff_dt,'pln_eff_dt',1,0]\n     [out0.pmn_allow_scc_ovrd,'pmn_allow_scc_ovrd',1,0]\n     [out0.pmn_thru_dt,'pmn_thru_dt',1,0]\n     [out0.pmn_copay_schedule_nm,'pmn_copay_schedule_nm',1,0]\n     [out0.pmn_super_ndc_list_id,'pmn_super_ndc_list_id',1,0]\n     [out0.pmn_sts,'pmn_sts',1,0]\n     [out0.pmn_message_type,'pmn_message_type',1,0]\n     [out0.ids_create_dttm,'ids_create_dttm',1,0]\n     [out0.pmn_comp_days_spl_qty_flg,'pmn_comp_days_spl_qty_flg',1,0]\n     [out0.pmn_super_gpi_list_id,'pmn_super_gpi_list_id',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.snh_super_network_id,'snh_super_network_id',1,0]\n     [out0.pmn_maint_drug_ind,'pmn_maint_drug_ind',1,0]\n     [out0.pmn_fill_limit_days,'pmn_fill_limit_days',1,0]\n     [out0.pmn_max_qty,'pmn_max_qty',1,0]\n     [out0.pmn_from_dt,'pmn_from_dt',1,0]\n     [out0.phr_ntwrk_seq_nbr,'phr_ntwrk_seq_nbr',1,0]\n     [out0.pmn_seq_nbr,'pmn_seq_nbr',1,0]\n     [out0.dxf_hk_part1,'dxf_hk_part1',1,0]\n     [out0.pmn_ndc_list_id,'pmn_ndc_list_id',1,0]\n     [out0.pmn_plan_maint_sk,'pmn_plan_maint_sk',1,0]\n     [out0.ids_create_uid,'ids_create_uid',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.pmn_gpi_list_sts,'pmn_gpi_list_sts',1,0]\n     [out0.phn_phr_ntwrk_id,'phn_phr_ntwrk_id',1,0]\n     [out0.pmn_override_refill_lmt,'pmn_override_refill_lmt',1,0]\n     [out0.pmn_fill_limit_eff_dt,'pmn_fill_limit_eff_dt',1,0]\n     [out0.ids_updt_uid,'ids_updt_uid',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.ids_updt_run_id,'ids_updt_run_id',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.pmn_ndc_list_sts,'pmn_ndc_list_sts',1,0]\n     [out0.pmn_message_code,'pmn_message_code',1,0]\n     [out0.pmn_nbr_of_fills,'pmn_nbr_of_fills',1,0]\n     [out0.pln_sk,'pln_sk',1,0]\n     [out0.dxf_src_sys_id,'dxf_src_sys_id',1,0]\n     [out0.pmn_fill_qlfr,'pmn_fill_qlfr',1,0]\n     [out0.snh_seq_nbr,'snh_seq_nbr',1,0]\n     [out0.pmn_step_nbr,'pmn_step_nbr',1,0]\n     [out0.pmn_nbr_per_cal_year,'pmn_nbr_per_cal_year',1,0]\n  ]\n  impacts:\n  [\n     [in0.pmn_from_dt,'pmn_from_dt',1,1]\n     [in0.pmn_seq_nbr,'pmn_seq_nbr',1,1]\n     [in0.pmn_multi_source_cd,'pmn_multi_source_cd',1,1]\n     [in0.pmn_fill_limit_eff_dt,'pmn_fill_limit_eff_dt',1,1]\n     [in0.pln_cd,'pln_cd',1,1]\n     [in0.ids_create_uid,'ids_create_uid',1,1]\n     [in0.phn_phr_ntwrk_id,'phn_phr_ntwrk_id',1,1]\n     [in0.pmn_gpi_list_sts,'pmn_gpi_list_sts',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.pmn_ndc_list_id,'pmn_ndc_list_id',1,1]\n     [in0.pln_eff_dt,'pln_eff_dt',1,1]\n     [in0.ids_create_run_id,'ids_create_run_id',1,1]\n     [in0.pmn_maint_drug_cd,'pmn_maint_drug_cd',1,1]\n     [in0.pmn_ndc_list_sts,'pmn_ndc_list_sts',1,1]\n     [in0.pmn_fill_qlfr,'pmn_fill_qlfr',1,1]\n     [in0.pmn_nbr_of_fills,'pmn_nbr_of_fills',1,1]\n     [in0.pmn_message_code,'pmn_message_code',1,1]\n     [in0.dxf_hk_part2,'dxf_hk_part2',1,1]\n     [in0.pmn_fill_limit_days,'pmn_fill_limit_days',1,1]\n     [in0.pmn_nbr_per_cal_year,'pmn_nbr_per_cal_year',1,1]\n     [in0.ids_updt_run_id,'ids_updt_run_id',1,1]\n     [in0.snh_seq_nbr,'snh_seq_nbr',1,1]\n     [in0.dxf_src_sys_id,'dxf_src_sys_id',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.file_rec_cntr,'file_rec_cntr',1,1]\n     [in0.pmn_max_days_supply_1,'pmn_max_days_supply_1',1,1]\n     [in0.pmn_copay_schedule_nm,'pmn_copay_schedule_nm',1,1]\n     [in0.pmn_allow_scc_ovrd,'pmn_allow_scc_ovrd',1,1]\n     [in0.pmn_minimum_days,'pmn_minimum_days',1,1]\n     [in0.pmn_max_days_supply_2,'pmn_max_days_supply_2',1,1]\n     [in0.sc1_list,'sc1_list',1,1]\n     [in0.pmn_maint_drug_sts,'pmn_maint_drug_sts',1,1]\n     [in0.gpi_list_id,'gpi_list_id',1,1]\n     [in0.pmn_override_refill_lmt,'pmn_override_refill_lmt',1,1]\n     [in0.pmn_step_nbr,'pmn_step_nbr',1,1]\n     [in0.pmn_thru_dt,'pmn_thru_dt',1,1]\n     [in0.ids_rec_stat_cd,'ids_rec_stat_cd',1,1]\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.pmn_maint_drug_ind,'pmn_maint_drug_ind',1,1]\n     [in0.pmn_super_gpi_list_id,'pmn_super_gpi_list_id',1,1]\n     [in0.phr_ntwrk_seq_nbr,'phr_ntwrk_seq_nbr',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.dxf_hk_part1,'dxf_hk_part1',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.pmn_message_type,'pmn_message_type',1,1]\n     [in0.pmn_comp_days_spl_qty_flg,'pmn_comp_days_spl_qty_flg',1,1]\n     [in0.pmn_sts,'pmn_sts',1,1]\n     [in0.pmn_plan_maint_sk,'pmn_plan_maint_sk',1,1]\n     [in0.pmn_super_ndc_list_id,'pmn_super_ndc_list_id',1,1]\n     [in0.pln_sk,'pln_sk',1,1]\n     [in0.ids_create_dttm,'ids_create_dttm',1,1]\n     [in0.snh_super_network_id,'snh_super_network_id',1,1]\n     [in0.pmn_max_qty,'pmn_max_qty',1,1]\n     [in0.ids_updt_uid,'ids_updt_uid',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
LOOKUP_FIELDS_KEY||||{dxf_sk;pln_sk;pln_cd;gpi_list_id;pmn_gpi_list_sts;pmn_ndc_list_id;pmn_ndc_list_sts;pmn_thru_dt;pmn_from_dt}
SOURCE_FILE_PATTERN||||d_plan_maintenance.dat.gz
DO_LOOKUP||||1
DO_CLEAN||||0
LOOKUP_KEY||||{pln_sk; gpi_list_id; pmn_gpi_list_sts; pmn_ndc_list_id; pmn_ndc_list_sts; pmn_from_dt; pmn_thru_dt}
EXTRA_DEDUP_SORT_KEY||||{dxf_sk}
FILTER_EXPRESSION||||src_env_sk==490
FILTER_AFTER_DEDUP_EXPR||||(first_defined(pmn_gpi_list_sts,"")=="I" or first_defined(pmn_ndc_list_sts," ")=="I") and ((first_defined(string_substring(gpi_list_id,1,5),"") member [vector "UXMSS","UXMSP","UXS9S","UXS9P","UXC9S","UXC9P"] or first_defined(string_substring(gpi_list_id,1,6),"")  member [vector "UXMSMS","UXS9P1","UXC9P1"]) or (first_defined(string_substring(pmn_ndc_list_id,1,5),"") member [vector "UXMSS","UXMSP","UXS9S","UXS9P","UXC9S","UXC9P"] or first_defined(string_substring(pmn_ndc_list_id,1,6),"")  member [vector "UXMSMS","UXS9P1","UXC9P1"]) )
