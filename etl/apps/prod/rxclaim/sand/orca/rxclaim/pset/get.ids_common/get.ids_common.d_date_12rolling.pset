!prototype|P|||$AI_PSET/get.ids.scan.interim.pset
LOOKUP_FIELDS_KEY||||{dt_sk; rank}
TRANSFORM_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\ninclude '~$AI_XFR/bre_helper.map.xfr';\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.ids_create_run_id,'ids_create_run_id',1,0]\n     [out0.cal_yr_mnth_nbr,'cal_yr_mnth_nbr',1,0]\n     [out0.cal_month_last_year_id,'cal_month_last_year_id',1,0]\n     [out0.ids_rec_stat_cd,'ids_rec_stat_cd',1,0]\n     [out0.cal_year_start_dt,'cal_year_start_dt',1,0]\n     [out0.cal_month_year_id,'cal_month_year_id',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.cal_year_end_flg,'cal_year_end_flg',1,0]\n     [out0.cal_qtr_nbr,'cal_qtr_nbr',1,0]\n     [out0.day_nbr_in_fiscal_mnth,'day_nbr_in_fiscal_mnth',1,0]\n     [out0.file_rec_cntr,'file_rec_cntr',1,0]\n     [out0.day_nbr_in_cal_qtr,'day_nbr_in_cal_qtr',1,0]\n     [out0.dt_sk,'dt_sk',1,0]\n     [out0.day_nbr_in_cal_mnth,'day_nbr_in_cal_mnth',1,0]\n     [out0.cal_yr_mnth_id,'cal_yr_mnth_id',1,0]\n     [out0.cal_yr_id,'cal_yr_id',1,0]\n     [out0.dxf_hk_part2,'dxf_hk_part2',1,0]\n     [out0.fiscal_month_start_flg,'fiscal_month_start_flg',1,0]\n     [out0.cal_year_start_flg,'cal_year_start_flg',1,0]\n     [out0.cal_qtr_end_dt,'cal_qtr_end_dt',1,0]\n     [out0.cal_month_start_flg,'cal_month_start_flg',1,0]\n     [out0.cal_week_nm,'cal_week_nm',1,0]\n     [out0.cal_qtr_nm,'cal_qtr_nm',1,0]\n     [out0.day_nbr_in_fiscal_yr,'day_nbr_in_fiscal_yr',1,0]\n     [out0.day_nbr_in_cal_yr,'day_nbr_in_cal_yr',1,0]\n     [out0.cal_mnth_nm,'cal_mnth_nm',1,0]\n     [out0.fiscal_qtr_start_flg,'fiscal_qtr_start_flg',1,0]\n     [out0.ids_create_dttm,'ids_create_dttm',1,0]\n     [out0.cal_qtr_start_dt,'cal_qtr_start_dt',1,0]\n     [out0.jln_dt_nbr,'jln_dt_nbr',1,0]\n     [out0.cal_year_end_dt,'cal_year_end_dt',1,0]\n     [out0.cal_month_end_flg,'cal_month_end_flg',1,0]\n     [out0.cal_qtr_end_flg,'cal_qtr_end_flg',1,0]\n     [out0.day_nbr_in_fiscal_qtr,'day_nbr_in_fiscal_qtr',1,0]\n     [out0.fiscal_qtr_nbr,'fiscal_qtr_nbr',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.cal_year_six_month_id,'cal_year_six_month_id',1,0]\n     [out0.fiscal_yr_id,'fiscal_yr_id',1,0]\n     [out0.cal_week_start_flg,'cal_week_start_flg',1,0]\n     [out0.dxf_hk_part1,'dxf_hk_part1',1,0]\n     [out0.cal_qtr_start_flg,'cal_qtr_start_flg',1,0]\n     [out0.fiscal_month_end_flg,'fiscal_month_end_flg',1,0]\n     [out0.cal_day_nm,'cal_day_nm',1,0]\n     [out0.fiscal_yr_mnth_nbr,'fiscal_yr_mnth_nbr',1,0]\n     [out0.fiscal_yr_end_flg,'fiscal_yr_end_flg',1,0]\n     [out0.ids_create_uid,'ids_create_uid',1,0]\n     [out0.cal_month_end_dt,'cal_month_end_dt',1,0]\n     [out0.cal_yr_qtr_id,'cal_yr_qtr_id',1,0]\n     [out0.newline,'newline',1,0]\n     [out0.cal_week_end_flg,'cal_week_end_flg',1,0]\n     [out0.cal_week_start_dt,'cal_week_start_dt',1,0]\n     [out0.fiscal_qtr_end_flg,'fiscal_qtr_end_flg',1,0]\n     [out0.ids_updt_uid,'ids_updt_uid',1,0]\n     [out0.fiscal_yr_start_flg,'fiscal_yr_start_flg',1,0]\n     [out0.cal_day_dt,'cal_day_dt',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.ids_updt_run_id,'ids_updt_run_id',1,0]\n     [out0.cal_month_start_dt,'cal_month_start_dt',1,0]\n     [out0.cal_day_str,'cal_day_str',1,0]\n     [out0.hol_ind,'hol_ind',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.cal_week_end_dt,'cal_week_end_dt',1,0]\n     [out0.cal_month_str,'cal_month_str',1,0]\n     [out0.wk_end_ind,'wk_end_ind',1,0]\n     [out0.fiscal_qtr_nm,'fiscal_qtr_nm',1,0]\n     [out0.fiscal_yr_mnth,'fiscal_yr_mnth',1,0]\n     [out0.cal_year_last_month_id,'cal_year_last_month_id',1,0]\n     [out0.dxf_src_sys_id,'dxf_src_sys_id',1,0]\n     [out0.cal_year_nm,'cal_year_nm',1,0]\n     [out0.fiscal_yr_qtr_id,'fiscal_yr_qtr_id',1,0]\n     [out0.cal_month_week_nbr,'cal_month_week_nbr',1,0]\n     [out0.cal_wk_nbr_in_yr,'cal_wk_nbr_in_yr',1,0]\n  ]\n  impacts:\n  [\n     [in0.day_nbr_in_cal_yr,'day_nbr_in_cal_yr',1,1]\n     [in0.fiscal_qtr_end_flg,'fiscal_qtr_end_flg',1,1]\n     [in0.fiscal_month_start_flg,'fiscal_month_start_flg',1,1]\n     [in0.fiscal_month_end_flg,'fiscal_month_end_flg',1,1]\n     [in0.ids_create_uid,'ids_create_uid',1,1]\n     [in0.cal_month_end_dt,'cal_month_end_dt',1,1]\n     [in0.newline,'newline',1,1]\n     [in0.day_nbr_in_fiscal_mnth,'day_nbr_in_fiscal_mnth',1,1]\n     [in0.fiscal_yr_mnth_nbr,'fiscal_yr_mnth_nbr',1,1]\n     [in0.cal_week_end_flg,'cal_week_end_flg',1,1]\n     [in0.cal_month_end_flg,'cal_month_end_flg',1,1]\n     [in0.day_nbr_in_cal_mnth,'day_nbr_in_cal_mnth',1,1]\n     [in0.cal_month_last_year_id,'cal_month_last_year_id',1,1]\n     [in0.cal_week_start_flg,'cal_week_start_flg',1,1]\n     [in0.cal_yr_qtr_id,'cal_yr_qtr_id',1,1]\n     [in0.jln_dt_nbr,'jln_dt_nbr',1,1]\n     [in0.cal_month_year_id,'cal_month_year_id',1,1]\n     [in0.cal_year_start_dt,'cal_year_start_dt',1,1]\n     [in0.cal_month_week_nbr,'cal_month_week_nbr',1,1]\n     [in0.ids_create_run_id,'ids_create_run_id',1,1]\n     [in0.cal_day_str,'cal_day_str',1,1]\n     [in0.cal_month_start_flg,'cal_month_start_flg',1,1]\n     [in0.cal_qtr_nm,'cal_qtr_nm',1,1]\n     [in0.hol_ind,'hol_ind',1,1]\n     [in0.cal_yr_id,'cal_yr_id',1,1]\n     [in0.fiscal_yr_mnth,'fiscal_yr_mnth',1,1]\n     [in0.dxf_hk_part2,'dxf_hk_part2',1,1]\n     [in0.cal_week_end_dt,'cal_week_end_dt',1,1]\n     [in0.ids_updt_run_id,'ids_updt_run_id',1,1]\n     [in0.cal_wk_nbr_in_yr,'cal_wk_nbr_in_yr',1,1]\n     [in0.cal_month_str,'cal_month_str',1,1]\n     [in0.cal_year_nm,'cal_year_nm',1,1]\n     [in0.fiscal_qtr_nm,'fiscal_qtr_nm',1,1]\n     [in0.fiscal_yr_qtr_id,'fiscal_yr_qtr_id',1,1]\n     [in0.cal_month_start_dt,'cal_month_start_dt',1,1]\n     [in0.dxf_src_sys_id,'dxf_src_sys_id',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.cal_day_nm,'cal_day_nm',1,1]\n     [in0.cal_year_start_flg,'cal_year_start_flg',1,1]\n     [in0.file_rec_cntr,'file_rec_cntr',1,1]\n     [in0.dt_sk,'dt_sk',1,1]\n     [in0.cal_qtr_nbr,'cal_qtr_nbr',1,1]\n     [in0.cal_year_end_flg,'cal_year_end_flg',1,1]\n     [in0.day_nbr_in_cal_qtr,'day_nbr_in_cal_qtr',1,1]\n     [in0.fiscal_yr_start_flg,'fiscal_yr_start_flg',1,1]\n     [in0.cal_yr_mnth_id,'cal_yr_mnth_id',1,1]\n     [in0.cal_yr_mnth_nbr,'cal_yr_mnth_nbr',1,1]\n     [in0.cal_qtr_end_dt,'cal_qtr_end_dt',1,1]\n     [in0.ids_rec_stat_cd,'ids_rec_stat_cd',1,1]\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.day_nbr_in_fiscal_qtr,'day_nbr_in_fiscal_qtr',1,1]\n     [in0.day_nbr_in_fiscal_yr,'day_nbr_in_fiscal_yr',1,1]\n     [in0.fiscal_yr_id,'fiscal_yr_id',1,1]\n     [in0.cal_week_nm,'cal_week_nm',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.dxf_hk_part1,'dxf_hk_part1',1,1]\n     [in0.cal_year_last_month_id,'cal_year_last_month_id',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.fiscal_yr_end_flg,'fiscal_yr_end_flg',1,1]\n     [in0.fiscal_qtr_start_flg,'fiscal_qtr_start_flg',1,1]\n     [in0.cal_year_six_month_id,'cal_year_six_month_id',1,1]\n     [in0.cal_qtr_start_dt,'cal_qtr_start_dt',1,1]\n     [in0.cal_year_end_dt,'cal_year_end_dt',1,1]\n     [in0.cal_qtr_end_flg,'cal_qtr_end_flg',1,1]\n     [in0.cal_mnth_nm,'cal_mnth_nm',1,1]\n     [in0.cal_day_dt,'cal_day_dt',1,1]\n     [in0.cal_qtr_start_flg,'cal_qtr_start_flg',1,1]\n     [in0.fiscal_qtr_nbr,'fiscal_qtr_nbr',1,1]\n     [in0.ids_create_dttm,'ids_create_dttm',1,1]\n     [in0.ids_updt_uid,'ids_updt_uid',1,1]\n     [in0.wk_end_ind,'wk_end_ind',1,1]\n     [in0.cal_week_start_dt,'cal_week_start_dt',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;
SOURCE_FILE_PATTERN||||*d_date*.dat.gz
DO_CLEAN||||1
DO_LOOKUP||||0
FILTER_FLG||||True
OPTIONAL_FILTER||||first_defined(cal_month_start_flg,"-") == 'Y' and \r\ncal_day_dt >= (date("YYYYMMDD")) date_add_months( (date("YYYYMMDD")) datetime_add ((date("YYYYMMDD")) string_concat( (date("YYYYMM")) date_add_months((date("YYYYMMDD")) $"START_CHANGES_TIME", -1), (string("")) (decimal("")) date_month_end(date_month((date("YYYYMMDD")) date_add_months((date("YYYYMMDD")) $"START_CHANGES_TIME", -1))) ), days = 1), decimal_strip(-((date_month((date("YYYYMMDD")) $"START_CHANGES_TIME") -1 ) + (math_abs(decimal_strip( ( (decimal("")) (string("")) (date("YYYY")) (date("YYYYMMDD"))$"START_CHANGES_TIME" - (decimal("")) "2010" ) * 12 )))))) and\r\ncal_day_dt <= (date("YYYYMMDD")) string_concat( (date("YYYYMM")) date_add_months((date("YYYYMMDD")) $"START_CHANGES_TIME", -1), (string("")) (decimal("")) date_month_end(date_month((date("YYYYMMDD")) date_add_months((date("YYYYMMDD")) $"START_CHANGES_TIME", -1))) )
LOOKUP_KEY||||{dt_sk}
LOOKUP_FILE_URL||||$[ if ( not DO_LOOKUP ) "" else "file:" + AI_SERIAL_LOOKUP + "/lookup." + SOURCE_SYSTEM + "/lookup." + SOURCE_LOWER + "_12rolling_lkp.dat" ]
LOOKUP_DML_FILE||||$[ if ( not DO_LOOKUP ) "" else AI_DML + "/lookup." + SOURCE_SYSTEM + "/lookup." + SOURCE_LOWER + "_12rolling_lkp.dml" ]
SOURCE_NAME||||ids_common.d_date_12rolling
ADDITIONAL_FIELDS_DML||||record\r\ndecimal("\\x01") rank;\r\nend
START_CHANGES_TIME||||20170113
