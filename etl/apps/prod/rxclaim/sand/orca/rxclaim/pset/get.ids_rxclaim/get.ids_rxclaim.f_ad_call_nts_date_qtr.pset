!prototype|P|||${AI_PSET}/get.join.files.interim.pset
DRIVER_SOURCE_NAME||||ids_rxclaim.f_audit_call_notes
DRIVER_SOURCE_LOGICAL_NAME||||orca_rxclaim
TARGET_NAME||||ids_rxclaim.f_ad_call_nts_date_qtr
DRIVER_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fdd0a4_25de_2 = $DRIVER_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fdd0a4_25de_2 = $DRIVER_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.claim_nbr,[transform],in0.claim_nbr]\n  [out0.processing_quarter_end_dt,[transform],]\n  [out0.cal_day_dt,[transform],in0.created_dt]\n  [out0.processing_quarter_start_dt,[transform],]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.phr_contact_nm,'phr_contact_nm',1,0]\n     [out0.audit_category_id,'audit_category_id',1,0]\n     [out0.audit_fraud_type_id,'audit_fraud_type_id',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.adjust_claim_seq_nbr,'adjust_claim_seq_nbr',1,0]\n     [out0.rxclaim_instance_ind,'rxclaim_instance_ind',1,0]\n     [out0.claim_nbr,'claim_nbr',1,0]\n     [out0.audit_fraud_violation_reason_id,'audit_fraud_violation_reason_id',1,0]\n     [out0.zero_reclaim,'zero_reclaim',1,0]\n     [out0.processing_quarter_end_dt,'processing_quarter_end_dt',1,0]\n     [out0.created_dt,'created_dt',1,0]\n     [out0.ids_create_dttm,'ids_create_dttm',1,0]\n     [out0.number_of_calls,'number_of_calls',1,0]\n     [out0.adjust_claim_nbr,'adjust_claim_nbr',1,0]\n     [out0.audit_call_note_id,'audit_call_note_id',1,0]\n     [out0.phr_adjust_amt,'phr_adjust_amt',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.number_of_emails,'number_of_emails',1,0]\n     [out0.created_by,'created_by',1,0]\n     [out0.audit_claim_seq_nbr,'audit_claim_seq_nbr',1,0]\n     [out0.audit_nonfraud_violation_reason_id,'audit_nonfraud_violation_reason_id',1,0]\n     [out0.comments,'comments',1,0]\n     [out0.audit_payment_type_id,'audit_payment_type_id',1,0]\n     [out0.clt_adjust_amt,'clt_adjust_amt',1,0]\n     [out0.dxf_sk,'dxf_sk',1,0]\n     [out0.cal_day_dt,'cal_day_dt',1,0]\n     [out0.audit_type_id,'audit_type_id',1,0]\n     [out0.audit_fraud_perpetrator_id,'audit_fraud_perpetrator_id',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.dxf_src_sys_id,'dxf_src_sys_id',1,0]\n     [out0.processing_quarter_start_dt,'processing_quarter_start_dt',1,0]\n  ]\n  impacts:\n  [\n     [in0.zero_reclaim,'zero_reclaim',1,1]\n     [in0.comments,'comments',1,1]\n     [in0.number_of_emails,'number_of_emails',1,1]\n     [in0.audit_fraud_type_id,'audit_fraud_type_id',1,1]\n     [in0.audit_payment_type_id,'audit_payment_type_id',1,1]\n     [in0.clt_adjust_amt,'clt_adjust_amt',1,1]\n     [in0.audit_category_id,'audit_category_id',1,1]\n     [in0.created_dt,'created_dt',2,2]\n     [in0.audit_nonfraud_violation_reason_id,'audit_nonfraud_violation_reason_id',1,1]\n     [in0.audit_type_id,'audit_type_id',1,1]\n     [in0.audit_fraud_violation_reason_id,'audit_fraud_violation_reason_id',1,1]\n     [in0.claim_nbr,'claim_nbr',1,1]\n     [in0.dxf_src_sys_id,'dxf_src_sys_id',1,1]\n     [in0.created_by,'created_by',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.phr_contact_nm,'phr_contact_nm',1,1]\n     [in0.adjust_claim_seq_nbr,'adjust_claim_seq_nbr',1,1]\n     [in0.audit_claim_seq_nbr,'audit_claim_seq_nbr',1,1]\n     [in0.rxclaim_instance_ind,'rxclaim_instance_ind',1,1]\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.audit_call_note_id,'audit_call_note_id',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.audit_fraud_perpetrator_id,'audit_fraud_perpetrator_id',1,1]\n     [in0.number_of_calls,'number_of_calls',1,1]\n     [in0.adjust_claim_nbr,'adjust_claim_nbr',1,1]\n     [in0.ids_create_dttm,'ids_create_dttm',1,1]\n     [in0.phr_adjust_amt,'phr_adjust_amt',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet decimal("\\x01",0) claim_nbr = fail_if_error(string_substring(string_lrtrim((string(""))in0.claim_nbr), 1, 15));\nlet date("YYYYMMDD")("\\x01") cal_day_dt = fail_if_error((date("YYYYMMDD"))in0.created_dt);\nlet date("YYYYMMDD")("\\x01") processing_quarter_start_dt = (date("YYYYMMDD"))(string(""))bzt_0_6c54cc0a_58fdd0a4_25de_2;\nlet date("YYYYMMDD")("\\x01") processing_quarter_end_dt = (date("YYYYMMDD"))(string(""))bzt_1_6c54cc0a_58fdd0a4_25de_2;\n\n\n\n  out0.claim_nbr::claim_nbr;\n  out0.cal_day_dt::cal_day_dt;\n  out0.processing_quarter_start_dt::processing_quarter_start_dt;\n  out0.processing_quarter_end_dt::processing_quarter_end_dt;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_1_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fdd0a4_25de_0 = $NON_DRIVER_1_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fdd0a4_25de_0 = $NON_DRIVER_1_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.processing_quarter_end_dt,[transform],]\n  [out0.processing_quarter_start_dt,[transform],]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.processing_quarter_end_dt,'processing_quarter_end_dt',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.cal_yr_qtr_id,'cal_yr_qtr_id',1,0]\n     [out0.cal_day_dt,'cal_day_dt',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.processing_quarter_start_dt,'processing_quarter_start_dt',1,0]\n  ]\n  impacts:\n  [\n     [in0.cal_yr_qtr_id,'cal_yr_qtr_id',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.cal_day_dt,'cal_day_dt',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet date("YYYYMMDD")("\\x01") processing_quarter_start_dt = (date("YYYYMMDD"))"19000101";\nlet date("YYYYMMDD")("\\x01") processing_quarter_end_dt = (date("YYYYMMDD"))"19000101";\n\n\n\n  out0.processing_quarter_start_dt::processing_quarter_start_dt;\n  out0.processing_quarter_end_dt::processing_quarter_end_dt;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_2_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fdd0a4_25de_3 = $NON_DRIVER_2_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fdd0a4_25de_3 = $NON_DRIVER_2_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.processing_quarter_end_dt,[transform],]\n  [out0.audit_job_sk,[passthrough],in0.dxf_sk]\n  [out0.processing_quarter_start_dt,[transform],]\n  [out0.claim_nbr,[transform],in0.audit_claim_number]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.audit_add_dt,'audit_add_dt',1,0]\n     [out0.processing_quarter_end_dt,'processing_quarter_end_dt',1,0]\n     [out0.audit_job_sk,'audit_job_sk',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.audit_add_tm,'audit_add_tm',1,0]\n     [out0.processing_quarter_start_dt,'processing_quarter_start_dt',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.claim_nbr,'claim_nbr',1,0]\n  ]\n  impacts:\n  [\n     [in0.dxf_sk,'dxf_sk',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.audit_add_dt,'audit_add_dt',1,1]\n     [in0.audit_claim_number,'audit_claim_number',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.audit_add_tm,'audit_add_tm',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet decimal("\\x01",0) audit_job_sk = fail_if_error(in0.dxf_sk);\nlet decimal("\\x01",0) claim_nbr = fail_if_error((decimal(""))string_lrtrim(in0.audit_claim_number));\nlet date("YYYYMMDD")("\\x01") processing_quarter_start_dt = (date("YYYYMMDD"))"19000101";\nlet date("YYYYMMDD")("\\x01") processing_quarter_end_dt = (date("YYYYMMDD"))"19000101";\n\n\n\n  out0.audit_job_sk::audit_job_sk;\n  out0.claim_nbr::claim_nbr;\n  out0.processing_quarter_start_dt::processing_quarter_start_dt;\n  out0.processing_quarter_end_dt::processing_quarter_end_dt;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_3_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58fdd0a4_25de_1 = $NON_DRIVER_3_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58fdd0a4_25de_1 = $NON_DRIVER_3_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
OVERRIDE_JOIN_KEY||||{cal_day_dt}
OVERRIDE_JOIN_LEVEL_2_KEY||||{claim_nbr}
OVERRIDE_JOIN_LEVEL_3_KEY||||{}
LOOKUP_FIELDS_KEY||||{}
DRIVER_OUTPUT_FIELDS||||claim_nbr,audit_call_note_id,audit_category_id,zero_reclaim,audit_payment_type_id,phr_contact_nm,number_of_calls,number_of_emails,audit_type_id,audit_fraud_type_id,audit_fraud_violation_reason_id,audit_nonfraud_violation_reason_id,audit_fraud_perpetrator_id,comments,created_dt,created_by,ids_updt_dttm,ids_create_dttm,dxf_sk,phr_adjust_amt,src_env_sk,clt_adjust_amt,adjust_claim_nbr,audit_claim_seq_nbr,adjust_claim_seq_nbr,rxclaim_instance_ind,dxf_src_sys_id
NON_DRIVER_1_SOURCE_NAME||||ids_common.d_date
NON_DRIVER_1_OUTPUT_FIELDS||||cal_day_dt,cal_yr_qtr_id
JOIN_TYPE||||Inner Join
JOIN_KEY||||{cal_day_dt}
DO_CLEAN||||1
ADDITIONAL_FIELDS_DML||||record\n  date("YYYYMMDD")("\\x01")    cal_day_dt = NULL("") /*DATE*/;\n  decimal("\\x01",0) claim_nbr = NULL("") /*BIGINT*/;\n  date("YYYYMMDD")("\\x01")    processing_quarter_start_dt;\n  date("YYYYMMDD")("\\x01")    processing_quarter_end_dt;\nend
ENABLE_JOIN_LEVEL_2||||1
NON_DRIVER_2_SOURCE_NAME||||ids_rxclaim.d_audit_job_numbers
NON_DRIVER_2_OUTPUT_FIELDS||||audit_job_sk,audit_add_dt,audit_add_tm
JOIN_LEVEL_2_KEY||||{claim_nbr}
NON_DRIVER_2_EXTRA_SORT_KEY||||{audit_add_dt descending;audit_add_tm descending}
JOIN_XFR:sandbox||||out :: join(in0, in1) = \nbegin\n  out.processing_quarter_start_dt :1: in0.processing_quarter_start_dt;\n  out.processing_quarter_end_dt :1: in0.processing_quarter_end_dt;\n  out.* :2: in0.*;\n  out.* :3: in1.*;\nend\n\n
JOIN_LEVEL_2_XFR:sandbox||||out :: join(in0, in1) = \nbegin\n  out.processing_quarter_start_dt :1: in0.processing_quarter_start_dt;\n  out.processing_quarter_end_dt :1: in0.processing_quarter_end_dt;\n  out.* :2: in0.*;\n  out.* :3: in1.*;\nend\n\n
NON_DRIVER_1_DEDUP_ON_JOIN_KEY||||True
