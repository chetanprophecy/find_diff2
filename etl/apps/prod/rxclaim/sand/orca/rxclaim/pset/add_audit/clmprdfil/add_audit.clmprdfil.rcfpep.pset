!prototype|P|||$AI_PSET/add_audit.interim.pset
SOURCE_SYSTEM||||clmprdfil.rcfpep
CLEAN_DIRS||||$[RXTRACK_COMBO_SERIAL_PATH + "../lookup/rxtrack_combo_nonaggr.grp1_" + "," + RXTRACK_COMBO_SERIAL_PATH + "../lookup/rxtrack_combo_nonaggr.grp2_"]
CLEAN_DML_FILE||||$[AI_DML + "/lookup." + string_downcase(SOURCE_SCHEMA_NAME) + "/lookup." + SOURCE_SYSTEM  + ".dml"]
CLEAN_FILE_NAME||||$[begin\r\n\r\nlet string("")[int] v_read_files = [vector];\r\nif ( LOAD_TYPE == "Daily" )\r\n        \r\n            for( let int i = 0, i < (int)date_difference_days((date("YYYY-MM-DD"))END_DATE, (date("YYYY-MM-DD"))START_DATE) + 1)\r\n                for( let int j = 0, j < length_of(CLEAN_DIR_VEC) )\r\n                        if(ends_with(CLEAN_DIR_VEC[j],"rxtrack_combo_nonaggr.grp2_") )\r\n                                v_read_files = vector_append(v_read_files, CLEAN_DIR_VEC[j] + (string(""))(date("YYYY-MM-DD"))datetime_add((date("YYYY-MM-DD"))START_DATE, days = i -1 ) + "/lookup." + string_downcase(SOURCE_SCHEMA_NAME) + "/lookup." + SOURCE_SYSTEM + "_lookup.dat");\r\n                        else\r\n                                v_read_files = vector_append(v_read_files, CLEAN_DIR_VEC[j] + (string(""))(date("YYYY-MM-DD"))datetime_add((date("YYYY-MM-DD"))START_DATE, days = i) + "/lookup." + string_downcase(SOURCE_SCHEMA_NAME) + "/lookup." + SOURCE_SYSTEM + "_lookup.dat");\r\n\r\nelse \r\n        \r\n           for( let int i = 0, i < (int)date_difference_days((date("YYYY-MM-DD"))END_DATE, (date("YYYY-MM-DD"))START_DATE) + 1)\r\n                for( let int j = 0, j < length_of(CLEAN_DIR_VEC) )\r\n                        if(ends_with(CLEAN_DIR_VEC[j],"rxtrack_combo_nonaggr.grp2_") )\r\n                                v_read_files;\r\n                        else\r\n                                v_read_files = vector_append(v_read_files, CLEAN_DIR_VEC[j] + (string(""))(date("YYYY-MM-DD"))datetime_add((date("YYYY-MM-DD"))START_DATE, days = i) + "/lookup." + string_downcase(SOURCE_SCHEMA_NAME) + "/lookup." + SOURCE_SYSTEM + "_lookup.dat");\r\n\r\n\r\nresult :: v_read_files;\r\nend]
