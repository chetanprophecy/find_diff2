!prototype|P|||$AI_PSET/get.join.files.interim.pset
DRIVER_SOURCE_NAME||||rxclaim_orx.rcex4p
DRIVER_SOURCE_LOGICAL_NAME||||orca_rxclaim
TARGET_NAME||||rxclaim_orx.rcex4p_d_mbr_f_clm
DRIVER_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_586f9a04_6d74_62 = $DRIVER_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_586f9a04_6d74_62 = $DRIVER_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.employer_group_id,[passthrough],in0.ams8cd]\n  [out0.carrier_id,[passthrough],in0.ams6cd]\n  [out0.claim_seq_nbr,[transform],in0.ams6nb]\n  [out0.account_id,[passthrough],in0.ams7cd]\n  [out0.mbr_id,[passthrough],in0.ams5cd]\n  [out0.claim_nbr,[passthrough],in0.amp2nb]\n  [out0.claim_stat_id,[passthrough],in0.amzsst]\n  [out0.src_env_sk,[passthrough],in0.dxf_src_sys_id]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.amqkhq,'amqkhq',1,0]\n     [out0.ambxht,'ambxht',1,0]\n     [out0.amkwst,'amkwst',1,0]\n     [out0.amw2he,'amw2he',1,0]\n     [out0.amj3cj,'amj3cj',1,0]\n     [out0.amxihy,'amxihy',1,0]\n     [out0.amzfbj,'amzfbj',1,0]\n     [out0.amqjhq,'amqjhq',1,0]\n     [out0.amxli1,'amxli1',1,0]\n     [out0.amhgak,'amhgak',1,0]\n     [out0.ame1hk,'ame1hk',1,0]\n     [out0.amnjhy,'amnjhy',1,0]\n     [out0.amhtik,'amhtik',1,0]\n     [out0.amzibj,'amzibj',1,0]\n     [out0.amalvn,'amalvn',1,0]\n     [out0.amqxqu,'amqxqu',1,0]\n     [out0.amv9hy,'amv9hy',1,0]\n     [out0.ambwht,'ambwht',1,0]\n     [out0.amr5hs,'amr5hs',1,0]\n     [out0.amrmh9,'amrmh9',1,0]\n     [out0.amasda,'amasda',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.amsdht,'amsdht',1,0]\n     [out0.amtccd,'amtccd',1,0]\n     [out0.amwkhc,'amwkhc',1,0]\n     [out0.amaevn,'amaevn',1,0]\n     [out0.ame5hn,'ame5hn',1,0]\n     [out0.ams7cd,'ams7cd',1,0]\n     [out0.amadvn,'amadvn',1,0]\n     [out0.amwjhc,'amwjhc',1,0]\n     [out0.ame6hn,'ame6hn',1,0]\n     [out0.cdc_ts,'cdc_ts',1,0]\n     [out0.amaqce,'amaqce',1,0]\n     [out0.dxf_src_file_name,'DXF Source File Name',1,0]\n     [out0.amzgbj,'amzgbj',1,0]\n     [out0.ampdiu,'ampdiu',1,0]\n     [out0.amambj,'amambj',1,0]\n     [out0.amlrtx,'amlrtx',1,0]\n     [out0.amc4ap,'amc4ap',1,0]\n     [out0.amp2nb,'amp2nb',1,0]\n     [out0.ams5cd,'ams5cd',1,0]\n     [out0.amwdhy,'amwdhy',1,0]\n     [out0.amwehy,'amwehy',1,0]\n     [out0.amc3ap,'amc3ap',1,0]\n     [out0.ambkqu,'ambkqu',1,0]\n     [out0.ambjqu,'ambjqu',1,0]\n     [out0.ams6cd,'ams6cd',1,0]\n     [out0.amk0st,'amk0st',1,0]\n     [out0.amlest,'amlest',1,0]\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.amc4ai,'amc4ai',1,0]\n     [out0.amk3st,'amk3st',1,0]\n     [out0.amlcie,'amlcie',1,0]\n     [out0.amgiic,'amgiic',1,0]\n     [out0.amwghy,'amwghy',1,0]\n     [out0.amimnb,'amimnb',1,0]\n     [out0.amc8ai,'amc8ai',1,0]\n     [out0.ami9id,'ami9id',1,0]\n     [out0.amnbia,'amnbia',1,0]\n     [out0.amdspr,'amdspr',1,0]\n     [out0.amzebj,'amzebj',1,0]\n     [out0.amxghx,'amxghx',1,0]\n     [out0.amolhy,'amolhy',1,0]\n     [out0.amujcd,'amujcd',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.amddap,'amddap',1,0]\n     [out0.amc2dt,'amc2dt',1,0]\n     [out0.amionb,'amionb',1,0]\n     [out0.amabtm,'amabtm',1,0]\n     [out0.amukcd,'amukcd',1,0]\n     [out0.amvsbj,'amvsbj',1,0]\n     [out0.amjjhz,'amjjhz',1,0]\n     [out0.claim_seq_nbr,'claim_seq_nbr',1,0]\n     [out0.amulbj,'amulbj',1,0]\n     [out0.amqvhq,'amqvhq',1,0]\n     [out0.amzpbj,'amzpbj',1,0]\n     [out0.amvtbj,'amvtbj',1,0]\n     [out0.cdc_flag,'cdc_flag',1,0]\n     [out0.amtjcd,'amtjcd',1,0]\n     [out0.amnnhy,'amnnhy',1,0]\n     [out0.amwfhy,'amwfhy',1,0]\n     [out0.ambbda,'ambbda',1,0]\n     [out0.amzlbj,'amzlbj',1,0]\n     [out0.amquhq,'amquhq',1,0]\n     [out0.amvkp1,'amvkp1',1,0]\n     [out0.amnmhy,'amnmhy',1,0]\n     [out0.amv7hy,'amv7hy',1,0]\n     [out0.amcvqu,'amcvqu',1,0]\n     [out0.amn3hy,'amn3hy',1,0]\n     [out0.amtfie,'amtfie',1,0]\n     [out0.amnohy,'amnohy',1,0]\n     [out0.amzhbj,'amzhbj',1,0]\n     [out0.amxfhx,'amxfhx',1,0]\n     [out0.amn4hy,'amn4hy',1,0]\n     [out0.amlrst,'amlrst',1,0]\n     [out0.amwahy,'amwahy',1,0]\n     [out0.amqihq,'amqihq',1,0]\n     [out0.amzsst,'amzsst',1,0]\n     [out0.amc2ap,'amc2ap',1,0]\n     [out0.amp7ap,'amp7ap',1,0]\n     [out0.amsoc4,'amsoc4',1,0]\n     [out0.amejhz,'amejhz',1,0]\n     [out0.amzqbj,'amzqbj',1,0]\n     [out0.amnihy,'amnihy',1,0]\n     [out0.amzjbj,'amzjbj',1,0]\n     [out0.amwbhy,'amwbhy',1,0]\n     [out0.ambqir,'ambqir',1,0]\n     [out0.amzkbj,'amzkbj',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.amjdhz,'amjdhz',1,0]\n     [out0.amiehe,'amiehe',1,0]\n     [out0.amidhe,'amidhe',1,0]\n     [out0.amnfhy,'amnfhy',1,0]\n     [out0.mbr_id,'mbr_id',1,0]\n     [out0.dxf_src_dataset_id,'DXF Source Dataset ID',1,0]\n     [out0.amokhy,'amokhy',1,0]\n     [out0.amc9ai,'amc9ai',1,0]\n     [out0.amxham,'amxham',1,0]\n     [out0.amwihc,'amwihc',1,0]\n     [out0.amulcd,'amulcd',1,0]\n     [out0.amojhy,'amojhy',1,0]\n     [out0.ame4hn,'ame4hn',1,0]\n     [out0.amsaht,'amsaht',1,0]\n     [out0.amjhhz,'amjhhz',1,0]\n     [out0.amilcj,'amilcj',1,0]\n     [out0.ams8cd,'ams8cd',1,0]\n     [out0.amnghy,'amnghy',1,0]\n     [out0.amwchy,'amwchy',1,0]\n     [out0.amrhht,'amrhht',1,0]\n     [out0.amtcn2,'amtcn2',1,0]\n     [out0.amc5ap,'amc5ap',1,0]\n     [out0.amaxod,'amaxod',1,0]\n     [out0.ambiqu,'ambiqu',1,0]\n     [out0.ampecd,'ampecd',1,0]\n     [out0.amomhy,'amomhy',1,0]\n     [out0.amc6ai,'amc6ai',1,0]\n     [out0.amythe,'amythe',1,0]\n     [out0.amiicj,'amiicj',1,0]\n     [out0.amavod,'amavod',1,0]\n     [out0.amumbj,'amumbj',1,0]\n     [out0.amk6st,'amk6st',1,0]\n     [out0.amifhe,'amifhe',1,0]\n     [out0.amychc,'amychc',1,0]\n     [out0.ams6nb,'ams6nb',1,0]\n     [out0.claim_nbr,'claim_nbr',1,0]\n     [out0.amc5ai,'amc5ai',1,0]\n     [out0.amhuik,'amhuik',1,0]\n     [out0.amn5ia,'amn5ia',1,0]\n     [out0.amwlhc,'amwlhc',1,0]\n     [out0.amoahy,'amoahy',1,0]\n     [out0.amo6h9,'amo6h9',1,0]\n     [out0.amqrap,'amqrap',1,0]\n     [out0.amk7st,'amk7st',1,0]\n     [out0.amxfam,'amxfam',1,0]\n     [out0.amurhg,'amurhg',1,0]\n     [out0.amc7ai,'amc7ai',1,0]\n     [out0.amjihz,'amjihz',1,0]\n     [out0.amakvn,'amakvn',1,0]\n     [out0.amvxbj,'amvxbj',1,0]\n     [out0.amenhz,'amenhz',1,0]\n     [out0.ambmdt,'ambmdt',1,0]\n     [out0.amzabj,'amzabj',1,0]\n     [out0.amighe,'amighe',1,0]\n     [out0.amjghz,'amjghz',1,0]\n     [out0.amnhhy,'amnhhy',1,0]\n     [out0.claim_stat_id,'claim_stat_id',1,0]\n     [out0.amzobj,'amzobj',1,0]\n     [out0.amq1hq,'amq1hq',1,0]\n     [out0.amwxhe,'amwxhe',1,0]\n     [out0.amxgam,'amxgam',1,0]\n     [out0.amadtm,'amadtm',1,0]\n     [out0.amric4,'amric4',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n     [out0.amzbbj,'amzbbj',1,0]\n     [out0.amn5hy,'amn5hy',1,0]\n     [out0.amvwbj,'amvwbj',1,0]\n     [out0.amzmbj,'amzmbj',1,0]\n     [out0.dxf_src_rec_cnt,'DXF Source Record Count',1,0]\n     [out0.amk2st,'amk2st',1,0]\n     [out0.dxf_src_sys_id,'DXF Source System ID',1,0]\n     [out0.amnlhy,'amnlhy',1,0]\n     [out0.amv8hy,'amv8hy',1,0]\n     [out0.amnphy,'amnphy',1,0]\n     [out0.amznbj,'amznbj',1,0]\n  ]\n  impacts:\n  [\n     [in0.amc4ai,'amc4ai',1,1]\n     [in0.amk3st,'amk3st',1,1]\n     [in0.amgiic,'amgiic',1,1]\n     [in0.amlcie,'amlcie',1,1]\n     [in0.amwghy,'amwghy',1,1]\n     [in0.amimnb,'amimnb',1,1]\n     [in0.amnbia,'amnbia',1,1]\n     [in0.ami9id,'ami9id',1,1]\n     [in0.amc8ai,'amc8ai',1,1]\n     [in0.amdspr,'amdspr',1,1]\n     [in0.amolhy,'amolhy',1,1]\n     [in0.amxghx,'amxghx',1,1]\n     [in0.amzebj,'amzebj',1,1]\n     [in0.amujcd,'amujcd',1,1]\n     [in0.amddap,'amddap',1,1]\n     [in0.amc2dt,'amc2dt',1,1]\n     [in0.amionb,'amionb',1,1]\n     [in0.amabtm,'amabtm',1,1]\n     [in0.amukcd,'amukcd',1,1]\n     [in0.amvsbj,'amvsbj',1,1]\n     [in0.dxf_src_sys_id,'DXF Source System ID',2,2]\n     [in0.amjjhz,'amjjhz',1,1]\n     [in0.amulbj,'amulbj',1,1]\n     [in0.amqvhq,'amqvhq',1,1]\n     [in0.amzpbj,'amzpbj',1,1]\n     [in0.amvtbj,'amvtbj',1,1]\n     [in0.amtjcd,'amtjcd',1,1]\n     [in0.amwfhy,'amwfhy',1,1]\n     [in0.amnnhy,'amnnhy',1,1]\n     [in0.ambbda,'ambbda',1,1]\n     [in0.amzlbj,'amzlbj',1,1]\n     [in0.amquhq,'amquhq',1,1]\n     [in0.amvkp1,'amvkp1',1,1]\n     [in0.amnmhy,'amnmhy',1,1]\n     [in0.amv7hy,'amv7hy',1,1]\n     [in0.amn3hy,'amn3hy',1,1]\n     [in0.amcvqu,'amcvqu',1,1]\n     [in0.amtfie,'amtfie',1,1]\n     [in0.amnohy,'amnohy',1,1]\n     [in0.dxf_src_dataset_id,'DXF Source Dataset ID',1,1]\n     [in0.amn4hy,'amn4hy',1,1]\n     [in0.amxfhx,'amxfhx',1,1]\n     [in0.amzhbj,'amzhbj',1,1]\n     [in0.amlrst,'amlrst',1,1]\n     [in0.amqkhq,'amqkhq',1,1]\n     [in0.ambxht,'ambxht',1,1]\n     [in0.amkwst,'amkwst',1,1]\n     [in0.amw2he,'amw2he',1,1]\n     [in0.amxihy,'amxihy',1,1]\n     [in0.amj3cj,'amj3cj',1,1]\n     [in0.amzfbj,'amzfbj',1,1]\n     [in0.amqjhq,'amqjhq',1,1]\n     [in0.amxli1,'amxli1',1,1]\n     [in0.amhgak,'amhgak',1,1]\n     [in0.amnjhy,'amnjhy',1,1]\n     [in0.ame1hk,'ame1hk',1,1]\n     [in0.amhtik,'amhtik',1,1]\n     [in0.amzibj,'amzibj',1,1]\n     [in0.amalvn,'amalvn',1,1]\n     [in0.ambwht,'ambwht',1,1]\n     [in0.amv9hy,'amv9hy',1,1]\n     [in0.amqxqu,'amqxqu',1,1]\n     [in0.amr5hs,'amr5hs',1,1]\n     [in0.amasda,'amasda',1,1]\n     [in0.amrmh9,'amrmh9',1,1]\n     [in0.amsdht,'amsdht',1,1]\n     [in0.amwkhc,'amwkhc',1,1]\n     [in0.amtccd,'amtccd',1,1]\n     [in0.ams7cd,'ams7cd',2,2]\n     [in0.ame5hn,'ame5hn',1,1]\n     [in0.amaevn,'amaevn',1,1]\n     [in0.amadvn,'amadvn',1,1]\n     [in0.amwjhc,'amwjhc',1,1]\n     [in0.cdc_ts,'cdc_ts',1,1]\n     [in0.ame6hn,'ame6hn',1,1]\n     [in0.amaqce,'amaqce',1,1]\n     [in0.amambj,'amambj',1,1]\n     [in0.ampdiu,'ampdiu',1,1]\n     [in0.amzgbj,'amzgbj',1,1]\n     [in0.amlrtx,'amlrtx',1,1]\n     [in0.amc4ap,'amc4ap',1,1]\n     [in0.ams5cd,'ams5cd',2,2]\n     [in0.amp2nb,'amp2nb',2,2]\n     [in0.amwdhy,'amwdhy',1,1]\n     [in0.amwehy,'amwehy',1,1]\n     [in0.amc3ap,'amc3ap',1,1]\n     [in0.ambkqu,'ambkqu',1,1]\n     [in0.ambjqu,'ambjqu',1,1]\n     [in0.ams6cd,'ams6cd',2,2]\n     [in0.amlest,'amlest',1,1]\n     [in0.amk0st,'amk0st',1,1]\n     [in0.ampecd,'ampecd',1,1]\n     [in0.amomhy,'amomhy',1,1]\n     [in0.amc6ai,'amc6ai',1,1]\n     [in0.amiicj,'amiicj',1,1]\n     [in0.amythe,'amythe',1,1]\n     [in0.cdc_flag,'cdc_flag',1,1]\n     [in0.amavod,'amavod',1,1]\n     [in0.amumbj,'amumbj',1,1]\n     [in0.amifhe,'amifhe',1,1]\n     [in0.amk6st,'amk6st',1,1]\n     [in0.ams6nb,'ams6nb',4,2]\n     [in0.amychc,'amychc',1,1]\n     [in0.amc5ai,'amc5ai',1,1]\n     [in0.amwlhc,'amwlhc',1,1]\n     [in0.amn5ia,'amn5ia',1,1]\n     [in0.amhuik,'amhuik',1,1]\n     [in0.amoahy,'amoahy',1,1]\n     [in0.amo6h9,'amo6h9',1,1]\n     [in0.amqrap,'amqrap',1,1]\n     [in0.amk7st,'amk7st',1,1]\n     [in0.amurhg,'amurhg',1,1]\n     [in0.amxfam,'amxfam',1,1]\n     [in0.amc7ai,'amc7ai',1,1]\n     [in0.amjihz,'amjihz',1,1]\n     [in0.amvxbj,'amvxbj',1,1]\n     [in0.amakvn,'amakvn',1,1]\n     [in0.amenhz,'amenhz',1,1]\n     [in0.amighe,'amighe',1,1]\n     [in0.amzabj,'amzabj',1,1]\n     [in0.ambmdt,'ambmdt',1,1]\n     [in0.amnhhy,'amnhhy',1,1]\n     [in0.amjghz,'amjghz',1,1]\n     [in0.amzobj,'amzobj',1,1]\n     [in0.amwxhe,'amwxhe',1,1]\n     [in0.amq1hq,'amq1hq',1,1]\n     [in0.amxgam,'amxgam',1,1]\n     [in0.amadtm,'amadtm',1,1]\n     [in0.amric4,'amric4',1,1]\n     [in0.amn5hy,'amn5hy',1,1]\n     [in0.amzbbj,'amzbbj',1,1]\n     [in0.amzmbj,'amzmbj',1,1]\n     [in0.amvwbj,'amvwbj',1,1]\n     [in0.amk2st,'amk2st',1,1]\n     [in0.amnlhy,'amnlhy',1,1]\n     [in0.amv8hy,'amv8hy',1,1]\n     [in0.amnphy,'amnphy',1,1]\n     [in0.amznbj,'amznbj',1,1]\n     [in0.amwahy,'amwahy',1,1]\n     [in0.amzsst,'amzsst',2,2]\n     [in0.amqihq,'amqihq',1,1]\n     [in0.amp7ap,'amp7ap',1,1]\n     [in0.amc2ap,'amc2ap',1,1]\n     [in0.dxf_src_file_name,'DXF Source File Name',1,1]\n     [in0.amsoc4,'amsoc4',1,1]\n     [in0.amejhz,'amejhz',1,1]\n     [in0.amzqbj,'amzqbj',1,1]\n     [in0.amnihy,'amnihy',1,1]\n     [in0.amzjbj,'amzjbj',1,1]\n     [in0.amwbhy,'amwbhy',1,1]\n     [in0.ambqir,'ambqir',1,1]\n     [in0.amzkbj,'amzkbj',1,1]\n     [in0.amiehe,'amiehe',1,1]\n     [in0.amjdhz,'amjdhz',1,1]\n     [in0.amnfhy,'amnfhy',1,1]\n     [in0.amidhe,'amidhe',1,1]\n     [in0.amokhy,'amokhy',1,1]\n     [in0.amc9ai,'amc9ai',1,1]\n     [in0.amwihc,'amwihc',1,1]\n     [in0.amxham,'amxham',1,1]\n     [in0.amulcd,'amulcd',1,1]\n     [in0.amojhy,'amojhy',1,1]\n     [in0.ame4hn,'ame4hn',1,1]\n     [in0.amsaht,'amsaht',1,1]\n     [in0.amnghy,'amnghy',1,1]\n     [in0.ams8cd,'ams8cd',2,2]\n     [in0.amilcj,'amilcj',1,1]\n     [in0.amjhhz,'amjhhz',1,1]\n     [in0.filename,'filename',1,1]\n     [in0.amwchy,'amwchy',1,1]\n     [in0.amrhht,'amrhht',1,1]\n     [in0.dxf_src_rec_cnt,'DXF Source Record Count',1,1]\n     [in0.amtcn2,'amtcn2',1,1]\n     [in0.amc5ap,'amc5ap',1,1]\n     [in0.ambiqu,'ambiqu',1,1]\n     [in0.amaxod,'amaxod',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet string("\\x01",charset="iso-8859-15", maximum_length=20) mbr_id = fail_if_error(in0.ams5cd);\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) carrier_id = fail_if_error(in0.ams6cd);\nlet string("\\x01",charset="iso-8859-15", maximum_length=40) account_id = fail_if_error(in0.ams7cd);\nlet string("\\x01",charset="iso-8859-15", maximum_length=30) employer_group_id = fail_if_error(in0.ams8cd);\nlet decimal("\\\\x01",0) claim_nbr = fail_if_error(in0.amp2nb);\nlet decimal("\\\\x01",0) claim_seq_nbr = fail_if_error(if (in0.ams6nb < 0) in0.ams6nb else 1000 - in0.ams6nb);\nlet string("\\\\x01",charset="iso-8859-15", maximum_length=1) claim_stat_id = fail_if_error(in0.amzsst);\nlet decimal("\\\\x01",0) src_env_sk = fail_if_error(in0.dxf_src_sys_id);\n\n\n\n  out0.mbr_id::mbr_id;\n  out0.carrier_id::carrier_id;\n  out0.account_id::account_id;\n  out0.employer_group_id::employer_group_id;\n  out0.claim_nbr::claim_nbr;\n  out0.claim_seq_nbr::claim_seq_nbr;\n  out0.claim_stat_id::claim_stat_id;\n  out0.src_env_sk::src_env_sk;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_1_XFR||||
OVERRIDE_JOIN_KEY||||{carrier_id; account_id; employer_group_id; mbr_id}
LOOKUP_FIELDS_KEY||||{}
DRIVER_FILE_TYPE||||Clean
NON_DRIVER_1_SOURCE_NAME||||ids_common.d_member
NON_DRIVER_1_FILE_TYPE||||IDS
JOIN_TYPE||||Left Outer Join with ICFF Lookup
JOIN_KEY||||{carrier_id; account_id; employer_group_id; mbr_id}
ADDITIONAL_FIELDS_DML||||record\n  string("\\x01",charset="iso-8859-15", maximum_length=20)   mbr_id = NULL("");\n  string("\\x01",charset="iso-8859-15", maximum_length=30)   carrier_id = NULL("");\n  string("\\x01",charset="iso-8859-15", maximum_length=40)   account_id = NULL("");\n  string("\\x01",charset="iso-8859-15", maximum_length=30)   employer_group_id = NULL("");\n  string("\\x01",charset="iso-8859-15", maximum_length=20)  mbr_hic_cd = NULL("");\n  decimal("\\\\x01",0)  claim_nbr /*BIGINT NOT NULL*/;\n  decimal("\\\\x01",0) claim_seq_nbr /*INTEGER NOT NULL*/;\n  string("\\\\x01",charset="iso-8859-15", maximum_length=1)  claim_stat_id /*CHAR(1) NOT NULL*/;\n  decimal("\\\\x01",0) src_env_sk = NULL /*BIGINT*/;\nend
NON_DRIVER_1_OUTPUT_FIELDS||||carrier_id,account_id,employer_group_id,mbr_id,mbr_hic_cd
DO_CLEAN||||1
NON_DRIVER_2_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58e4e6c0_8dd_7 = $NON_DRIVER_2_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58e4e6c0_8dd_7 = $NON_DRIVER_2_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.claim_nbr,[transform],]\n  [out0.claim_seq_nbr,[transform],]\n  [out0.claim_stat_id,[transform],]\n  [out0.src_env_sk,[passthrough],in0.src_env_sk]\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n     [out0.employer_group_id,'employer_group_id',1,0]\n     [out0.ids_updt_dttm,'ids_updt_dttm',1,0]\n     [out0.claim_nbr,'claim_nbr',1,0]\n     [out0.clt_due_amt,'clt_due_amt',1,0]\n     [out0.app_due_amt,'app_due_amt',1,0]\n     [out0.compound_sk,'compound_sk',1,0]\n     [out0.carrier_id,'carrier_id',1,0]\n     [out0.filled_dt,'filled_dt',1,0]\n     [out0.account_id,'account_id',1,0]\n     [out0.claim_seq_nbr,'claim_seq_nbr',1,0]\n     [out0.filename,'filename',1,0]\n     [out0.filled_dt_sk,'filled_dt_sk',1,0]\n     [out0.prod_sk,'prod_sk',1,0]\n     [out0.claim_stat_id,'claim_stat_id',1,0]\n     [out0.src_env_sk,'src_env_sk',1,0]\n  ]\n  impacts:\n  [\n     [in0.prod_sk,'prod_sk',1,1]\n     [in0.filled_dt,'filled_dt',1,1]\n     [in0.filled_dt_sk,'filled_dt_sk',1,1]\n     [in0.account_id,'account_id',1,1]\n     [in0.employer_group_id,'employer_group_id',1,1]\n     [in0.carrier_id,'carrier_id',1,1]\n     [in0.ids_updt_dttm,'ids_updt_dttm',1,1]\n     [in0.clt_due_amt,'clt_due_amt',1,1]\n     [in0.compound_sk,'compound_sk',1,1]\n     [in0.app_due_amt,'app_due_amt',1,1]\n     [in0.src_env_sk,'src_env_sk',1,1]\n     [in0.filename,'filename',1,1]\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\nlet decimal("\\x01",0) claim_nbr = -1;\nlet decimal("\\x01",0) claim_seq_nbr = -1;\nlet string("\\x01",charset="iso-8859-15", maximum_length=1) claim_stat_id = "";\nlet decimal("\\\\x01",0) src_env_sk = fail_if_error(in0.src_env_sk);\n\n\n\n  out0.claim_nbr::claim_nbr;\n  out0.claim_seq_nbr::claim_seq_nbr;\n  out0.claim_stat_id::claim_stat_id;\n  out0.src_env_sk::src_env_sk;\n  out0.*::in0.*;\n\nend;\n
NON_DRIVER_3_XFR||||/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */\nlet decimal('') bzt_0_6c54cc0a_58e4e6c0_8dd_6 = $NON_DRIVER_3_START_DATE;\nlet decimal('') bzt_1_6c54cc0a_58e4e6c0_8dd_6 = $NON_DRIVER_3_END_DATE;\n\n/*@\ndependency_analysis:\n[\n  [out0.*,in0.*]\n]\nmetrics:\n{\n  dependencies:\n  [\n  ]\n  impacts:\n  [\n  ]\n}\n@*/\n\nout0::reformat(in0)=\nbegin\n\n\n\n  out0.*::in0.*;\n\nend;\n
OVERRIDE_JOIN_LEVEL_2_KEY||||{claim_nbr; claim_seq_nbr; claim_stat_id; src_env_sk}
OVERRIDE_JOIN_LEVEL_3_KEY||||{}
ENABLE_JOIN_LEVEL_2||||1
NON_DRIVER_2_ILM_NAME||||
NON_DRIVER_2_SOURCE_NAME||||ids_rxclaim.f_claim_transaction.reduced
JOIN_LEVEL_2_TYPE||||Left Outer Join with ICFF Lookup
JOIN_LEVEL_2_KEY||||{claim_nbr; claim_seq_nbr; claim_stat_id; src_env_sk}
NON_DRIVER_2_OUTPUT_FIELDS||||claim_nbr,claim_seq_nbr,claim_stat_id,prod_sk,compound_sk,app_due_amt,clt_due_amt,filled_dt,filled_dt_sk
DRIVER_OUTPUT_FIELDS||||dxf_src_dataset_id,dxf_src_rec_cnt,dxf_src_sys_id,dxf_src_file_name,cdc_flag,cdc_ts,amp2nb,ams6nb,amzsst,ams6cd,ame1hk,ams7cd,ams8cd,ams5cd,ambbda,amwihc,amwjhc,amwkhc,amwlhc,amo6h9,amidhe,amifhe,amighe,amiehe,amurhg,amr5hs,amxfhx,amxghx,amdspr,amv7hy,amv8hy,amv9hy,amwahy,amwbhy,amj3cj,amnfhy,amw2he,ambwht,ambxht,amnghy,amnjhy,amoahy,amnlhy,amn3hy,amnihy,amn4hy,amn5hy,amnhhy,amojhy,amxihy,amokhy,amwchy,amolhy,amwdhy,amwxhe,amomhy,amwehy,amnbia,amnmhy,amnnhy,amnohy,amnphy,amwfhy,amwghy,amrhht,amgiic,amtcn2,amric4,ampecd,amionb,amimnb,amukcd,amulcd,amk2st,amk3st,amsoc4,amkwst,amlrst,amlest,ami9id,amlrtx,amiicj,amujcd,amn5ia,amythe,amilcj,amtccd,amk0st,amvkp1,amhtik,amhuik,amejhz,amenhz,amjghz,amjhhz,amjdhz,amjihz,amjjhz,amk6st,amlcie,amtfie,amtjcd,amasda,amaqce,ambqir,ambiqu,ambjqu,amc4ai,amc5ai,amc6ai,ambkqu,amc7ai,amc8ai,amc9ai,amrmh9,amychc,amambj,ame4hn,ame5hn,ame6hn,amcvqu,amhgak,amxfam,amxgam,amxham,amsaht,amsdht,amquhq,amddap,amqvhq,amq1hq,amavod,amaxod,amk7st,amp7ap,amqrap,amc2ap,amqihq,amc3ap,amc4ap,amc5ap,amqjhq,amqkhq,ampdiu,amxli1,amzgbj,amzhbj,amzibj,amznbj,amzobj,amzjbj,amzkbj,amzlbj,amzmbj,amzpbj,amzqbj,amvwbj,amvxbj,amzabj,amzbbj,amzebj,amzfbj,amvsbj,amvtbj,amqxqu,amumbj,amulbj,amakvn,amc2dt,amadtm,amalvn,amadvn,ambmdt,amabtm,amaevn
JOIN_LEVEL_2_XFR:sandbox||||include "~$PUB_DXF_XFR/ids/ids_table_properties.xfr";\r\ninclude "~$PUB_DXF_XFR/common_functions.xfr";\r\ninclude "~$PUB_DXF_DML/generic_data_types.dml";\r\n\r\nlet lookup_identifier_type current_lookup = lookup_not_loaded(); \r\nlet string("") datafile = $"PUB_DATAHUB_MFS_LOOKUP" + "/ids/ids_rxclaim/one/f_claim_transaction.reduced.dat.gz";\r\nlet string("") indexfile=this_partition_path(string_replace(datafile,".dat.gz", ".idx")); \r\ntype lookup_record_type = record\r\n  little endian integer(8) dxf_src_dataset_id = 0;\r\n  little endian integer(4) dxf_src_rec_cnt = 0;\r\n  little endian integer(2) dxf_src_sys_id = 0;\r\n  string(unsigned integer(1)) dxf_src_file_name = "";\r\n  unsigned integer(8)   dxf_hk_part1 =   0 /*Added by Integration Framework. First 8 bytes of the natural key hash.*/;\r\n  unsigned integer(8)   dxf_hk_part2 =   0 /*Added by Integration Framework. Second 8 bytes of the natural key hash.*/;\r\n  unsigned integer(8)   dxf_sk =   0 /*Added by Integration Framework. Surrogate key.*/;\r\n  decimal("\\x01",0)    claim_nbr = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0)    claim_seq_nbr = NULL("") /*INTEGER*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1)    claim_stat_id = NULL("") /*CHAR(1)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=30)  carrier_id = NULL("") /*VARCHAR(30)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=40)  account_id = NULL("") /*VARCHAR(40)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=15)  employer_group_id = NULL("") /*VARCHAR(15)*/;\r\n  decimal("\\x01",0)  src_env_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0)  mbr_sk = NULL("");\r\n  decimal("\\x01",0)  cag_sk = NULL("");\r\n  decimal("\\x01",0)  mbr_adjud_sk = NULL("");\r\n  decimal("\\x01",0)  pbr_sk = NULL("");\r\n  decimal("\\x01",0)  pbr_adjud_sk = NULL("");\r\n  decimal("\\x01",0)  phr_sk = NULL("");\r\n  decimal("\\x01",0)  phr_adjud_sk = NULL("");\r\n  decimal("\\x01",0)  pln_adjud_sk = NULL("");\r\n  decimal("\\x01",0)  prod_sk = NULL("");\r\n  decimal("\\x01",0)  prod_adjud_sk = NULL("");\r\n  decimal("\\x01",0)  care_fac_adjud_sk = NULL("");\r\n  decimal("\\x01",0) claim_stat_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) carrier_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) carrier_acct_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) final_pln_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) compound_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) orig_carrier_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) orig_mbr_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) orig_cag_sk = NULL("") /*BIGINT*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=30) orig_carrier_id = NULL("") /*VARCHAR(30)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=40) orig_account_id = NULL("") /*VARCHAR(40)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=30) orig_employer_group_id = NULL("") /*VARCHAR(30)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=20) orig_member_id = NULL("") /*VARCHAR(20)*/;\r\n  decimal("\\x01",0) claim_seq_nbr_src = NULL("") /*INTEGER*/;\r\n  decimal("\\x01",0) sbm_dt_sk = NULL("") /*BIGINT*/;\r\n  date("YYYYMMDD")("\\x01") sbm_dt = NULL("") /*DATE*/;\r\n  decimal("\\x01",0) filled_dt_sk = NULL("") /*BIGINT*/;\r\n  date("YYYYMMDD")("\\x01") filled_dt = NULL("") /*DATE*/;\r\n  date("YYYYMMDD")("\\x01") rx_written_dt = NULL("") /*DATE*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=12) rx_nbr = NULL("") /*VARCHAR(12)*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=2) refill_nbr = NULL("") /*VARCHAR(2)*/;\r\n  decimal("\\x01".3, maximum_length=13, sign_reserved) drg_qty = NULL("") /*DECIMAL(11,3)*/;\r\n  decimal("\\x01".8, maximum_length=26, sign_reserved) awp_unit_cost = NULL("") /*DECIMAL(24,8)*/;\r\n  decimal("\\x01".5, maximum_length=15, sign_reserved) extd_awp_cost = NULL("") /*DECIMAL(13,5)*/;\r\n  decimal("\\x01",0) refill_max = NULL("") /*SMALLINT*/;\r\n  decimal("\\x01",0) days_sply = NULL("") /*SMALLINT*/;\r\n  decimal("\\x01",0) days_of_supply_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) dmr_ind_sk = NULL("") /*BIGINT*/;\r\n  decimal("\\x01",0) injectable_ind_sk = NULL("") /*BIGINT*/;\r\n  string("\\x01",charset="iso-8859-15", maximum_length=1) injectable_ind = NULL("") /*CHAR(1)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) app_patient_pay_amt = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) app_due_amt = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) clt_due_amt = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) clt_ingred_cost_paid = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) clt_dispensing_fee = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) sbm_ingred_cost_paid = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) sbm_dispensing_fee = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) sbm_patient_pay_amt = NULL("") /*DECIMAL(9,2)*/;\r\n  decimal("\\x01".2, maximum_length=11, sign_reserved) sbm_due_amt = NULL("") /*DECIMAL(9,2)*/;\r\n  datetime("YYYYMMDDHH24MISS")("\\x01")    ids_create_dttm = NULL("");\r\n  string("\\x01", maximum_length=20)    ids_create_uid = NULL("");\r\n  decimal("\\x01",maximum_length=20)    ids_create_run_id =    0;\r\n  datetime("YYYYMMDDHH24MISS")("\\x01")    ids_updt_dttm = NULL("");\r\n  string("\\x01", maximum_length=20)    ids_updt_uid = NULL("");\r\n  decimal("\\x01",maximum_length=20)    ids_updt_run_id =    0;\r\n  string("\\x01",maximum_length=2)    ids_rec_stat_cd = NULL("");\r\n  string(1)  newline =  "\\n";\r\nend\r\n;\r\n\r\nout::reformat(in)=\r\nbegin \r\n  let lookup_record_type lookup_record_value = allocate_with_nulls();\r\n  let lookup_record_type exact_record_value=allocate_with_defaults();\r\n  let lookup_record_type exact_next_record_value=allocate_with_nulls();\r\n  \r\n  let unsigned integer(8) dxf_hk_part1 = in.dxf_hk_part1;\r\n  let unsigned integer(8) dxf_hk_part2 = in.dxf_hk_part2;\r\n\r\n  let decimal("") match_count = 0 ;\r\n  if (current_lookup == lookup_not_loaded()) \r\n  current_lookup = lookup_load(this_partition_path(datafile) ,indexfile, "IDS_LKP_TPL_LEVEL_2"); \r\n\r\n  lookup_record_value = if (current_lookup != lookup_not_loaded() ) lookup_last(current_lookup, "IDS_LKP_TPL_LEVEL_2", dxf_hk_part1) else allocate_with_defaults() ;\r\n  exact_record_value=allocate_with_defaults();\r\n  exact_record_value = if (lookup_record_value.dxf_hk_part1 ==0 ) lookup_record_value               // No Match found on half hash key , So this is insert record.\r\n                      else if  ( dxf_hk_part2 == lookup_record_value.dxf_hk_part2 ) lookup_record_value  //A match is found on dxf part1 as well as dxf part2 keys , this is an exact match in first inetration itself \r\n                      else                                                                        //A Match is found on half hash key but not on full hash key, find exact match inside iteration  .\r\n                      begin\r\n                        match_count=lookup_count(current_lookup, "IDS_LKP_TPL_LEVEL_2", dxf_hk_part1);\r\n                          begin block exact_record_match\r\n                             for (let int k, k < match_count)\r\n                               begin \r\n                                exact_next_record_value = if( k == 0 ) lookup_last(current_lookup, "IDS_LKP_TPL_LEVEL_2", dxf_hk_part1) else lookup_previous(current_lookup,"IDS_LKP_TPL_LEVEL_2");\r\n                                 if ( dxf_hk_part2 == exact_next_record_value.dxf_hk_part2 ) \r\n                                  begin\r\n                                        exact_record_value = exact_next_record_value;\r\n                                        exit  exact_record_match;\r\n                                  end\r\n                                                                                                 \r\n                             end\r\n                          end block exact_record_match\r\n                       result :: exact_record_value ;\r\n                       end;\r\n  out.is_match :: if( exact_record_value.dxf_hk_part1 == 0 and exact_record_value.dxf_hk_part2==0 ) 0 else 1 ;  \r\n  out.dxf_hk_part1 :1: in.dxf_hk_part1;\r\n  out.dxf_hk_part2 :2: in.dxf_hk_part2;\r\n  out.prod_sk :: first_defined(exact_record_value.prod_sk,-1);\r\n  out.compound_sk :: first_defined(exact_record_value.compound_sk,-1);\r\n  out.app_due_amt :: first_defined(exact_record_value.app_due_amt,0);\r\n  out.clt_due_amt :: first_defined(exact_record_value.clt_due_amt,0);\r\n  out.filled_dt :: first_defined(exact_record_value.filled_dt,"19000101");\r\n  out.filled_dt_sk :: first_defined(exact_record_value.filled_dt_sk,-1);\r\n  out.* :4: in.* ;\r\nend ;
