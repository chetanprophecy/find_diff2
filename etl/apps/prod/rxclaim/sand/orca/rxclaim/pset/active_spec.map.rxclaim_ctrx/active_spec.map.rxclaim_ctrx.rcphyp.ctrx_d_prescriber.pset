!prototype|P|||$AI_PSET/active_spec.pset
REPORT_NAME|l|||map.rxclaim_ctrx.rcphyp.ctrx_d_prescriber
SOURCE_NAME||||rxclaim_ctrx.rcphyp
ILM_NAME||||ctrx_d_prescriber
RULESET_XML|l|||<ruleset schema_version="13" compatibility_level="3" match_business_name="1" target_schema_version="18" rpath_type="1">\n  <guid>97d014ac-5756ae83-92a7-7</guid>\n  <pretty_name>Map rxclaim_ctrx.rcphyp to the ctrx_d_prescriber ILM</pretty_name>\n  <usexfr_rpath_type>1</usexfr_rpath_type>\n  <componentinfo>\n    <join_input_required>0</join_input_required>\n    <dedup>0</dedup>\n    <select_expression></select_expression>\n  </componentinfo>\n  <inputs>\n    <bzname>Input 1</bzname>\n    <datasets extdataset_rpath_type="3">\n      <bzname>Input 1</bzname>\n      <extdataset></extdataset>\n    </datasets>\n    <varbls vartype="1">\n      <comment>The surrogate key for the DXF Process Log entry for this source.</comment>\n      <bzname>DXF Source Dataset ID</bzname>\n      <xxname>dxf_src_dataset_id</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <comment>Starts at 1 each time the Source File Name changes.</comment>\n      <bzname>DXF Source Record Count</bzname>\n      <xxname>dxf_src_rec_cnt</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <comment>The numeric identifier of this source.</comment>\n      <bzname>DXF Source System ID</bzname>\n      <xxname>dxf_src_sys_id</xxname>\n    </varbls>\n    <varbls>\n      <comment>The name of the source file, relative to $AI_SERIAL_PENDING.</comment>\n      <bzname>DXF Source File Name</bzname>\n      <xxname>dxf_src_file_name</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alaqcd</bzname>\n      <xxname>alaqcd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alexh7</bzname>\n      <xxname>alexh7</xxname>\n    </varbls>\n    <varbls>\n      <bzname>aleyh7</bzname>\n      <xxname>aleyh7</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>ale4hg</bzname>\n      <xxname>ale4hg</xxname>\n    </varbls>\n    <varbls>\n      <bzname>albxtx</bzname>\n      <xxname>albxtx</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alatcd</bzname>\n      <xxname>alatcd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alaucd</bzname>\n      <xxname>alaucd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alpuhb</bzname>\n      <xxname>alpuhb</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alsqig</bzname>\n      <xxname>alsqig</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alsrig</bzname>\n      <xxname>alsrig</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alssig</bzname>\n      <xxname>alssig</xxname>\n    </varbls>\n    <varbls>\n      <bzname>als5ig</bzname>\n      <xxname>als5ig</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alpjhb</bzname>\n      <xxname>alpjhb</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alpkhb</bzname>\n      <xxname>alpkhb</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alplhb</bzname>\n      <xxname>alplhb</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alpmhb</bzname>\n      <xxname>alpmhb</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alashp</bzname>\n      <xxname>alashp</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alb3tx</bzname>\n      <xxname>alb3tx</xxname>\n    </varbls>\n    <varbls>\n      <bzname>albytx</bzname>\n      <xxname>albytx</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alstig</bzname>\n      <xxname>alstig</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alsuig</bzname>\n      <xxname>alsuig</xxname>\n    </varbls>\n    <varbls>\n      <bzname>albztx</bzname>\n      <xxname>albztx</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alb1tx</bzname>\n      <xxname>alb1tx</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alb0tx</bzname>\n      <xxname>alb0tx</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alpnhb</bzname>\n      <xxname>alpnhb</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>aladnb</bzname>\n      <xxname>aladnb</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alsvig</bzname>\n      <xxname>alsvig</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>aloahr</bzname>\n      <xxname>aloahr</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alswig</bzname>\n      <xxname>alswig</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>alobhr</bzname>\n      <xxname>alobhr</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alsxig</bzname>\n      <xxname>alsxig</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>alesce</bzname>\n      <xxname>alesce</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>alg4ce</bzname>\n      <xxname>alg4ce</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>alg5ce</bzname>\n      <xxname>alg5ce</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alg9ho</bzname>\n      <xxname>alg9ho</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>alaccf</bzname>\n      <xxname>alaccf</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alakvn</bzname>\n      <xxname>alakvn</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>alc2dt</bzname>\n      <xxname>alc2dt</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>aladtm</bzname>\n      <xxname>aladtm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alalvn</bzname>\n      <xxname>alalvn</xxname>\n    </varbls>\n    <varbls>\n      <bzname>aladvn</bzname>\n      <xxname>aladvn</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>albmdt</bzname>\n      <xxname>albmdt</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>alabtm</bzname>\n      <xxname>alabtm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>alaevn</bzname>\n      <xxname>alaevn</xxname>\n    </varbls>\n    <varbls>\n      <bzname>rxt_src_envrt_id</bzname>\n      <xxname>rxt_src_envrt_id</xxname>\n    </varbls>\n    <varbls>\n      <bzname>rxt_src_envrt_nm</bzname>\n      <xxname>rxt_src_envrt_nm</xxname>\n    </varbls>\n    <varbls vartype="3">\n      <bzname>rxt_create_dttm</bzname>\n      <xxname>rxt_create_dttm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>rxt_create_uid</bzname>\n      <xxname>rxt_create_uid</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>rxt_create_run_id</bzname>\n      <xxname>rxt_create_run_id</xxname>\n    </varbls>\n    <varbls>\n      <bzname>rxt_rec_stat_cd</bzname>\n      <xxname>rxt_rec_stat_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>newline</bzname>\n      <xxname>newline</xxname>\n    </varbls>\n  </inputs>\n  <outputs>\n    <bzname>Output</bzname>\n    <datasets extdataset_rpath_type="3">\n      <bzname>Output</bzname>\n      <extdataset></extdataset>\n    </datasets>\n    <varbls vartype="1">\n      <comment>The surrogate key for the DXF Process Log entry for this source.</comment>\n      <bzname>DXF Source Dataset ID</bzname>\n      <xxname>dxf_src_dataset_id</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <comment>Starts at 1 each time the Source File Name changes.</comment>\n      <bzname>DXF Source Record Count</bzname>\n      <xxname>dxf_src_rec_cnt</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <comment>The numeric identifier of this source.</comment>\n      <bzname>DXF Source System ID</bzname>\n      <xxname>dxf_src_sys_id</xxname>\n    </varbls>\n    <varbls>\n      <comment>The name of the source file, relative to $AI_SERIAL_PENDING.</comment>\n      <bzname>DXF Source File Name</bzname>\n      <xxname>dxf_src_file_name</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.dxf_hk_part1</bzname>\n      <xxname>c_prescriber.dxf_hk_part1</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.dxf_hk_part2</bzname>\n      <xxname>c_prescriber.dxf_hk_part2</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.dxf_sk</bzname>\n      <xxname>c_prescriber.dxf_sk</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.pbr_sk</bzname>\n      <default_value>-1</default_value>\n      <xxname>c_prescriber.pbr_sk</xxname>\n      <mapping_description>SK</mapping_description>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_dea_id</bzname>\n      <default_value>string_concat(str1=%[I|albxtx|Input 1] , str2=%[I|alatcd|Input 1])</default_value>\n      <xxname>c_prescriber.pbr_dea_id</xxname>\n      <mapping_description>as per review comment of Santhosh\njoin RCPHYP.ALAQCD = RCPRFP.NYAQCD . If the lookup column value is blank then apply default rule.</mapping_description>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_npi_id</bzname>\n      <default_value>%[F|nylghb|prescriber_id_lkp](%[I|alaqcd|Input 1],%[I|rxt_src_envrt_id|Input 1],&quot;01&quot;)</default_value>\n      <xxname>c_prescriber.pbr_npi_id</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_first_nm</bzname>\n      <default_value>%[I|alsrig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_first_nm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_mid_init_nm</bzname>\n      <default_value>%[I|alssig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_mid_init_nm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_last_nm</bzname>\n      <default_value>%[I|alsqig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_last_nm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_city_nm</bzname>\n      <default_value>%[I|albztx|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_city_nm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_st_cd</bzname>\n      <default_value>%[I|alb1tx|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_st_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_zip_cd</bzname>\n      <default_value>%[I|alb0tx|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_zip_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.phy_pbr_key</bzname>\n      <default_value>%[I|alaqcd|Input 1]</default_value>\n      <xxname>c_prescriber.phy_pbr_key</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_origin_cd</bzname>\n      <default_value>%[I|alexh7|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_origin_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_ld_src_cd</bzname>\n      <default_value>%[I|aleyh7|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_ld_src_cd</xxname>\n    </varbls>\n    <varbls vartype="2">\n      <bzname>c_prescriber.pbr_retmt_dt</bzname>\n      <default_value>YYYYMMDD(19000101)</default_value>\n      <xxname>c_prescriber.pbr_retmt_dt</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_dea_pfx_cd</bzname>\n      <default_value>%[I|albxtx|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_dea_pfx_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_dea_cd</bzname>\n      <default_value>%[I|alatcd|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_dea_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_dea_sufx_cd</bzname>\n      <default_value>%[I|alaucd|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_dea_sufx_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_buss_actv_sub_cd</bzname>\n      <default_value>%[I|alpuhb|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_buss_actv_sub_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_mid_nm</bzname>\n      <default_value>%[I|als5ig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_mid_nm</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_nm_sufx_cd</bzname>\n      <default_value>%[I|alpjhb|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_nm_sufx_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_prim_deg_cd</bzname>\n      <default_value>%[I|alpkhb|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_prim_deg_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_secndry_deg_cd</bzname>\n      <default_value>%[I|alplhb|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_secndry_deg_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_e_mail_addr_txt</bzname>\n      <default_value>%[I|alpmhb|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_e_mail_addr_txt</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_alt_e_mail_addr_txt</bzname>\n      <default_value>%[I|alashp|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_alt_e_mail_addr_txt</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_usr_lic_no</bzname>\n      <default_value>%[I|alb3tx|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_usr_lic_no</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_addr_ln1_txt</bzname>\n      <default_value>%[I|albytx|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_addr_ln1_txt</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_addr_ln2_txt</bzname>\n      <default_value>%[I|alstig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_addr_ln2_txt</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_suite_no</bzname>\n      <default_value>%[I|alsuig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_suite_no</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_cntry_cd</bzname>\n      <default_value>%[I|alpnhb|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_cntry_cd</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.pbr_phone1_no</bzname>\n      <default_value>%[I|aladnb|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_phone1_no</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_phone1_extn_no</bzname>\n      <default_value>%[I|alsvig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_phone1_extn_no</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.pbr_phone2_no</bzname>\n      <default_value>%[I|aloahr|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_phone2_no</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_phone2_extn_no</bzname>\n      <default_value>%[I|alswig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_phone2_extn_no</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.pbr_fax_no</bzname>\n      <default_value>%[I|alobhr|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_fax_no</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_fax_extn_no</bzname>\n      <default_value>%[I|alsxig|Input 1]</default_value>\n      <xxname>c_prescriber.pbr_fax_extn_no</xxname>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.rec_rank_no</bzname>\n      <default_value>%[F|src_env_rnk|src_env_rnk_lkp](%[I|rxt_src_envrt_id|Input 1])</default_value>\n      <xxname>c_prescriber.rec_rank_no</xxname>\n      <mapping_description>Look up on L_SRC_ENV based on SRC_ENV_ID</mapping_description>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.pbr_sts_cd</bzname>\n      <default_value>%[F|nyxfh6|prescriber_id_lkp](%[I|alaqcd|Input 1],%[Ix|rxt_src_envrt_id|Input 1],&quot;01&quot;)</default_value>\n      <xxname>c_prescriber.pbr_sts_cd</xxname>\n      <mapping_description>as per review comment of Santhosh\njoin RCPHYP.ALAQCD = RCPRFP.NYAQCD . If the lookup column value si blank then apply default rule.</mapping_description>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.txnmy_cd</bzname>\n      <default_value>%[F|amrlhj|prescriber_taxonomy_lkp](%[I|alaqcd|Input 1],%[I|rxt_src_envrt_id|Input 1])</default_value>\n      <xxname>c_prescriber.txnmy_cd</xxname>\n    </varbls>\n    <varbls>\n      <bzname>c_prescriber.txnmy_desc</bzname>\n      <default_value>%[F|amsqio|prescriber_taxonomy_lkp](%[I|alaqcd|Input 1],%[I|rxt_src_envrt_id|Input 1])</default_value>\n      <xxname>c_prescriber.txnmy_desc</xxname>\n      <mapping_description>as per review comment of Santhosh\nJoin RCPHYP. join RCPHYP.ALAQCD = RCPHZP.AMAQCD order by AMV2HU, AMV3HU\n\ntrim_no_null_default(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id))\n\nNew Transformation:\n\nselect ( IF (instr(AMSQIO, &apos; - &apos;, 1) &lt; instr(AMSQIO, &apos; - &apos;, -1)) THEN substr(AMSQIO, (instr(AMSQIO, &apos; - &apos;, 1)+1), (instr(AMSQIO, &apos; - &apos;, -1)-instr(AMSQIO, &apos; - &apos;, 1)-1)) ELSE AMSQIO ) from RCPHZP where AMAQCD = RCPHYP.ALAQCD and rxt_src_envrt_id = SRC_ENV_ID order by AMSQIO\n\n_________________________________________________________________________________\n\nif(string_index(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id), &apos; - &apos;) &lt; string_index(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id), &apos; - &apos;, string_length(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id))-1))\ntrim_no_null_default(string_substring(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id),string_index(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id), &apos; - &apos;)+1,string_index(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id), &apos; - &apos;, string_length(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id))-1)-string_index(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id), &apos; - &apos;)-1))\nelse\ntrim_no_null_default(RCPHZP: PHZ Taxonomy Description(RCPHYP: PHY Prescriber Key,in.rxt_src_envrt_id))                                                                                                                                                         _______________________________________________________________________________________________________                                                  Updated as per new mapping for taxonomy description field.                                                                                                            (Get the first record from:\nselect AMSQIO  from RCPHZP where AMAQCD = RCPHYP.ALAQCD and rxt_src_envrt_id = SRC_ENV_ID and AMP6IE = &apos;A&apos;\norder by AMV3HU, AMV2HU , AMRLHJ  \n\nIf no records found, get first record from:\nselect AMSQIO from RCPHZP where AMAQCD = RCPHYP.ALAQCD and rxt_src_envrt_id = SRC_ENV_ID \norder by AMV3HU, AMV2HU , AMRLHJ  )</mapping_description>\n    </varbls>\n    <varbls vartype="1">\n      <bzname>c_prescriber.src_env_sk</bzname>\n      <default_value>%[I|rxt_src_envrt_id|Input 1]</default_value>\n      <xxname>c_prescriber.src_env_sk</xxname>\n    </varbls>\n  </outputs>\n  <lookups>\n    <bzname>src_env_rnk_lkp</bzname>\n    <fields>\n      <datasets extdataset_rpath_type="3">\n        <bzname>src_env_rnk_lkp</bzname>\n        <ab_catalog_name>src_env_rnk_lkp</ab_catalog_name>\n        <extdataset></extdataset>\n      </datasets>\n      <varbls vartype="1">\n        <bzname>src_env_sk</bzname>\n        <xxname>src_env_sk</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>src_env_rnk</bzname>\n        <xxname>src_env_rnk</xxname>\n      </varbls>\n    </fields>\n    <keys>\n      <pretty_name>%[F|src_env_sk|src_env_rnk_lkp]</pretty_name>\n    </keys>\n  </lookups>\n  <lookups>\n    <bzname>prescriber_taxonomy_lkp</bzname>\n    <fields>\n      <datasets extdataset_rpath_type="3">\n        <bzname>prescriber_taxonomy_lkp</bzname>\n        <ab_catalog_name>prescriber_taxonomy_lkp</ab_catalog_name>\n        <extdataset></extdataset>\n      </datasets>\n      <varbls vartype="1">\n        <bzname>dxf_hk_part1</bzname>\n        <xxname>dxf_hk_part1</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>dxf_hk_part2</bzname>\n        <xxname>dxf_hk_part2</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>dxf_sk</bzname>\n        <xxname>dxf_sk</xxname>\n      </varbls>\n      <varbls>\n        <bzname>amaqcd</bzname>\n        <xxname>amaqcd</xxname>\n      </varbls>\n      <varbls>\n        <bzname>amrlhj</bzname>\n        <xxname>amrlhj</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>amv2hu</bzname>\n        <xxname>amv2hu</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>amv3hu</bzname>\n        <xxname>amv3hu</xxname>\n      </varbls>\n      <varbls>\n        <bzname>amsqio</bzname>\n        <xxname>amsqio</xxname>\n      </varbls>\n      <varbls>\n        <bzname>amp6ie</bzname>\n        <xxname>amp6ie</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>src_env_sk</bzname>\n        <xxname>src_env_sk</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>dxf_src_sys_id</bzname>\n        <xxname>dxf_src_sys_id</xxname>\n      </varbls>\n      <varbls vartype="3">\n        <bzname>ids_create_dttm</bzname>\n        <xxname>ids_create_dttm</xxname>\n      </varbls>\n      <varbls>\n        <bzname>ids_create_uid</bzname>\n        <xxname>ids_create_uid</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>ids_create_run_id</bzname>\n        <xxname>ids_create_run_id</xxname>\n      </varbls>\n      <varbls vartype="3">\n        <bzname>ids_updt_dttm</bzname>\n        <xxname>ids_updt_dttm</xxname>\n      </varbls>\n      <varbls>\n        <bzname>ids_updt_uid</bzname>\n        <xxname>ids_updt_uid</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>ids_updt_run_id</bzname>\n        <xxname>ids_updt_run_id</xxname>\n      </varbls>\n      <varbls>\n        <bzname>ids_rec_stat_cd</bzname>\n        <xxname>ids_rec_stat_cd</xxname>\n      </varbls>\n      <varbls>\n        <bzname>newline</bzname>\n        <xxname>newline</xxname>\n      </varbls>\n    </fields>\n    <keys>\n      <pretty_name>%[F|amaqcd|prescriber_taxonomy_lkp]</pretty_name>\n    </keys>\n    <keys>\n      <pretty_name>%[F|src_env_sk|prescriber_taxonomy_lkp]</pretty_name>\n    </keys>\n  </lookups>\n  <lookups>\n    <bzname>prescriber_id_lkp</bzname>\n    <fields>\n      <datasets extdataset_rpath_type="3">\n        <bzname>prescriber_id_lkp</bzname>\n        <ab_catalog_name>prescriber_id_lkp</ab_catalog_name>\n        <extdataset></extdataset>\n      </datasets>\n      <varbls vartype="1">\n        <bzname>dxf_hk_part1</bzname>\n        <xxname>dxf_hk_part1</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>dxf_hk_part2</bzname>\n        <xxname>dxf_hk_part2</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>dxf_sk</bzname>\n        <xxname>dxf_sk</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nylghb</bzname>\n        <xxname>nylghb</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyxch6</bzname>\n        <xxname>nyxch6</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyxeh6</bzname>\n        <xxname>nyxeh6</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyaqcd</bzname>\n        <xxname>nyaqcd</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyxfh6</bzname>\n        <xxname>nyxfh6</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyxgh6</bzname>\n        <xxname>nyxgh6</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyxhh6</bzname>\n        <xxname>nyxhh6</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyhaho</bzname>\n        <xxname>nyhaho</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyakvn</bzname>\n        <xxname>nyakvn</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>nyc2dt</bzname>\n        <xxname>nyc2dt</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>nyadtm</bzname>\n        <xxname>nyadtm</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyalvn</bzname>\n        <xxname>nyalvn</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyadvn</bzname>\n        <xxname>nyadvn</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>nybmdt</bzname>\n        <xxname>nybmdt</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>nyabtm</bzname>\n        <xxname>nyabtm</xxname>\n      </varbls>\n      <varbls>\n        <bzname>nyaevn</bzname>\n        <xxname>nyaevn</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>src_env_sk</bzname>\n        <xxname>src_env_sk</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>dxf_src_sys_id</bzname>\n        <xxname>dxf_src_sys_id</xxname>\n      </varbls>\n      <varbls vartype="3">\n        <bzname>ids_create_dttm</bzname>\n        <xxname>ids_create_dttm</xxname>\n      </varbls>\n      <varbls>\n        <bzname>ids_create_uid</bzname>\n        <xxname>ids_create_uid</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>ids_create_run_id</bzname>\n        <xxname>ids_create_run_id</xxname>\n      </varbls>\n      <varbls vartype="3">\n        <bzname>ids_updt_dttm</bzname>\n        <xxname>ids_updt_dttm</xxname>\n      </varbls>\n      <varbls>\n        <bzname>ids_updt_uid</bzname>\n        <xxname>ids_updt_uid</xxname>\n      </varbls>\n      <varbls vartype="1">\n        <bzname>ids_updt_run_id</bzname>\n        <xxname>ids_updt_run_id</xxname>\n      </varbls>\n      <varbls>\n        <bzname>ids_rec_stat_cd</bzname>\n        <xxname>ids_rec_stat_cd</xxname>\n      </varbls>\n      <varbls>\n        <bzname>newline</bzname>\n        <xxname>newline</xxname>\n      </varbls>\n    </fields>\n    <keys>\n      <pretty_name>%[F|nyaqcd|prescriber_id_lkp]</pretty_name>\n    </keys>\n    <keys>\n      <pretty_name>%[F|src_env_sk|prescriber_id_lkp]</pretty_name>\n    </keys>\n    <keys>\n      <pretty_name>%[F|nyxch6|prescriber_id_lkp]</pretty_name>\n    </keys>\n  </lookups>\n  <params>\n    <bzname>RUN_ID</bzname>\n    <xxname>RUN_ID</xxname>\n  </params>\n  <usexfrs></usexfrs>\n  <configs target_xfr_rpath_type="1" target_component_rpath_type="1">\n    <bzname>Default deployment</bzname>\n    <inputs_dataset_bzname>Input 1</inputs_dataset_bzname>\n    <outputs_dataset_bzname>Output</outputs_dataset_bzname>\n    <lookups_dataset_bzname>src_env_rnk_lkp</lookups_dataset_bzname>\n    <lookups_dataset_bzname>prescriber_taxonomy_lkp</lookups_dataset_bzname>\n    <lookups_dataset_bzname>prescriber_id_lkp</lookups_dataset_bzname>\n    <filetestconfigs>\n      <inputs_physical_location_type>1</inputs_physical_location_type>\n      <inputs_physical_location></inputs_physical_location>\n      <inputs_where_clause></inputs_where_clause>\n      <outputs_physical_location_type>1</outputs_physical_location_type>\n      <outputs_physical_location></outputs_physical_location>\n      <lookups_physical_location_type>1</lookups_physical_location_type>\n      <lookups_physical_location_type>1</lookups_physical_location_type>\n      <lookups_physical_location_type>1</lookups_physical_location_type>\n      <lookups_physical_location></lookups_physical_location>\n      <lookups_physical_location></lookups_physical_location>\n      <lookups_physical_location></lookups_physical_location>\n      <param_value>&quot;20200211000001&quot;</param_value>\n      <regression_physical_location_type>1</regression_physical_location_type>\n      <regression_physical_location></regression_physical_location>\n    </filetestconfigs>\n  </configs>\n  <rules schema_version="18">\n    <guid>97d014ac-57860d4f-c73-1-4</guid>\n    <pretty_name>Compute c_prescriber.pbr_retmt_dt</pretty_name>\n    <outvars>c_prescriber.pbr_retmt_dt</outvars>\n    <exprs>\n      <columns>\n        <heading>datelength</heading>\n        <expression>length_of(%[I|ale4hg|Input 1])</expression>\n      </columns>\n      <columns>\n        <heading>Is8DigitDateValid</heading>\n        <expression>is_valid(YYYYMMDD(%[I|ale4hg|Input 1]))</expression>\n      </columns>\n      <columns>\n        <heading>IsCobolDateValid</heading>\n        <expression>is_valid(YYYYMMDD(19000000 + %[I|ale4hg|Input 1]))</expression>\n      </columns>\n      <columns coltype="1">\n        <heading>c_prescriber.pbr_retmt_dt</heading>\n      </columns>\n      <rows>\n        <guid>97d014ac-57860d4f-c73-1-5</guid>\n        <cells>\n          <contents>8</contents>\n        </cells>\n        <cells>\n          <contents>1</contents>\n        </cells>\n        <cells></cells>\n        <cells>\n          <contents>YYYYMMDD(%[I|ale4hg|Input 1])</contents>\n        </cells>\n      </rows>\n      <rows>\n        <guid>97d014ac-57860d4f-c73-1-6</guid>\n        <cells>\n          <contents>6 or 7</contents>\n        </cells>\n        <cells></cells>\n        <cells>\n          <contents>1</contents>\n        </cells>\n        <cells>\n          <contents>YYYYMMDD(19000000 + %[I|ale4hg|Input 1])</contents>\n        </cells>\n      </rows>\n    </exprs>\n    <tests></tests>\n  </rules>\n</ruleset>\n
CATALOG_CONTENTS|$|||src_env_rnk_lkp,{src_env_sk},/~$AI_SERIAL_LOOKUP/lookup.ids_common/lookup.ids_common.l_src_env.dat,/~$AI_DML/lookup.ids_common/lookup.ids_common.l_src_env.dml\nprescriber_taxonomy_lkp,{amaqcd; src_env_sk},/~$AI_SERIAL_LOOKUP/lookup.rxclaim_ctrx/lookup.rxclaim_ctrx.rcphyp.rcphzp.reduced.dat,/~$AI_DML/map.rxclaim_ctrx/map.rxclaim_ctrx.rcphyp.ctrx_d_prescriber.reduced_lkp.rxclaim_ctrx.rcphyp.rcphzp.reduced.dml\nprescriber_id_lkp,{nyaqcd; src_env_sk; nyxch6},/~$AI_SERIAL_LOOKUP/lookup.rxclaim_ctrx/lookup.rxclaim_ctrx.rcphyp.rcprfp.dat,/~$AI_DML/map.rxclaim_ctrx/map.rxclaim_ctrx.rcphyp.ctrx_d_prescriber.reduced_lkp.rxclaim_ctrx.rcphyp.rcprfp.dml\n
