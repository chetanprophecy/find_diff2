/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */
include '~$AI_XFR/bre_helper.map.xfr';

/*@
dependency_analysis:
[
  [out0.d_mbr_elgtb.mbr_sk,[transform],]
  [out0.ctrx_d_mbr.employer_group_id,[passthrough],in0.fladcd]
  [out0.ctrx_d_cag.account_id,[passthrough],in0.flaccd]
  [out0.d_mbr_elgtb.copay_gen_amt,[passthrough],in0.fll9pr]
  [out0.d_mbr_elgtb.account_id,[passthrough],in0.flaccd]
  [out0.d_mbr_elgtb.seq_nbr,[passthrough],in0.flc5n1]
  [out0.d_mbr_elgtb.employer_group_id,[passthrough],in0.fladcd]
  [out0.d_mbr_elgtb.src_env_sk,[passthrough],in0.rxt_src_envrt_id]
  [out0.d_mbr_elgtb.mel_thru_dt,[transform],in0.flcqda]
  [out0.d_mbr_elgtb.clt_rdr_cd,[passthrough],in0.flplc2]
  [out0.d_mbr_elgtb.cag_sk,[transform],]
  [out0.ctrx_d_mbr.carrier_id,[passthrough],in0.flaacd]
  [out0.d_mbr_elgtb.copay4_amt,[passthrough],in0.flmbpr]
  [out0.dxf_src_dataset_id,[transform],in0.flabtm,
     in0.flbmdt]
  [out0.ctrx_d_mbr.account_id,[passthrough],in0.flaccd]
  [out0.ctrx_d_cag.employer_group_id,[passthrough],in0.fladcd]
  [out0.ctrx_d_mbr.mbr_id,[passthrough],in0.flabcd]
  [out0.d_mbr_elgtb.mel_eff_dt,[transform],in0.flcpda]
  [out0.d_mbr_elgtb.copay3_amt,[passthrough],in0.flmapr]
  [out0.d_mbr_elgtb.pln_cd,[passthrough],in0.flaecd]
  [out0.d_mbr_elgtb.copay_brnd_amt,[passthrough],in0.fll8pr]
  [out0.d_mbr_elgtb.mel_stat_cd,[passthrough],in0.flb9s2]
  [out0.d_mbr_elgtb.plan_eff_dt,[transform],in0.flakdt]
  [out0.d_mbr_elgtb.spnd_dwn_amt,[passthrough],in0.fll7hy]
  [out0.d_mbr_elgtb.mbr_id,[passthrough],in0.flabcd]
  [out0.d_mbr_elgtb.carrier_id,[passthrough],in0.flaacd]
  [out0.ctrx_d_cag.carrier_id,[passthrough],in0.flaacd]
  [out0.d_mbr_elgtb.clt_prod_cd,[passthrough],in0.flpkc2]
  [out0.d_mbr_elgtb.mbr_eligty_sk,[transform],]
  [out0.*,in0.*]
]
metrics:
{
  dependencies:
  [
     [out0.d_mbr_elgtb.mbr_sk,'d_mbr_elgtb.mbr_sk',1,0]
     [out0.ctrx_d_mbr.employer_group_id,'ctrx_d_mbr.employer_group_id',1,0]
     [out0.ctrx_d_cag.account_id,'ctrx_d_cag.account_id',1,0]
     [out0.d_mbr_elgtb.copay_gen_amt,'d_mbr_elgtb.copay_gen_amt',1,0]
     [out0.d_mbr_elgtb.account_id,'d_mbr_elgtb.account_id',1,0]
     [out0.d_mbr_elgtb.seq_nbr,'d_mbr_elgtb.seq_nbr',1,0]
     [out0.d_mbr_elgtb.employer_group_id,'d_mbr_elgtb.employer_group_id',1,0]
     [out0.d_mbr_elgtb.src_env_sk,'d_mbr_elgtb.src_env_sk',1,0]
     [out0.d_mbr_elgtb.mel_thru_dt,'d_mbr_elgtb.mel_thru_dt',3,2]
     [out0.d_mbr_elgtb.clt_rdr_cd,'d_mbr_elgtb.clt_rdr_cd',1,0]
     [out0.d_mbr_elgtb.cag_sk,'d_mbr_elgtb.cag_sk',1,0]
     [out0.ctrx_d_mbr.carrier_id,'ctrx_d_mbr.carrier_id',1,0]
     [out0.d_mbr_elgtb.copay4_amt,'d_mbr_elgtb.copay4_amt',1,0]
     [out0.dxf_src_dataset_id,'DXF Source Dataset ID',1,0]
     [out0.ctrx_d_mbr.account_id,'ctrx_d_mbr.account_id',1,0]
     [out0.ctrx_d_cag.employer_group_id,'ctrx_d_cag.employer_group_id',1,0]
     [out0.ctrx_d_mbr.mbr_id,'ctrx_d_mbr.mbr_id',1,0]
     [out0.d_mbr_elgtb.mel_eff_dt,'d_mbr_elgtb.mel_eff_dt',3,2]
     [out0.d_mbr_elgtb.copay3_amt,'d_mbr_elgtb.copay3_amt',1,0]
     [out0.dxf_src_file_name,'DXF Source File Name',1,0]
     [out0.d_mbr_elgtb.pln_cd,'d_mbr_elgtb.pln_cd',1,0]
     [out0.d_mbr_elgtb.copay_brnd_amt,'d_mbr_elgtb.copay_brnd_amt',1,0]
     [out0.d_mbr_elgtb.mel_stat_cd,'d_mbr_elgtb.mel_stat_cd',1,0]
     [out0.d_mbr_elgtb.plan_eff_dt,'d_mbr_elgtb.plan_eff_dt',3,2]
     [out0.d_mbr_elgtb.spnd_dwn_amt,'d_mbr_elgtb.spnd_dwn_amt',1,0]
     [out0.d_mbr_elgtb.mbr_id,'d_mbr_elgtb.mbr_id',1,0]
     [out0.dxf_src_rec_cnt,'DXF Source Record Count',1,0]
     [out0.dxf_src_sys_id,'DXF Source System ID',1,0]
     [out0.d_mbr_elgtb.carrier_id,'d_mbr_elgtb.carrier_id',1,0]
     [out0.ctrx_d_cag.carrier_id,'ctrx_d_cag.carrier_id',1,0]
     [out0.d_mbr_elgtb.clt_prod_cd,'d_mbr_elgtb.clt_prod_cd',1,0]
     [out0.d_mbr_elgtb.mbr_eligty_sk,'d_mbr_elgtb.mbr_eligty_sk',1,0]
  ]
  impacts:
  [
     [in0.fll7hy,'fll7hy',1,1]
     [in0.fll8pr,'fll8pr',1,1]
     [in0.dxf_src_file_name,'DXF Source File Name',1,1]
     [in0.flabtm,'flabtm',1,1]
     [in0.flabcd,'flabcd',2,2]
     [in0.flcqda,'flcqda',5,3]
     [in0.flplc2,'flplc2',1,1]
     [in0.flakdt,'flakdt',5,3]
     [in0.dxf_src_sys_id,'DXF Source System ID',1,1]
     [in0.flaacd,'flaacd',3,3]
     [in0.flb9s2,'flb9s2',1,1]
     [in0.flc5n1,'flc5n1',1,1]
     [in0.flpkc2,'flpkc2',1,1]
     [in0.fll9pr,'fll9pr',1,1]
     [in0.flaccd,'flaccd',3,3]
     [in0.flmbpr,'flmbpr',1,1]
     [in0.fladcd,'fladcd',3,3]
     [in0.flaecd,'flaecd',1,1]
     [in0.rxt_src_envrt_id,'rxt_src_envrt_id',1,1]
     [in0.flcpda,'flcpda',5,3]
     [in0.flmapr,'flmapr',1,1]
     [in0.dxf_src_rec_cnt,'DXF Source Record Count',1,1]
     [in0.flbmdt,'flbmdt',1,1]
  ]
}
@*/

out0::reformat(in0)=
begin
let int bzt_0 = 0;
let int bzt_1 = 0;
let int bzt_2 = 0;
let little endian integer(8) DXF_Source_Dataset_ID;
let decimal("\x01",0) d_mbr_elgtb_mbr_eligty_sk = -1;
let decimal("\x01",0) d_mbr_elgtb_cag_sk = -1;
let decimal("\x01",0) d_mbr_elgtb_mbr_sk = -1;
let string("\x01",charset="iso-8859-15", maximum_length=30) d_mbr_elgtb_carrier_id = fail_if_error(in0.flaacd);
let string("\x01",charset="iso-8859-15", maximum_length=40) d_mbr_elgtb_account_id = fail_if_error(in0.flaccd);
let string("\x01",charset="iso-8859-15", maximum_length=30) d_mbr_elgtb_employer_group_id = fail_if_error(in0.fladcd);
let string("\x01",charset="iso-8859-15", maximum_length=20) d_mbr_elgtb_mbr_id = fail_if_error(in0.flabcd);
let decimal("\x01",0) d_mbr_elgtb_seq_nbr = fail_if_error(in0.flc5n1);
let string("\x01",charset="iso-8859-15", maximum_length=1) d_mbr_elgtb_mel_stat_cd = fail_if_error(in0.flb9s2);
let date("YYYYMMDD")("\x01") d_mbr_elgtb_mel_eff_dt;
let date("YYYYMMDD")("\x01") d_mbr_elgtb_mel_thru_dt;
let decimal("\x01".2, maximum_length=7, sign_reserved) d_mbr_elgtb_copay_brnd_amt = fail_if_error(in0.fll8pr);
let decimal("\x01".2, maximum_length=7, sign_reserved) d_mbr_elgtb_copay_gen_amt = fail_if_error(in0.fll9pr);
let decimal("\x01".2, maximum_length=7, sign_reserved) d_mbr_elgtb_copay3_amt = fail_if_error(in0.flmapr);
let decimal("\x01".2, maximum_length=7, sign_reserved) d_mbr_elgtb_copay4_amt = fail_if_error(in0.flmbpr);
let string("\x01",charset="iso-8859-15", maximum_length=6) d_mbr_elgtb_clt_prod_cd = fail_if_error(in0.flpkc2);
let string("\x01",charset="iso-8859-15", maximum_length=6) d_mbr_elgtb_clt_rdr_cd = fail_if_error(in0.flplc2);
let string("\x01",charset="iso-8859-15", maximum_length=10) d_mbr_elgtb_pln_cd = fail_if_error(in0.flaecd);
let date("YYYYMMDD")("\x01") d_mbr_elgtb_plan_eff_dt;
let decimal("\x01".2, maximum_length=11, sign_reserved) d_mbr_elgtb_spnd_dwn_amt = fail_if_error(in0.fll7hy);
let decimal("\x01",0) d_mbr_elgtb_src_env_sk = fail_if_error(in0.rxt_src_envrt_id);
let string("\x01",charset="iso-8859-15", maximum_length=30) ctrx_d_cag_carrier_id = fail_if_error(in0.flaacd);
let string("\x01",charset="iso-8859-15", maximum_length=40) ctrx_d_cag_account_id = fail_if_error(in0.flaccd);
let string("\x01",charset="iso-8859-15", maximum_length=30) ctrx_d_cag_employer_group_id = fail_if_error(in0.fladcd);
let string("\x01",charset="iso-8859-15", maximum_length=30) ctrx_d_mbr_carrier_id = fail_if_error(in0.flaacd);
let string("\x01",charset="iso-8859-15", maximum_length=40) ctrx_d_mbr_account_id = fail_if_error(in0.flaccd);
let string("\x01",charset="iso-8859-15", maximum_length=30) ctrx_d_mbr_employer_group_id = fail_if_error(in0.fladcd);
let string("\x01",charset="iso-8859-15", maximum_length=20) ctrx_d_mbr_mbr_id = fail_if_error(in0.flabcd);



/*   Rule:Compute d_mbr_elgtb.mel_eff_dt  (#1)   */
if(first_defined(fail_if_error(((length_of(in0.flcpda)) ==8) && ((is_valid(YYYYMMDD(in0.flcpda))) ==1)),0))begin
  bzt_0=1;
  d_mbr_elgtb_mel_eff_dt=YYYYMMDD(in0.flcpda);
end
else if(first_defined(fail_if_error(((length_of(in0.flcpda) member [vector 6,7])) && ((is_valid(YYYYMMDD(19000000+ in0.flcpda))) ==1)),0))begin
  bzt_0=1;
  d_mbr_elgtb_mel_eff_dt=YYYYMMDD(19000000+ in0.flcpda);
end

/*   Default value   */
if(!bzt_0)begin
  d_mbr_elgtb_mel_eff_dt=fail_if_error(low_date());
end

/*   Rule:Compute d_mbr_elgtb.mel_thru_dt  (#2)   */
if(first_defined(fail_if_error(((length_of(in0.flcqda)) ==8) && ((is_valid(YYYYMMDD(in0.flcqda))) ==1)),0))begin
  bzt_1=1;
  d_mbr_elgtb_mel_thru_dt=YYYYMMDD(in0.flcqda);
end
else if(first_defined(fail_if_error(((length_of(in0.flcqda) member [vector 6,7])) && ((is_valid(YYYYMMDD(19000000+ in0.flcqda))) ==1)),0))begin
  bzt_1=1;
  d_mbr_elgtb_mel_thru_dt=YYYYMMDD(19000000+ in0.flcqda);
end

/*   Default value   */
if(!bzt_1)begin
  d_mbr_elgtb_mel_thru_dt=fail_if_error(high_date());
end

/*   Rule:Compute d_mbr_elgtb.plan_eff_dt  (#3)   */
if(first_defined(fail_if_error(((length_of(in0.flakdt)) ==8) && ((is_valid(YYYYMMDD(in0.flakdt))) ==1)),0))begin
  bzt_2=1;
  d_mbr_elgtb_plan_eff_dt=YYYYMMDD(in0.flakdt);
end
else if(first_defined(fail_if_error(((length_of(in0.flakdt) member [vector 6,7])) && ((is_valid(YYYYMMDD(19000000+ in0.flakdt))) ==1)),0))begin
  bzt_2=1;
  d_mbr_elgtb_plan_eff_dt=YYYYMMDD(19000000+ in0.flakdt);
end

/*   Default value   */
if(!bzt_2)begin
  d_mbr_elgtb_plan_eff_dt=fail_if_error(low_date());
end

/*   Default value   */
DXF_Source_Dataset_ID=fail_if_error(create_src_dataset_id(bmdt=in0.flbmdt , abtm=in0.flabtm ));

  out0.dxf_src_dataset_id::DXF_Source_Dataset_ID;
  out0.d_mbr_elgtb.mbr_eligty_sk::d_mbr_elgtb_mbr_eligty_sk;
  out0.d_mbr_elgtb.cag_sk::d_mbr_elgtb_cag_sk;
  out0.d_mbr_elgtb.mbr_sk::d_mbr_elgtb_mbr_sk;
  out0.d_mbr_elgtb.carrier_id::d_mbr_elgtb_carrier_id;
  out0.d_mbr_elgtb.account_id::d_mbr_elgtb_account_id;
  out0.d_mbr_elgtb.employer_group_id::d_mbr_elgtb_employer_group_id;
  out0.d_mbr_elgtb.mbr_id::d_mbr_elgtb_mbr_id;
  out0.d_mbr_elgtb.seq_nbr::d_mbr_elgtb_seq_nbr;
  out0.d_mbr_elgtb.mel_stat_cd::d_mbr_elgtb_mel_stat_cd;
  out0.d_mbr_elgtb.mel_eff_dt::d_mbr_elgtb_mel_eff_dt;
  out0.d_mbr_elgtb.mel_thru_dt::d_mbr_elgtb_mel_thru_dt;
  out0.d_mbr_elgtb.copay_brnd_amt::d_mbr_elgtb_copay_brnd_amt;
  out0.d_mbr_elgtb.copay_gen_amt::d_mbr_elgtb_copay_gen_amt;
  out0.d_mbr_elgtb.copay3_amt::d_mbr_elgtb_copay3_amt;
  out0.d_mbr_elgtb.copay4_amt::d_mbr_elgtb_copay4_amt;
  out0.d_mbr_elgtb.clt_prod_cd::d_mbr_elgtb_clt_prod_cd;
  out0.d_mbr_elgtb.clt_rdr_cd::d_mbr_elgtb_clt_rdr_cd;
  out0.d_mbr_elgtb.pln_cd::d_mbr_elgtb_pln_cd;
  out0.d_mbr_elgtb.plan_eff_dt::d_mbr_elgtb_plan_eff_dt;
  out0.d_mbr_elgtb.spnd_dwn_amt::d_mbr_elgtb_spnd_dwn_amt;
  out0.d_mbr_elgtb.src_env_sk::d_mbr_elgtb_src_env_sk;
  out0.ctrx_d_cag.carrier_id::ctrx_d_cag_carrier_id;
  out0.ctrx_d_cag.account_id::ctrx_d_cag_account_id;
  out0.ctrx_d_cag.employer_group_id::ctrx_d_cag_employer_group_id;
  out0.ctrx_d_mbr.carrier_id::ctrx_d_mbr_carrier_id;
  out0.ctrx_d_mbr.account_id::ctrx_d_mbr_account_id;
  out0.ctrx_d_mbr.employer_group_id::ctrx_d_mbr_employer_group_id;
  out0.ctrx_d_mbr.mbr_id::ctrx_d_mbr_mbr_id;
  out0.*::in0.*;

end;
