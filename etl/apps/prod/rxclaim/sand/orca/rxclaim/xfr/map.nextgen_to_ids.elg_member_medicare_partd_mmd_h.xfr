include "/~$PUB_DXF_XFR/dataset_id.xfr";
include "/~$PUB_DXF_XFR/sys_id.xfr";
include "/~$PUB_DXF_XFR/standardize.xfr";
include "/~$PUB_DXF_DML/dxf_job_event_text.dml";

let string("") run_user_id = "aiorcrxc";/*$(echo '"'`whoami`'"')  ;*/
let start_time = now();
let datetime("YYYY-MM-DD HH24:MI:SS.nnnnnn") v_START_CHANGES_TIME=if(is_blank($"START_CHANGES_TIME") or is_null($"START_CHANGES_TIME")) (datetime("YYYY-MM-DD HH24:MI:SS.nnnnnn"))(datetime("YYYY-MM-DD HH24:MI:SS")) now()
                      else (datetime("YYYY-MM-DD HH24:MI:SS.nnnnnn"))(datetime("YYYY-MM-DD HH24:MI:SS"))  $"START_CHANGES_TIME" ;
                      
                      

out :: reformat(in) =
begin

let decimal("") dxf_src_sys_id=in.src_env_sk;
  out.* :: in.*;
  
  out.(*, name == "cdc_ts" ) :5: (datetime("YYYY-MM-DD HH24:MI:SS.nnnnnn"))(datetime("YYYY-MM-DD HH24:MI:SS"))  v_START_CHANGES_TIME ;
  out.(*, name == "cdc_flag"):6: "N";
  out.(*, name == "rxt_src_envrt_id") :7: (string(""))(decimal(""))dxf_src_sys_id;   // Added for LCTRX direct access migration.
  out.(*, name == "rxt_src_envrt_nm") :8:  system_number_to_name(dxf_src_sys_id);
  out.(*, name == "rxt_create_uid") :9: run_user_id;
  out.(*, name == "rxt_create_run_id") :10: (decimal(""))(string(""))(datetime("YYYYMMDDHH24MISS"))(datetime("YYYY-MM-DD HH24:MI:SS")) $"END_CHANGES_TIME";
  out.(*, name == "rxt_create_dttm") :11: (datetime("YYYYMMDDHH24MISS"))(datetime("YYYY-MM-DD HH24:MI:SS"))  $"START_CHANGES_TIME";
  
  out.dxf_src_sys_id :: dxf_src_sys_id;
 out.a0abcd::in.mbr_member_id;
out.a0accd::in.acc_account_id;
out.a0ochg::(decimal("\x01,0"))(string(""))(date("YYYYMMDD"))(date("YYYY-MM-DD"))in.mmd_from_date;


out.a0adcd::in.grp_group_id;


out.a0x9hc::in.mmd_contract_number;
out.a0c7hk::(decimal("\x01,0"))(string(""))(date("YYYYMMDD"))(date("YYYY-MM-DD"))in.mmd_co_pay_cat_eff_date;



out.a0rmh9::in.mmd_co_pay_category;
out.a0ychc::in.mmd_subsidy_level;


out.a0aacd::in.car_carrier_id;
out.a0ybhc::in.mmd_segment_id;
out.a0rkh9::in.mmd_enrollment_source;

out.a0rjh9::in.mmd_record_status;

out.a0odhg::(decimal("\x01,0"))(string(""))(date("YYYYMMDD"))(date("YYYY-MM-DD"))in.mmd_thru_date;


out.a0ebhs::in.mmd_seq_nbr;
out.a0yahc::in.mmd_pbp_number;



out.a0c2dt :: (decimal("\x01,0"))(string(""))(date("YYYYMMDD"))(date("YYYY-MM-DD"))in.add_time;
out.a0alvn :: in.add_program_name;
out.a0akvn :: in.add_user_name;
out.a0adtm :: (decimal(""))(string(""))(datetime("HH24MISS"))(datetime("HH24:MI:SS"))in.add_time;
out.a0advn :: in.chg_user_name;
out.a0bmdt :: (decimal("\x01,0"))(string(""))(date("YYYYMMDD"))(date("YYYY-MM-DD"))in.chg_date;
out.a0abtm :: (decimal("\x01,0"))(string(""))(datetime("HH24MISS"))(datetime("HH24:MI:SS"))in.chg_time;
out.a0aevn :: in.chg_program_name;

end;
