/*   Do not edit. Generated file - BRE 4.0.2.18;;Default deployment;   */
include '~$AI_XFR/bre_helper.map.xfr';
type bzt_2_6c54cc0a_58eb46ec_3565_0 = record
  unsigned integer(8) dxf_hk_part1 = 0, dxf_hk_part2 = 0;
  decimal("\x01",0) claim_nbr = NULL(""), claim_seq_nbr = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=1) claim_stat_id = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=30) carrier_id = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=40) account_id = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=15) employer_group_id = NULL("");
  decimal("\x01",0) src_env_sk = NULL(""), mbr_sk = NULL(""), cag_sk = NULL(""), mbr_adjud_sk = NULL(""), pbr_sk = NULL(""), pbr_adjud_sk = NULL(""), phr_sk = NULL(""), phr_adjud_sk = NULL(""), pln_adjud_sk = NULL(""), prod_sk = NULL(""), prod_adjud_sk = NULL(""), care_fac_adjud_sk = NULL(""), claim_stat_sk = NULL(""), carrier_sk = NULL(""), carrier_acct_sk = NULL(""), final_pln_sk = NULL(""), compound_sk = NULL(""), orig_carrier_sk = NULL(""), orig_mbr_sk = NULL(""), orig_cag_sk = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=30) orig_carrier_id = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=40) orig_account_id = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=30) orig_employer_group_id = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=20) orig_member_id = NULL("");
  decimal("\x01",0) claim_seq_nbr_src = NULL(""), sbm_dt_sk = NULL("");
  date("YYYYMMDD")("\x01") sbm_dt = NULL("");
  decimal("\x01",0) filled_dt_sk = NULL("");
  date("YYYYMMDD")("\x01") filled_dt = NULL(""), rx_written_dt = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=12) rx_nbr = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=2) refill_nbr = NULL("");
  decimal("\x01".3, maximum_length=13, sign_reserved) drg_qty = NULL("");
  decimal("\x01".8, maximum_length=26, sign_reserved) awp_unit_cost = NULL("");
  decimal("\x01".5, maximum_length=15, sign_reserved) extd_awp_cost = NULL("");
  decimal("\x01",0) refill_max = NULL(""), days_sply = NULL(""), days_of_supply_sk = NULL(""), dmr_ind_sk = NULL(""), injectable_ind_sk = NULL("");
  string("\x01",charset="iso-8859-15", maximum_length=1) injectable_ind = NULL("");
  decimal("\x01".2, maximum_length=11, sign_reserved) app_patient_pay_amt = NULL(""), app_due_amt = NULL(""), clt_due_amt = NULL(""), clt_ingred_cost_paid = NULL(""), clt_dispensing_fee = NULL(""), sbm_ingred_cost_paid = NULL(""), sbm_dispensing_fee = NULL(""), sbm_patient_pay_amt = NULL(""), sbm_due_amt = NULL("");
  datetime("YYYYMMDDHH24MISS")("\x01") ids_updt_dttm = NULL("");
  string(1) newline = "\n";
end;


/*@ BizHidden:true @*/
/*   lookup orx_f_claim_transaction_reduced_lkp   */
out0::bzt_6_6c54cc0a_58eb46ec_3565_0(in0)=
begin
let bzt_2_6c54cc0a_58eb46ec_3565_0 __bzt_local_res__;
if(!bzt_9_6c54cc0a_58eb46ec_3565_0)begin
  bzt_9_6c54cc0a_58eb46ec_3565_0 = 1;
  bzt_8_6c54cc0a_58eb46ec_3565_0 = 0;
  __bzt_local_res__ = fail_if_error(lookup("orx_f_claim_transaction_reduced_lkp",in0.aip2nb,if(in0.aioinb<0) in0.aioinb else (1000-in0.aioinb),in0.claimsts,in0.dxf_src_sys_id));
  if(is_defined(__bzt_local_res__))begin
     bzt_7_6c54cc0a_58eb46ec_3565_0 = __bzt_local_res__;
     bzt_8_6c54cc0a_58eb46ec_3565_0 = 1;
  end
end
  out0:1:if(bzt_8_6c54cc0a_58eb46ec_3565_0)bzt_7_6c54cc0a_58eb46ec_3565_0;
  out0::NULL;
end;
let bzt_2_6c54cc0a_58eb46ec_3565_0 bzt_7_6c54cc0a_58eb46ec_3565_0 = allocate_with_nulls();  /*   lookup orx_f_claim_transaction_reduced_lkp   */
let int bzt_8_6c54cc0a_58eb46ec_3565_0 = 0;
let int bzt_9_6c54cc0a_58eb46ec_3565_0 = 0;

/*@ BizHidden:true @*/
constant string(int) RUN_ID parameter  = allocate_with_defaults();

out0::Map_rxclaim_orx_rccobp_interm_to_the_orx_f_cob_claim_transaction_ILM_documentation(in)=
begin

out0.f_cob_clm.cob_oth_pyr_bnstg_amt_cnt::depends_on(
         in.aigbpp
         );


out0.f_cob_clm.carrier_sk::depends_on(
         in.dxf_src_sys_id,
         in.claimsts,
         in.aioinb,
         in.aip2nb,
         lookup("orx_f_claim_transaction_reduced_lkp",in.aip2nb,'keystr',in.claimsts,in.dxf_src_sys_id).carrier_sk  
         );


out0.f_cob_clm.claim_nbr_encrp::depends_on(
         in.aip2nb
         );


out0.f_cob_clm.cob_oth_pyr_dt::depends_on(
         in.aiacda
         );


out0.f_cob_clm.cob_oth_pyr_id::depends_on(
         in.airzc4
         );


out0.f_cob_clm.cob_oth_pyr_cov_type::depends_on(
         in.aiincj
         );


out0.f_cob_clm.claim_seq_nbr::depends_on(
         in.aioinb
         );


out0.f_cob_clm.src_env_sk::depends_on(
         in.dxf_src_sys_id
         );


out0.f_cob_clm.cob_oth_pyr_id_qlfr::depends_on(
         in.aiipcj
         );


out0.f_cob_clm.claim_nbr::depends_on(
         in.aip2nb
         );


out0.f_cob_clm.cob_oth_pyr_rej_cnt::depends_on(
         in.airyn2
         );


out0.f_cob_clm.cob_oth_pyr_amt_paid_cnt::depends_on(
         in.airxn2
         );


out0.f_cob_clm.cob_oth_pyr_intnl_cntrl_cd::depends_on(
         in.aisdip
         );


out0.f_cob_clm.cob_seq_nbr::depends_on(
         in.aiven2
         );


out0.f_cob_clm.cag_sk::depends_on(
         in.dxf_src_sys_id,
         in.claimsts,
         in.aioinb,
         in.aip2nb,
         lookup("orx_f_claim_transaction_reduced_lkp",in.aip2nb,'keystr',in.claimsts,in.dxf_src_sys_id).cag_sk  
         );


out0.f_cob_clm.prod_sk::depends_on(
         in.dxf_src_sys_id,
         in.claimsts,
         in.aioinb,
         in.aip2nb,
         lookup("orx_f_claim_transaction_reduced_lkp",in.aip2nb,'keystr',in.claimsts,in.dxf_src_sys_id).prod_sk  
         );


out0.f_cob_clm.mbr_sk::depends_on(
         in.dxf_src_sys_id,
         in.claimsts,
         in.aioinb,
         in.aip2nb,
         lookup("orx_f_claim_transaction_reduced_lkp",in.aip2nb,'keystr',in.claimsts,in.dxf_src_sys_id).mbr_sk  
         );


out0.f_cob_clm.cob_oth_pyr_rspb_amt_cnt::depends_on(
         in.aigapp
         );

out0.*::in.*;
end;

/*@
dependency_analysis_function:Map_rxclaim_orx_rccobp_interm_to_the_orx_f_cob_claim_transaction_ILM_documentation
metrics:
{
  dependencies:
  [
     [out0.f_cob_clm.cob_oth_pyr_bnstg_amt_cnt,'f_cob_clm.cob_oth_pyr_bnstg_amt_cnt',1,0]
     [out0.f_cob_clm.carrier_sk,'f_cob_clm.carrier_sk',1,0]
     [out0.f_cob_clm.claim_nbr_encrp,'f_cob_clm.claim_nbr_encrp',1,0]
     [out0.f_cob_clm.cob_oth_pyr_dt,'f_cob_clm.cob_oth_pyr_dt',1,3]
     [out0.f_cob_clm.cob_oth_pyr_id,'f_cob_clm.cob_oth_pyr_id',1,0]
     [out0.f_cob_clm.cob_oth_pyr_cov_type,'f_cob_clm.cob_oth_pyr_cov_type',1,0]
     [out0.f_cob_clm.claim_seq_nbr,'f_cob_clm.claim_seq_nbr',1,0]
     [out0.f_cob_clm.src_env_sk,'f_cob_clm.src_env_sk',1,0]
     [out0.f_cob_clm.cob_oth_pyr_id_qlfr,'f_cob_clm.cob_oth_pyr_id_qlfr',1,0]
     [out0.f_cob_clm.claim_nbr,'f_cob_clm.claim_nbr',1,0]
     [out0.dxf_src_rec_cnt,'DXF Source Record Count',1,0]
     [out0.f_cob_clm.cob_oth_pyr_rej_cnt,'f_cob_clm.cob_oth_pyr_rej_cnt',1,0]
     [out0.dxf_src_sys_id,'DXF Source System ID',1,0]
     [out0.dxf_src_file_name,'DXF Source File Name',1,0]
     [out0.f_cob_clm.cob_oth_pyr_amt_paid_cnt,'f_cob_clm.cob_oth_pyr_amt_paid_cnt',1,0]
     [out0.f_cob_clm.cob_oth_pyr_intnl_cntrl_cd,'f_cob_clm.cob_oth_pyr_intnl_cntrl_cd',1,0]
     [out0.f_cob_clm.cob_seq_nbr,'f_cob_clm.cob_seq_nbr',1,0]
     [out0.f_cob_clm.cag_sk,'f_cob_clm.cag_sk',1,0]
     [out0.f_cob_clm.prod_sk,'f_cob_clm.prod_sk',1,0]
     [out0.f_cob_clm.mbr_sk,'f_cob_clm.mbr_sk',1,0]
     [out0.f_cob_clm.cob_oth_pyr_rspb_amt_cnt,'f_cob_clm.cob_oth_pyr_rspb_amt_cnt',1,0]
     [out0.dxf_src_dataset_id,'DXF Source Dataset ID',1,0]
  ]
  impacts:
  [
     [in0.airyn2,'airyn2',1,1]
     [in0.aip2nb,'aip2nb',7,6]
     [in0.aigapp,'aigapp',1,1]
     [in0.claimsts,'claimsts',1,4]
     [in0.aigbpp,'aigbpp',1,1]
     [in0.aiipcj,'aiipcj',1,1]
     [in0.dxf_src_dataset_id,'DXF Source Dataset ID',1,1]
     [in0.aioinb,'aioinb',6,5]
     [in0.dxf_src_file_name,'DXF Source File Name',1,1]
     [in0.dxf_src_rec_cnt,'DXF Source Record Count',1,1]
     [in0.dxf_src_sys_id,'DXF Source System ID',3,6]
     [in0.aiincj,'aiincj',1,1]
     [in0.aiven2,'aiven2',1,1]
     [in0.aisdip,'aisdip',1,1]
     [in0.aiacda,'aiacda',5,4]
     [in0.airxn2,'airxn2',1,1]
     [in0.airzc4,'airzc4',1,1]
     ['lookup("orx_f_claim_transaction_reduced_lkp").cag_sk','cag_sk',1,1]
     ['lookup("orx_f_claim_transaction_reduced_lkp").mbr_sk','mbr_sk',1,1]
     ['lookup("orx_f_claim_transaction_reduced_lkp").prod_sk','prod_sk',1,1]
     ['lookup("orx_f_claim_transaction_reduced_lkp").carrier_sk','carrier_sk',1,1]
  ]
}
@*/

out0::reformat(in0)=
begin
let int bzt_5 not NULL = 0;
let decimal("\x01",0) f_cob_clm_claim_nbr = fail_if_error(in0.aip2nb);
let decimal("\x01",0) f_cob_clm_claim_seq_nbr = fail_if_error(if(in0.aioinb<0) in0.aioinb else (1000 - in0.aioinb));
let decimal("\x01",0) f_cob_clm_cag_sk;
let decimal("\x01",0) f_cob_clm_mbr_sk;
let decimal("\x01",0) f_cob_clm_prod_sk;
let decimal("\x01",0) f_cob_clm_cob_seq_nbr = fail_if_error(in0.aiven2);
let string("\x01",charset="iso-8859-15", maximum_length=2) f_cob_clm_cob_oth_pyr_cov_type = fail_if_error(in0.aiincj);
let string("\x01",charset="iso-8859-15", maximum_length=2) f_cob_clm_cob_oth_pyr_id_qlfr = fail_if_error(in0.aiipcj);
let string("\x01",charset="iso-8859-15", maximum_length=10) f_cob_clm_cob_oth_pyr_id = fail_if_error(in0.airzc4);
let date("YYYYMMDD")("\x01") f_cob_clm_cob_oth_pyr_dt;
let string("\x01",charset="iso-8859-15", maximum_length=30) f_cob_clm_cob_oth_pyr_intnl_cntrl_cd = fail_if_error(in0.aisdip);
let decimal("\x01",0) f_cob_clm_cob_oth_pyr_amt_paid_cnt = fail_if_error(in0.airxn2);
let decimal("\x01",0) f_cob_clm_cob_oth_pyr_rej_cnt = fail_if_error(in0.airyn2);
let decimal("\x01",0) f_cob_clm_cob_oth_pyr_rspb_amt_cnt = fail_if_error(in0.aigapp);
let decimal("\x01",0) f_cob_clm_cob_oth_pyr_bnstg_amt_cnt = fail_if_error(in0.aigbpp);
let decimal("\x01",0) f_cob_clm_src_env_sk = fail_if_error(in0.dxf_src_sys_id);
let decimal("\x01",0) f_cob_clm_carrier_sk;
let decimal("\x01",0) f_cob_clm_claim_nbr_encrp;
let unicode string(int) othrpyrdate;

bzt_9_6c54cc0a_58eb46ec_3565_0 = 0;


/*   Rule:Compute othrpyrdate  (#1)   */
if(first_defined(fail_if_error(((length_of(in0.aiacda) member [vector 6,7])) && ((is_valid(YYYYMMDD(19000000+ in0.aiacda))) ==1)),0))begin
  bzt_5=1;
  othrpyrdate=YYYYMMDD(19000000+in0.aiacda);
end
else if(first_defined(fail_if_error(((length_of(in0.aiacda)) ==8) && ((is_valid(YYYYMMDD(in0.aiacda))) ==1)),0))begin
  bzt_5=1;
  othrpyrdate=YYYYMMDD(in0.aiacda);
end

/*   Default value   */
if(!bzt_5)begin
  othrpyrdate=fail_if_error(YYYYMMDD('19000101'));
end

/*   Default value   */
f_cob_clm_cob_oth_pyr_dt=fail_if_error(othrpyrdate);

/*   Default value   */
f_cob_clm_carrier_sk=fail_if_error(bzt_6_6c54cc0a_58eb46ec_3565_0(in0).carrier_sk);

/*   Default value   */
f_cob_clm_claim_nbr_encrp=fail_if_error(if(in0.aip2nb>0) (decimal(''))(string_concat(string_substring((decimal(''))in0.aip2nb,1,2),ff3_encrypt_idwdata((decimal(''))in0.aip2nb))) 
else  (decimal(''))(string_concat(string_substring((decimal(''))in0.aip2nb,1,3),ff3_encrypt_idwdata(decimal_strip(math_abs((decimal(''))in0.aip2nb))))));

/*   Default value   */
f_cob_clm_cag_sk=fail_if_error(bzt_6_6c54cc0a_58eb46ec_3565_0(in0).cag_sk);

/*   Default value   */
f_cob_clm_prod_sk=fail_if_error(bzt_6_6c54cc0a_58eb46ec_3565_0(in0).prod_sk);

/*   Default value   */
f_cob_clm_mbr_sk=fail_if_error(bzt_6_6c54cc0a_58eb46ec_3565_0(in0).mbr_sk);

  out0.f_cob_clm.claim_nbr::f_cob_clm_claim_nbr;
  out0.f_cob_clm.claim_seq_nbr::f_cob_clm_claim_seq_nbr;
  out0.f_cob_clm.cag_sk::f_cob_clm_cag_sk;
  out0.f_cob_clm.mbr_sk::f_cob_clm_mbr_sk;
  out0.f_cob_clm.prod_sk::f_cob_clm_prod_sk;
  out0.f_cob_clm.cob_seq_nbr::f_cob_clm_cob_seq_nbr;
  out0.f_cob_clm.cob_oth_pyr_cov_type::f_cob_clm_cob_oth_pyr_cov_type;
  out0.f_cob_clm.cob_oth_pyr_id_qlfr::f_cob_clm_cob_oth_pyr_id_qlfr;
  out0.f_cob_clm.cob_oth_pyr_id::f_cob_clm_cob_oth_pyr_id;
  out0.f_cob_clm.cob_oth_pyr_dt::f_cob_clm_cob_oth_pyr_dt;
  out0.f_cob_clm.cob_oth_pyr_intnl_cntrl_cd::f_cob_clm_cob_oth_pyr_intnl_cntrl_cd;
  out0.f_cob_clm.cob_oth_pyr_amt_paid_cnt::f_cob_clm_cob_oth_pyr_amt_paid_cnt;
  out0.f_cob_clm.cob_oth_pyr_rej_cnt::f_cob_clm_cob_oth_pyr_rej_cnt;
  out0.f_cob_clm.cob_oth_pyr_rspb_amt_cnt::f_cob_clm_cob_oth_pyr_rspb_amt_cnt;
  out0.f_cob_clm.cob_oth_pyr_bnstg_amt_cnt::f_cob_clm_cob_oth_pyr_bnstg_amt_cnt;
  out0.f_cob_clm.src_env_sk::f_cob_clm_src_env_sk;
  out0.f_cob_clm.carrier_sk::f_cob_clm_carrier_sk;
  out0.f_cob_clm.claim_nbr_encrp::f_cob_clm_claim_nbr_encrp;
  out0.*::in0.*;
end;
