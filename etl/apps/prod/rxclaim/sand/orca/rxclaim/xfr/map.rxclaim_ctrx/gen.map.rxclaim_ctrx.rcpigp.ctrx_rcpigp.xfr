/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */
include '~$AI_XFR/bre_helper.map.xfr';

/*@
dependency_analysis:
[
  [out0.ctrx_rcpigp.pig_inactive_dt,[transform],in0.sygocf]
  [out0.ctrx_rcpigp.pig_rec_stat_cd,[passthrough],in0.syc0aq]
  [out0.ctrx_rcpigp.pig_ing_flg,[passthrough],in0.syczaq]
  [out0.ctrx_rcpigp.pig_strngth_uom_cd,[passthrough],in0.syaniv]
  [out0.ctrx_rcpigp.pig_ing_type_cd,[passthrough],in0.sycyaq]
  [out0.ctrx_rcpigp.pig_gnrc_nm,[passthrough],in0.syamiv]
  [out0.ctrx_rcpigp.prod_key,[passthrough],in0.syiin2]
  [out0.ctrx_rcpigp.src_env_sk,[passthrough],in0.rxt_src_envrt_id]
  [out0.ctrx_rcpigp.pig_ing_id,[passthrough],in0.syc1aq]
  [out0.ctrx_rcpigp.pig_strngth,[passthrough],in0.syuuqu]
  [out0.*,in0.*]
]
metrics:
{
  dependencies:
  [
     [out0.ctrx_rcpigp.pig_inactive_dt,'ctrx_rcpigp.pig_inactive_dt',3,3]
     [out0.ctrx_rcpigp.pig_rec_stat_cd,'ctrx_rcpigp.pig_rec_stat_cd',1,0]
     [out0.ctrx_rcpigp.pig_ing_flg,'ctrx_rcpigp.pig_ing_flg',1,0]
     [out0.ctrx_rcpigp.pig_strngth_uom_cd,'ctrx_rcpigp.pig_strngth_uom_cd',1,0]
     [out0.ctrx_rcpigp.pig_ing_type_cd,'ctrx_rcpigp.pig_ing_type_cd',1,0]
     [out0.ctrx_rcpigp.pig_gnrc_nm,'ctrx_rcpigp.pig_gnrc_nm',1,0]
     [out0.ctrx_rcpigp.prod_key,'ctrx_rcpigp.prod_key',1,0]
     [out0.ctrx_rcpigp.src_env_sk,'ctrx_rcpigp.src_env_sk',1,0]
     [out0.ctrx_rcpigp.pig_ing_id,'ctrx_rcpigp.pig_ing_id',1,0]
     [out0.ctrx_rcpigp.pig_strngth,'ctrx_rcpigp.pig_strngth',1,0]
  ]
  impacts:
  [
     [in0.syiin2,'syiin2',1,1]
     [in0.syc1aq,'syc1aq',1,1]
     [in0.rxt_src_envrt_id,'rxt_src_envrt_id',1,1]
     [in0.syaniv,'syaniv',1,1]
     [in0.syczaq,'syczaq',1,1]
     [in0.syuuqu,'syuuqu',1,1]
     [in0.sygocf,'sygocf',6,4]
     [in0.syc0aq,'syc0aq',1,1]
     [in0.sycyaq,'sycyaq',1,1]
     [in0.syamiv,'syamiv',1,1]
  ]
}
@*/

out0::reformat(in0)=
begin
let decimal("\x01",maximum_length=9) ctrx_rcpigp_prod_key = fail_if_error(in0.syiin2);
let string("\x01",charset="iso-8859-15", maximum_length=1) ctrx_rcpigp_pig_ing_type_cd = fail_if_error(in0.sycyaq);
let decimal("\x01",maximum_length=9) ctrx_rcpigp_pig_ing_id = fail_if_error(in0.syc1aq);
let string("\x01",charset="iso-8859-15", maximum_length=40) ctrx_rcpigp_pig_gnrc_nm = fail_if_error(in0.syamiv);
let decimal("\x01",maximum_length=18) ctrx_rcpigp_pig_strngth = fail_if_error(in0.syuuqu);
let string("\x01",charset="iso-8859-15", maximum_length=11) ctrx_rcpigp_pig_strngth_uom_cd = fail_if_error(in0.syaniv);
let string("\x01",charset="iso-8859-15", maximum_length=1) ctrx_rcpigp_pig_ing_flg = fail_if_error(in0.syczaq);
let string("\x01",charset="iso-8859-15", maximum_length=1) ctrx_rcpigp_pig_rec_stat_cd = fail_if_error(in0.syc0aq);
let datetime("YYYYMMDDHH24MISS")("\x01") ctrx_rcpigp_pig_inactive_dt;
let decimal("\x01",0) ctrx_rcpigp_src_env_sk = fail_if_error(in0.rxt_src_envrt_id);



/*   Rule:Compute ctrx_rcpigp.pig_inactive_dt  (#1)   */
if(first_defined(fail_if_error(((string_length(in0.sygocf) member [vector 6,7])) && ((is_valid(YYYYMMDD(19000000+in0.sygocf))) ==YYYYMMDD(19000000+in0.sygocf))),0))begin
  ctrx_rcpigp_pig_inactive_dt=YYYYMMDD(19000000+in0.sygocf);
end
else if(first_defined(fail_if_error(((string_length(in0.sygocf)) ==8) && ((is_valid(YYYYMMDD(in0.sygocf) )) ==1)),0))begin
  ctrx_rcpigp_pig_inactive_dt=(date("YYYYMMDD")) in0.sygocf;
end
else begin
  ctrx_rcpigp_pig_inactive_dt=00010101;
end

  out0.ctrx_rcpigp.prod_key::ctrx_rcpigp_prod_key;
  out0.ctrx_rcpigp.pig_ing_type_cd::ctrx_rcpigp_pig_ing_type_cd;
  out0.ctrx_rcpigp.pig_ing_id::ctrx_rcpigp_pig_ing_id;
  out0.ctrx_rcpigp.pig_gnrc_nm::ctrx_rcpigp_pig_gnrc_nm;
  out0.ctrx_rcpigp.pig_strngth::ctrx_rcpigp_pig_strngth;
  out0.ctrx_rcpigp.pig_strngth_uom_cd::ctrx_rcpigp_pig_strngth_uom_cd;
  out0.ctrx_rcpigp.pig_ing_flg::ctrx_rcpigp_pig_ing_flg;
  out0.ctrx_rcpigp.pig_rec_stat_cd::ctrx_rcpigp_pig_rec_stat_cd;
  out0.ctrx_rcpigp.pig_inactive_dt::ctrx_rcpigp_pig_inactive_dt;
  out0.ctrx_rcpigp.src_env_sk::ctrx_rcpigp_src_env_sk;
  out0.*::in0.*;

end;
