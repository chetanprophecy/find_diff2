/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */
include '~$AI_XFR/bre_helper.map.xfr';

/*@
dependency_analysis:
[
  [out0.cms_phcst.phr_mail_flg,[transform],in0.line]
  [out0.cms_phcst.cms_pbp_id,[transform],in0.line]
  [out0.prod_dir_dt.cal_day_dt,[transform],in0.dxf_src_file_name]
  [out0.cms_phcst.brand_dispensing_fee_90,[transform],in0.line]
  [out0.cms_phcst.generic_dispensing_fee_90,[transform],in0.line]
  [out0.cms_phcst.preferred_status_mail_flg,[transform],in0.line]
  [out0.cms_phcst.price_id,[transform],in0.line]
  [out0.cms_phcst.cms_pharmacy_cost_sk,[transform],]
  [out0.cms_phcst.cms_contract_id,[transform],in0.line]
  [out0.cms_phcst.generic_dispensing_fee_60,[transform],in0.line]
  [out0.cms_phcst.cms_phr_npi_id,[transform],in0.line]
  [out0.cms_phcst.floor_price,[transform],in0.line]
  [out0.cms_phcst.phr_la_drugs_flg,[transform],in0.line]
  [out0.cms_phcst.preferred_status_retail_flg,[transform],in0.line]
  [out0.cms_phcst.prod_directory_dt_sk,[transform],]
  [out0.cms_phcst.phr_hi_flg,[transform],in0.line]
  [out0.cms_phcst.vaccine_admin_fee,[transform],in0.line]
  [out0.cms_phcst.brand_dispensing_fee_60,[transform],in0.line]
  [out0.cms_phcst.brand_dispensing_fee_30,[transform],in0.line]
  [out0.cms_phcst.prod_directory_dt,[transform],in0.dxf_src_file_name]
  [out0.cms_phcst.phr_ltc_flg,[transform],in0.line]
  [out0.cms_phcst.src_env_sk,[passthrough],in0.dxf_src_sys_id]
  [out0.cms_phcst.phr_retail_flg,[transform],in0.line]
  [out0.cms_phcst.cms_segment_id,[transform],in0.line]
  [out0.cms_phcst.generic_dispensing_fee_30,[transform],in0.line]
  [out0.*,in0.*]
]
metrics:
{
  dependencies:
  [
     [out0.cms_phcst.phr_mail_flg,'cms_phcst.phr_mail_flg',1,0]
     [out0.cms_phcst.cms_pbp_id,'cms_phcst.cms_pbp_id',1,0]
     [out0.prod_dir_dt.cal_day_dt,'prod_dir_dt.cal_day_dt',1,2]
     [out0.cms_phcst.brand_dispensing_fee_90,'cms_phcst.brand_dispensing_fee_90',1,0]
     [out0.cms_phcst.generic_dispensing_fee_90,'cms_phcst.generic_dispensing_fee_90',1,0]
     [out0.cms_phcst.preferred_status_mail_flg,'cms_phcst.preferred_status_mail_flg',1,0]
     [out0.cms_phcst.price_id,'cms_phcst.price_id',1,0]
     [out0.cms_phcst.cms_pharmacy_cost_sk,'cms_phcst.cms_pharmacy_cost_sk',1,0]
     [out0.cms_phcst.cms_contract_id,'cms_phcst.cms_contract_id',1,0]
     [out0.cms_phcst.generic_dispensing_fee_60,'cms_phcst.generic_dispensing_fee_60',1,0]
     [out0.cms_phcst.cms_phr_npi_id,'cms_phcst.cms_phr_npi_id',1,0]
     [out0.cms_phcst.floor_price,'cms_phcst.floor_price',1,0]
     [out0.cms_phcst.phr_la_drugs_flg,'cms_phcst.phr_la_drugs_flg',1,0]
     [out0.cms_phcst.preferred_status_retail_flg,'cms_phcst.preferred_status_retail_flg',1,0]
     [out0.cms_phcst.prod_directory_dt_sk,'cms_phcst.prod_directory_dt_sk',1,0]
     [out0.dxf_src_rec_cnt,'DXF Source Record Count',1,0]
     [out0.cms_phcst.phr_hi_flg,'cms_phcst.phr_hi_flg',1,0]
     [out0.cms_phcst.vaccine_admin_fee,'cms_phcst.vaccine_admin_fee',1,0]
     [out0.dxf_src_sys_id,'DXF Source System ID',1,0]
     [out0.dxf_src_file_name,'DXF Source File Name',1,0]
     [out0.cms_phcst.brand_dispensing_fee_60,'cms_phcst.brand_dispensing_fee_60',1,0]
     [out0.cms_phcst.brand_dispensing_fee_30,'cms_phcst.brand_dispensing_fee_30',1,0]
     [out0.cms_phcst.prod_directory_dt,'cms_phcst.prod_directory_dt',1,2]
     [out0.cms_phcst.phr_ltc_flg,'cms_phcst.phr_ltc_flg',1,0]
     [out0.cms_phcst.src_env_sk,'cms_phcst.src_env_sk',1,0]
     [out0.cms_phcst.phr_retail_flg,'cms_phcst.phr_retail_flg',1,0]
     [out0.cms_phcst.cms_segment_id,'cms_phcst.cms_segment_id',1,0]
     [out0.dxf_src_dataset_id,'DXF Source Dataset ID',1,0]
     [out0.cms_phcst.generic_dispensing_fee_30,'cms_phcst.generic_dispensing_fee_30',1,0]
  ]
  impacts:
  [
     [in0.dxf_src_dataset_id,'DXF Source Dataset ID',1,1]
     [in0.dxf_src_file_name,'DXF Source File Name',3,5]
     [in0.dxf_src_rec_cnt,'DXF Source Record Count',1,1]
     [in0.dxf_src_sys_id,'DXF Source System ID',2,2]
     [in0.line,'line',28,20]
  ]
}
@*/

out0::reformat(in0)=
begin
let decimal("\x01",0) cms_phcst_cms_pharmacy_cost_sk = -1;
let decimal("\x01",0) cms_phcst_prod_directory_dt_sk = -1;
let string("\x01",charset="iso-8859-15", maximum_length=5) cms_phcst_cms_contract_id = fail_if_error(string_substring(in0.line , 1, 5));
let string("\x01",charset="iso-8859-15", maximum_length=3) cms_phcst_cms_pbp_id = fail_if_error(string_substring(in0.line , 6, 3));
let string("\x01",charset="iso-8859-15", maximum_length=3) cms_phcst_cms_segment_id = fail_if_error(string_substring(in0.line , 9, 3));
let string("\x01",charset="iso-8859-15", maximum_length=10) cms_phcst_cms_phr_npi_id = fail_if_error(string_substring(in0.line , 14, 10));
let string("\x01",charset="iso-8859-15", maximum_length=3) cms_phcst_price_id = fail_if_error(string_substring(in0.line , 24, 3));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_brand_dispensing_fee_30 = fail_if_error((decimal(""))string_substring(in0.line , 27, 8) + ((decimal(""))string_substring(in0.line , 35, 4)/10000));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_generic_dispensing_fee_30 = fail_if_error((decimal(""))string_substring(in0.line , 39, 8) + ((decimal(""))string_substring(in0.line , 47, 4)/10000));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_vaccine_admin_fee = fail_if_error((decimal(""))string_substring(in0.line , 51, 8) + ((decimal(""))string_substring(in0.line , 59, 4)/10000));
let string("\x01",charset="iso-8859-15", maximum_length=1) cms_phcst_preferred_status_retail_flg = fail_if_error(string_substring(in0.line , 63, 1));
let string("\x01",charset="iso-8859-15", maximum_length=1) cms_phcst_phr_retail_flg = fail_if_error(string_substring(in0.line , 64, 1));
let string("\x01",charset="iso-8859-15", maximum_length=1) cms_phcst_phr_mail_flg = fail_if_error(string_substring(in0.line , 65, 1));
let string("\x01",charset="iso-8859-15", maximum_length=1) cms_phcst_phr_la_drugs_flg = fail_if_error(string_substring(in0.line , 66, 1));
let string("\x01",charset="iso-8859-15", maximum_length=1) cms_phcst_phr_hi_flg = fail_if_error(string_substring(in0.line , 67, 1));
let string("\x01",charset="iso-8859-15", maximum_length=1) cms_phcst_phr_ltc_flg = fail_if_error(string_substring(in0.line , 68, 1));
let string("\x01",charset="iso-8859-15", maximum_length=1) cms_phcst_preferred_status_mail_flg = fail_if_error(string_substring(in0.line , 69, 1));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_floor_price = fail_if_error((decimal(""))string_substring(in0.line , 70, 8) + ((decimal(""))string_substring(in0.line , 78, 4)/10000));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_brand_dispensing_fee_60 = fail_if_error((decimal(""))string_substring(in0.line , 82, 8) + ((decimal(""))string_substring(in0.line , 90, 4)/10000));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_generic_dispensing_fee_60 = fail_if_error((decimal(""))string_substring(in0.line , 94, 8) + ((decimal(""))string_substring(in0.line , 102, 4)/10000));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_brand_dispensing_fee_90 = fail_if_error((decimal(""))string_substring(in0.line , 106, 8) + ((decimal(""))string_substring(in0.line , 114, 4)/10000));
let decimal("\x01".4, maximum_length=10, sign_reserved) cms_phcst_generic_dispensing_fee_90 = fail_if_error((decimal(""))string_substring(in0.line , 118, 8) + ((decimal(""))string_substring(in0.line , 126, 4)/10000));
let date("YYYYMMDD")("\x01") cms_phcst_prod_directory_dt;
let decimal("\x01",0) cms_phcst_src_env_sk = fail_if_error(in0.dxf_src_sys_id);
let date("YYYYMMDD")("\x01") prod_dir_dt_cal_day_dt;
let unicode string(int) prod_directory_file = fail_if_error(string_split(in0.dxf_src_file_name, "/")[length_of(string_split(in0.dxf_src_file_name, "/")) - 1]);
let unicode string(int) prod_directory_file_date;



/*   Default value   */
prod_directory_file_date=fail_if_error(string_split(prod_directory_file, ".")[length_of(string_split(prod_directory_file, ".")) - 2]);

/*   Default value   */
cms_phcst_prod_directory_dt=fail_if_error((date("YYYYMMDD"))prod_directory_file_date);

/*   Default value   */
prod_dir_dt_cal_day_dt=fail_if_error((date("YYYYMMDD"))prod_directory_file_date);

  out0.cms_phcst.cms_pharmacy_cost_sk::cms_phcst_cms_pharmacy_cost_sk;
  out0.cms_phcst.prod_directory_dt_sk::cms_phcst_prod_directory_dt_sk;
  out0.cms_phcst.cms_contract_id::cms_phcst_cms_contract_id;
  out0.cms_phcst.cms_pbp_id::cms_phcst_cms_pbp_id;
  out0.cms_phcst.cms_segment_id::cms_phcst_cms_segment_id;
  out0.cms_phcst.cms_phr_npi_id::cms_phcst_cms_phr_npi_id;
  out0.cms_phcst.price_id::cms_phcst_price_id;
  out0.cms_phcst.brand_dispensing_fee_30::cms_phcst_brand_dispensing_fee_30;
  out0.cms_phcst.generic_dispensing_fee_30::cms_phcst_generic_dispensing_fee_30;
  out0.cms_phcst.vaccine_admin_fee::cms_phcst_vaccine_admin_fee;
  out0.cms_phcst.preferred_status_retail_flg::cms_phcst_preferred_status_retail_flg;
  out0.cms_phcst.phr_retail_flg::cms_phcst_phr_retail_flg;
  out0.cms_phcst.phr_mail_flg::cms_phcst_phr_mail_flg;
  out0.cms_phcst.phr_la_drugs_flg::cms_phcst_phr_la_drugs_flg;
  out0.cms_phcst.phr_hi_flg::cms_phcst_phr_hi_flg;
  out0.cms_phcst.phr_ltc_flg::cms_phcst_phr_ltc_flg;
  out0.cms_phcst.preferred_status_mail_flg::cms_phcst_preferred_status_mail_flg;
  out0.cms_phcst.floor_price::cms_phcst_floor_price;
  out0.cms_phcst.brand_dispensing_fee_60::cms_phcst_brand_dispensing_fee_60;
  out0.cms_phcst.generic_dispensing_fee_60::cms_phcst_generic_dispensing_fee_60;
  out0.cms_phcst.brand_dispensing_fee_90::cms_phcst_brand_dispensing_fee_90;
  out0.cms_phcst.generic_dispensing_fee_90::cms_phcst_generic_dispensing_fee_90;
  out0.cms_phcst.prod_directory_dt::cms_phcst_prod_directory_dt;
  out0.cms_phcst.src_env_sk::cms_phcst_src_env_sk;
  out0.prod_dir_dt.cal_day_dt::prod_dir_dt_cal_day_dt;
  out0.*::in0.*;

end;
