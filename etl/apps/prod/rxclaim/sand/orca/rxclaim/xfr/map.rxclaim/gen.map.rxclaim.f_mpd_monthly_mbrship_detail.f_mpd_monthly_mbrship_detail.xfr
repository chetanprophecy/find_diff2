/*   Do not edit. Generated file - BRE 3.2.6.4;;Default deployment;   */
include '~$AI_XFR/bre_helper.map.xfr';
let string(int) bzt_0_6c54cc0a_5a5c3932_6c9c_1 = $RUN_ID;

/*@
dependency_analysis:
[
  [out0.f_mmm_dtl.risk_factor,[transform],in0.risk_factor]
  [out0.d_member.carrier_id,[passthrough],in0.carrier]
  [out0.d_member.mbr_id,[passthrough],in0.member_id]
  [out0.f_mmm_dtl.payment_mnth_flg,[passthrough],in0.payment_month_flag]
  [out0.d_member.account_id,[passthrough],in0.account]
  [out0.f_mmm_dtl.lics_amt,[transform],in0.lics_am]
  [out0.f_mmm_dtl.carrier_id,[passthrough],in0.carrier]
  [out0.f_mmm_dtl.mbr_fname,[passthrough],in0.first_name]
  [out0.f_mmm_dtl.adj_end_dt,[passthrough],in0.adj_end_dt]
  [out0.d_cag.carrier_id,[passthrough],in0.carrier]
  [out0.f_mmm_dtl.client_nm,[passthrough],in0.client_name]
  [out0.f_mmm_dtl.mbi,[transform],]
  [out0.f_mmm_dtl.birth_dt,[passthrough],in0.birth_dt]
  [out0.f_mmm_dtl.repeat_cnt,[passthrough],in0.repeat_count]
  [out0.f_mmm_dtl.mbr_id,[passthrough],in0.member_id]
  [out0.d_cag.account_id,[passthrough],in0.account]
  [out0.f_mmm_dtl.cag_sk,[transform],]
  [out0.f_mmm_dtl.employer_group_id,[passthrough],in0.group]
  [out0.f_mmm_dtl.cms_reason_cd,[passthrough],in0.adj_reason_cd]
  [out0.f_mmm_dtl.reinsurance_amt,[transform],in0.reinsurance_am]
  [out0.f_mmm_dtl.account_id,[passthrough],in0.account]
  [out0.f_mmm_dtl.pk,[passthrough],in0.pk]
  [out0.f_mmm_dtl.src_env_sk,[passthrough],in0.dxf_src_sys_id]
  [out0.f_mmm_dtl.total_amt,[transform],in0.total_am]
  [out0.d_member.employer_group_id,[passthrough],in0.group]
  [out0.f_mmm_dtl.mbr_lname,[passthrough],in0.last_name]
  [out0.f_mmm_dtl.lips_amt,[transform],in0.lips_am]
  [out0.f_mmm_dtl.mbr_sk,[transform],]
  [out0.f_mmm_dtl.adj_start_dt,[passthrough],in0.adj_start_dt]
  [out0.f_mmm_dtl.rsp_due_amt,[transform],]
  [out0.f_mmm_dtl.claim_cntr,[transform],]
  [out0.f_mmm_dtl.direct_subsidy_amt,[transform],in0.direct_subsidy_am]
  [out0.d_cag.employer_group_id,[passthrough],in0.group]
  [out0.f_mmm_dtl.mmr_mnth,[transform],in0.dxf_src_file_name]
  [out0.*,in0.*]
]
metrics:
{
  dependencies:
  [
     [out0.f_mmm_dtl.risk_factor,'f_mmm_dtl.risk_factor',1,0]
     [out0.d_member.carrier_id,'d_member.carrier_id',1,0]
     [out0.d_member.mbr_id,'d_member.mbr_id',1,0]
     [out0.f_mmm_dtl.payment_mnth_flg,'f_mmm_dtl.payment_mnth_flg',1,0]
     [out0.d_member.account_id,'d_member.account_id',1,0]
     [out0.f_mmm_dtl.lics_amt,'f_mmm_dtl.lics_amt',1,0]
     [out0.f_mmm_dtl.carrier_id,'f_mmm_dtl.carrier_id',1,0]
     [out0.f_mmm_dtl.mbr_fname,'f_mmm_dtl.mbr_fname',1,0]
     [out0.f_mmm_dtl.adj_end_dt,'f_mmm_dtl.adj_end_dt',1,0]
     [out0.d_cag.carrier_id,'d_cag.carrier_id',1,0]
     [out0.f_mmm_dtl.client_nm,'f_mmm_dtl.client_nm',1,0]
     [out0.f_mmm_dtl.mbi,'f_mmm_dtl.mbi',1,0]
     [out0.f_mmm_dtl.birth_dt,'f_mmm_dtl.birth_dt',1,0]
     [out0.dxf_src_dataset_id,'DXF Source Dataset ID',1,0]
     [out0.f_mmm_dtl.repeat_cnt,'f_mmm_dtl.repeat_cnt',1,0]
     [out0.f_mmm_dtl.mbr_id,'f_mmm_dtl.mbr_id',1,0]
     [out0.d_cag.account_id,'d_cag.account_id',1,0]
     [out0.f_mmm_dtl.cag_sk,'f_mmm_dtl.cag_sk',1,0]
     [out0.f_mmm_dtl.employer_group_id,'f_mmm_dtl.employer_group_id',1,0]
     [out0.dxf_src_file_name,'DXF Source File Name',1,0]
     [out0.f_mmm_dtl.cms_reason_cd,'f_mmm_dtl.cms_reason_cd',1,0]
     [out0.f_mmm_dtl.reinsurance_amt,'f_mmm_dtl.reinsurance_amt',1,0]
     [out0.f_mmm_dtl.account_id,'f_mmm_dtl.account_id',1,0]
     [out0.f_mmm_dtl.pk,'f_mmm_dtl.pk',1,0]
     [out0.f_mmm_dtl.src_env_sk,'f_mmm_dtl.src_env_sk',1,0]
     [out0.f_mmm_dtl.total_amt,'f_mmm_dtl.total_amt',1,0]
     [out0.d_member.employer_group_id,'d_member.employer_group_id',1,0]
     [out0.f_mmm_dtl.mbr_lname,'f_mmm_dtl.mbr_lname',1,0]
     [out0.f_mmm_dtl.lips_amt,'f_mmm_dtl.lips_amt',1,0]
     [out0.f_mmm_dtl.mbr_sk,'f_mmm_dtl.mbr_sk',1,0]
     [out0.f_mmm_dtl.adj_start_dt,'f_mmm_dtl.adj_start_dt',1,0]
     [out0.dxf_src_rec_cnt,'DXF Source Record Count',1,0]
     [out0.dxf_src_sys_id,'DXF Source System ID',1,0]
     [out0.f_mmm_dtl.rsp_due_amt,'f_mmm_dtl.rsp_due_amt',1,0]
     [out0.f_mmm_dtl.claim_cntr,'f_mmm_dtl.claim_cntr',1,0]
     [out0.f_mmm_dtl.direct_subsidy_amt,'f_mmm_dtl.direct_subsidy_amt',1,0]
     [out0.d_cag.employer_group_id,'d_cag.employer_group_id',1,0]
     [out0.f_mmm_dtl.hicn,'f_mmm_dtl.hicn',1,0]
     [out0.f_mmm_dtl.mmr_mnth,'f_mmm_dtl.mmr_mnth',1,0]
  ]
  impacts:
  [
     [in0.lips_am,'lips_am',1,1]
     [in0.pk,'pk',1,1]
     [in0.dxf_src_file_name,'DXF Source File Name',2,2]
     [in0.risk_factor,'risk_factor',1,1]
     [in0.member_id,'member_id',2,2]
     [in0.carrier,'carrier',3,3]
     [in0.first_name,'first_name',1,1]
     [in0.account,'account',3,3]
     [in0.repeat_count,'repeat_count',1,1]
     [in0.last_name,'last_name',1,1]
     [in0.dxf_src_sys_id,'DXF Source System ID',2,2]
     [in0.adj_end_dt,'adj_end_dt',1,1]
     [in0.adj_start_dt,'adj_start_dt',1,1]
     [in0.payment_month_flag,'payment_month_flag',1,1]
     [in0.lics_am,'lics_am',1,1]
     [in0.client_name,'client_name',1,1]
     [in0.group,'group',3,3]
     [in0.direct_subsidy_am,'direct_subsidy_am',1,1]
     [in0.dxf_src_dataset_id,'DXF Source Dataset ID',1,1]
     [in0.hicn,'hicn',1,1]
     [in0.dxf_src_rec_cnt,'DXF Source Record Count',1,1]
     [in0.reinsurance_am,'reinsurance_am',1,1]
     [in0.total_am,'total_am',1,1]
     [in0.adj_reason_cd,'adj_reason_cd',1,1]
     [in0.birth_dt,'birth_dt',1,1]
  ]
}
@*/

out0::reformat(in0)=
begin
let string("\x01",charset="iso-8859-15", maximum_length=30) f_mmm_dtl_carrier_id = fail_if_error(in0.carrier);
let string("\x01",charset="iso-8859-15", maximum_length=40) f_mmm_dtl_account_id = fail_if_error(in0.account);
let string("\x01",charset="iso-8859-15", maximum_length=30) f_mmm_dtl_employer_group_id = fail_if_error(in0.group);
let string("\x01",charset="iso-8859-15", maximum_length=20) f_mmm_dtl_mbr_id = fail_if_error(in0.member_id);
let decimal("\x01",0) f_mmm_dtl_cag_sk = 0;
let decimal("\x01",0) f_mmm_dtl_mbr_sk = 0;
let string("\x01",charset="iso-8859-15", maximum_length=25) f_mmm_dtl_client_nm = fail_if_error(in0.client_name);
let string("\x01",charset="iso-8859-15", maximum_length=20) f_mmm_dtl_mbr_fname = fail_if_error(in0.first_name);
let string("\x01",charset="iso-8859-15", maximum_length=25) f_mmm_dtl_mbr_lname = fail_if_error(in0.last_name);
let date("YYYYMMDD")("\x01") f_mmm_dtl_birth_dt = fail_if_error(in0.birth_dt);
let string("\x01",charset="iso-8859-15", maximum_length=20) f_mmm_dtl_hicn = fail_if_error(in0.hicn);
let string("\x01",charset="iso-8859-15", maximum_length=20) f_mmm_dtl_mbi = '-';
let date("YYYYMMDD")("\x01") f_mmm_dtl_adj_start_dt = fail_if_error(in0.adj_start_dt);
let date("YYYYMMDD")("\x01") f_mmm_dtl_adj_end_dt = fail_if_error(in0.adj_end_dt);
let decimal("\x01",0) f_mmm_dtl_mmr_mnth = fail_if_error((string(''))(date('YYYYMM'))(date('YYYYMMDD'))re_replace(string_replace(re_replace(in0.dxf_src_file_name,'.*[/]',''),'.xlsx',''),'.*[_]',''));
let decimal("\x01".2, maximum_length=11, sign_reserved) f_mmm_dtl_direct_subsidy_amt = fail_if_error((decimal("\x01".2, maximum_length=11, sign_reserved))((decimal("\x01"))in0.direct_subsidy_am));
let decimal("\x01".2, maximum_length=11, sign_reserved) f_mmm_dtl_lips_amt = fail_if_error((decimal("\x01".2, maximum_length=11, sign_reserved))((decimal("\x01"))in0.lips_am));
let decimal("\x01".2, maximum_length=11, sign_reserved) f_mmm_dtl_lics_amt = fail_if_error((decimal("\x01".2, maximum_length=11, sign_reserved))((decimal("\x01"))in0.lics_am));
let decimal("\x01".2, maximum_length=11, sign_reserved) f_mmm_dtl_reinsurance_amt = fail_if_error((decimal("\x01".2, maximum_length=11, sign_reserved))((decimal("\x01"))in0.reinsurance_am));
let decimal("\x01".2, maximum_length=11, sign_reserved) f_mmm_dtl_total_amt = fail_if_error((decimal("\x01".2, maximum_length=11, sign_reserved))((decimal("\x01"))in0.total_am));
let string("\x01",charset="iso-8859-15", maximum_length=5) f_mmm_dtl_payment_mnth_flg = fail_if_error(in0.payment_month_flag);
let string("\x01",charset="iso-8859-15", maximum_length=1) f_mmm_dtl_repeat_cnt = fail_if_error(in0.repeat_count);
let decimal("\x01",0) f_mmm_dtl_pk = fail_if_error(in0.pk);
let decimal("\x01".5, maximum_length=15, sign_reserved) f_mmm_dtl_risk_factor = fail_if_error((decimal("\x01".5, maximum_length=15, sign_reserved))((decimal("\x01"))in0.risk_factor));
let string("\x01",charset="iso-8859-15", maximum_length=20) f_mmm_dtl_cms_reason_cd = fail_if_error(in0.adj_reason_cd);
let decimal("\x01",0) f_mmm_dtl_claim_cntr = 0;
let decimal("\x01".2, maximum_length=11, sign_reserved) f_mmm_dtl_rsp_due_amt = 0;
let decimal("\x01",0) f_mmm_dtl_src_env_sk = fail_if_error(in0.dxf_src_sys_id);
let string("\x01",charset="iso-8859-15", maximum_length=30) d_cag_carrier_id = fail_if_error(in0.carrier);
let string("\x01",charset="iso-8859-15", maximum_length=40) d_cag_account_id = fail_if_error(in0.account);
let string("\x01",charset="iso-8859-15", maximum_length=30) d_cag_employer_group_id = fail_if_error(in0.group);
let string("\x01",charset="iso-8859-15", maximum_length=30) d_member_carrier_id = fail_if_error(in0.carrier);
let string("\x01",charset="iso-8859-15", maximum_length=40) d_member_account_id = fail_if_error(in0.account);
let string("\x01",charset="iso-8859-15", maximum_length=30) d_member_employer_group_id = fail_if_error(in0.group);
let string("\x01",charset="iso-8859-15", maximum_length=20) d_member_mbr_id = fail_if_error(in0.member_id);



  out0.f_mmm_dtl.carrier_id::f_mmm_dtl_carrier_id;
  out0.f_mmm_dtl.account_id::f_mmm_dtl_account_id;
  out0.f_mmm_dtl.employer_group_id::f_mmm_dtl_employer_group_id;
  out0.f_mmm_dtl.mbr_id::f_mmm_dtl_mbr_id;
  out0.f_mmm_dtl.cag_sk::f_mmm_dtl_cag_sk;
  out0.f_mmm_dtl.mbr_sk::f_mmm_dtl_mbr_sk;
  out0.f_mmm_dtl.client_nm::f_mmm_dtl_client_nm;
  out0.f_mmm_dtl.mbr_fname::f_mmm_dtl_mbr_fname;
  out0.f_mmm_dtl.mbr_lname::f_mmm_dtl_mbr_lname;
  out0.f_mmm_dtl.birth_dt::f_mmm_dtl_birth_dt;
  out0.f_mmm_dtl.hicn::f_mmm_dtl_hicn;
  out0.f_mmm_dtl.mbi::f_mmm_dtl_mbi;
  out0.f_mmm_dtl.adj_start_dt::f_mmm_dtl_adj_start_dt;
  out0.f_mmm_dtl.adj_end_dt::f_mmm_dtl_adj_end_dt;
  out0.f_mmm_dtl.mmr_mnth::f_mmm_dtl_mmr_mnth;
  out0.f_mmm_dtl.direct_subsidy_amt::f_mmm_dtl_direct_subsidy_amt;
  out0.f_mmm_dtl.lips_amt::f_mmm_dtl_lips_amt;
  out0.f_mmm_dtl.lics_amt::f_mmm_dtl_lics_amt;
  out0.f_mmm_dtl.reinsurance_amt::f_mmm_dtl_reinsurance_amt;
  out0.f_mmm_dtl.total_amt::f_mmm_dtl_total_amt;
  out0.f_mmm_dtl.payment_mnth_flg::f_mmm_dtl_payment_mnth_flg;
  out0.f_mmm_dtl.repeat_cnt::f_mmm_dtl_repeat_cnt;
  out0.f_mmm_dtl.pk::f_mmm_dtl_pk;
  out0.f_mmm_dtl.risk_factor::f_mmm_dtl_risk_factor;
  out0.f_mmm_dtl.cms_reason_cd::f_mmm_dtl_cms_reason_cd;
  out0.f_mmm_dtl.claim_cntr::f_mmm_dtl_claim_cntr;
  out0.f_mmm_dtl.rsp_due_amt::f_mmm_dtl_rsp_due_amt;
  out0.f_mmm_dtl.src_env_sk::f_mmm_dtl_src_env_sk;
  out0.d_cag.carrier_id::d_cag_carrier_id;
  out0.d_cag.account_id::d_cag_account_id;
  out0.d_cag.employer_group_id::d_cag_employer_group_id;
  out0.d_member.carrier_id::d_member_carrier_id;
  out0.d_member.account_id::d_member_account_id;
  out0.d_member.employer_group_id::d_member_employer_group_id;
  out0.d_member.mbr_id::d_member_mbr_id;
  out0.*::in0.*;

end;
