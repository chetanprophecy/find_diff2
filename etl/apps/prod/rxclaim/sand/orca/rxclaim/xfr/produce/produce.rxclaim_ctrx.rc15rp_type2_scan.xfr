out :: scan(in) =
begin
  out.* :: in.*;
  out.ambmdt_thru_dt:: if(is_null(previous(in)))"99991231" else (previous(in).ambmdt_from_dt - 1 ) ;
end;